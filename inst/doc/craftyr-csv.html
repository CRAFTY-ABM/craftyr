<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="author" content="Sascha Holzhauer" />

<meta name="date" content="2015-12-19" />

<title>Using CSV data with craftyr</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; }
code > span.dt { color: #902000; }
code > span.dv { color: #40a070; }
code > span.bn { color: #40a070; }
code > span.fl { color: #40a070; }
code > span.ch { color: #4070a0; }
code > span.st { color: #4070a0; }
code > span.co { color: #60a0b0; font-style: italic; }
code > span.ot { color: #007020; }
code > span.al { color: #ff0000; font-weight: bold; }
code > span.fu { color: #06287e; }
code > span.er { color: #ff0000; font-weight: bold; }
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<link href="data:text/css,body%20%7B%0A%20%20background%2Dcolor%3A%20%23fff%3B%0A%20%20margin%3A%201em%20auto%3B%0A%20%20max%2Dwidth%3A%20700px%3B%0A%20%20overflow%3A%20visible%3B%0A%20%20padding%2Dleft%3A%202em%3B%0A%20%20padding%2Dright%3A%202em%3B%0A%20%20font%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0A%20%20font%2Dsize%3A%2014px%3B%0A%20%20line%2Dheight%3A%201%2E35%3B%0A%7D%0A%0A%23header%20%7B%0A%20%20text%2Dalign%3A%20center%3B%0A%7D%0A%0A%23TOC%20%7B%0A%20%20clear%3A%20both%3B%0A%20%20margin%3A%200%200%2010px%2010px%3B%0A%20%20padding%3A%204px%3B%0A%20%20width%3A%20400px%3B%0A%20%20border%3A%201px%20solid%20%23CCCCCC%3B%0A%20%20border%2Dradius%3A%205px%3B%0A%0A%20%20background%2Dcolor%3A%20%23f6f6f6%3B%0A%20%20font%2Dsize%3A%2013px%3B%0A%20%20line%2Dheight%3A%201%2E3%3B%0A%7D%0A%20%20%23TOC%20%2Etoctitle%20%7B%0A%20%20%20%20font%2Dweight%3A%20bold%3B%0A%20%20%20%20font%2Dsize%3A%2015px%3B%0A%20%20%20%20margin%2Dleft%3A%205px%3B%0A%20%20%7D%0A%0A%20%20%23TOC%20ul%20%7B%0A%20%20%20%20padding%2Dleft%3A%2040px%3B%0A%20%20%20%20margin%2Dleft%3A%20%2D1%2E5em%3B%0A%20%20%20%20margin%2Dtop%3A%205px%3B%0A%20%20%20%20margin%2Dbottom%3A%205px%3B%0A%20%20%7D%0A%20%20%23TOC%20ul%20ul%20%7B%0A%20%20%20%20margin%2Dleft%3A%20%2D2em%3B%0A%20%20%7D%0A%20%20%23TOC%20li%20%7B%0A%20%20%20%20line%2Dheight%3A%2016px%3B%0A%20%20%7D%0A%0Atable%20%7B%0A%20%20margin%3A%201em%20auto%3B%0A%20%20border%2Dwidth%3A%201px%3B%0A%20%20border%2Dcolor%3A%20%23DDDDDD%3B%0A%20%20border%2Dstyle%3A%20outset%3B%0A%20%20border%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0A%20%20border%2Dwidth%3A%202px%3B%0A%20%20padding%3A%205px%3B%0A%20%20border%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0A%20%20border%2Dwidth%3A%201px%3B%0A%20%20border%2Dstyle%3A%20inset%3B%0A%20%20line%2Dheight%3A%2018px%3B%0A%20%20padding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0A%20%20border%2Dleft%2Dstyle%3A%20none%3B%0A%20%20border%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0A%0Ap%20%7B%0A%20%20margin%3A%200%2E5em%200%3B%0A%7D%0A%0Ablockquote%20%7B%0A%20%20background%2Dcolor%3A%20%23f6f6f6%3B%0A%20%20padding%3A%200%2E25em%200%2E75em%3B%0A%7D%0A%0Ahr%20%7B%0A%20%20border%2Dstyle%3A%20solid%3B%0A%20%20border%3A%20none%3B%0A%20%20border%2Dtop%3A%201px%20solid%20%23777%3B%0A%20%20margin%3A%2028px%200%3B%0A%7D%0A%0Adl%20%7B%0A%20%20margin%2Dleft%3A%200%3B%0A%7D%0A%20%20dl%20dd%20%7B%0A%20%20%20%20margin%2Dbottom%3A%2013px%3B%0A%20%20%20%20margin%2Dleft%3A%2013px%3B%0A%20%20%7D%0A%20%20dl%20dt%20%7B%0A%20%20%20%20font%2Dweight%3A%20bold%3B%0A%20%20%7D%0A%0Aul%20%7B%0A%20%20margin%2Dtop%3A%200%3B%0A%7D%0A%20%20ul%20li%20%7B%0A%20%20%20%20list%2Dstyle%3A%20circle%20outside%3B%0A%20%20%7D%0A%20%20ul%20ul%20%7B%0A%20%20%20%20margin%2Dbottom%3A%200%3B%0A%20%20%7D%0A%0Apre%2C%20code%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20color%3A%20%23333%3B%0A%7D%0Apre%20%7B%0A%20%20white%2Dspace%3A%20pre%2Dwrap%3B%20%20%20%20%2F%2A%20Wrap%20long%20lines%20%2A%2F%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20margin%3A%205px%200px%2010px%200px%3B%0A%20%20padding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0A%0Acode%20%7B%0A%20%20font%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0A%20%20font%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0A%20%20padding%3A%202px%200px%3B%0A%7D%0A%0Adiv%2Efigure%20%7B%0A%20%20text%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0A%20%20background%2Dcolor%3A%20%23FFFFFF%3B%0A%20%20padding%3A%202px%3B%0A%20%20border%3A%201px%20solid%20%23DDDDDD%3B%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20border%3A%201px%20solid%20%23CCCCCC%3B%0A%20%20margin%3A%200%205px%3B%0A%7D%0A%0Ah1%20%7B%0A%20%20margin%2Dtop%3A%200%3B%0A%20%20font%2Dsize%3A%2035px%3B%0A%20%20line%2Dheight%3A%2040px%3B%0A%7D%0A%0Ah2%20%7B%0A%20%20border%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0A%20%20padding%2Dtop%3A%2010px%3B%0A%20%20padding%2Dbottom%3A%202px%3B%0A%20%20font%2Dsize%3A%20145%25%3B%0A%7D%0A%0Ah3%20%7B%0A%20%20border%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0A%20%20padding%2Dtop%3A%2010px%3B%0A%20%20font%2Dsize%3A%20120%25%3B%0A%7D%0A%0Ah4%20%7B%0A%20%20border%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0A%20%20margin%2Dleft%3A%208px%3B%0A%20%20font%2Dsize%3A%20105%25%3B%0A%7D%0A%0Ah5%2C%20h6%20%7B%0A%20%20border%2Dbottom%3A%201px%20solid%20%23ccc%3B%0A%20%20font%2Dsize%3A%20105%25%3B%0A%7D%0A%0Aa%20%7B%0A%20%20color%3A%20%230033dd%3B%0A%20%20text%2Ddecoration%3A%20none%3B%0A%7D%0A%20%20a%3Ahover%20%7B%0A%20%20%20%20color%3A%20%236666ff%3B%20%7D%0A%20%20a%3Avisited%20%7B%0A%20%20%20%20color%3A%20%23800080%3B%20%7D%0A%20%20a%3Avisited%3Ahover%20%7B%0A%20%20%20%20color%3A%20%23BB00BB%3B%20%7D%0A%20%20a%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0A%20%20%20%20text%2Ddecoration%3A%20underline%3B%20%7D%0A%20%20a%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0A%20%20%20%20text%2Ddecoration%3A%20underline%3B%20%7D%0A%0A%2F%2A%20Class%20described%20in%20https%3A%2F%2Fbenjeffrey%2Ecom%2Fposts%2Fpandoc%2Dsyntax%2Dhighlighting%2Dcss%0A%20%20%20Colours%20from%20https%3A%2F%2Fgist%2Egithub%2Ecom%2Frobsimmons%2F1172277%20%2A%2F%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20Keyword%20%2A%2F%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%2F%2A%20DataType%20%2A%2F%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%2F%2A%20DecVal%20%28decimal%20values%29%20%2A%2F%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20BaseN%20%2A%2F%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20Float%20%2A%2F%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20Char%20%2A%2F%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20String%20%2A%2F%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%2F%2A%20Comment%20%2A%2F%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%2F%2A%20OtherToken%20%2A%2F%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20AlertToken%20%2A%2F%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20Function%20calls%20%2A%2F%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%2F%2A%20ErrorTok%20%2A%2F%0A%0A" rel="stylesheet" type="text/css" />

</head>

<body>



<div id="header">
<h1 class="title">Using CSV data with craftyr</h1>
<h4 class="author"><em>Sascha Holzhauer</em></h4>
<h4 class="date"><em>2015-12-19</em></h4>
</div>

<div id="TOC">
<ul>
<li><a href="#input-read-csv-data">Input (read) CSV Data</a><ul>
<li><a href="#overall-features">(Overall) Features</a></li>
<li><a href="#source-regional-csv-data-celltable---land-use-data-per-cell">Source: Regional CSV data (CellTable) - Land use data per cell</a></li>
<li><a href="#source-regional-csv-data-celltable---aggregated-data">Source: Regional CSV data (CellTable) - Aggregated data</a></li>
<li><a href="#source-cell-table-pre-allocation-competitiveness">Source: Cell Table (Pre-Allocation Competitiveness)</a></li>
<li><a href="#source-aggregated-aft-composition">Source: Aggregated AFT Composition</a></li>
<li><a href="#source-aggregated-demand-and-supply-data-aggregatedemandsupplycsvoutputter">Source: Aggregated Demand and Supply Data (AggregateDemandSupplyCSVOutputter)</a></li>
<li><a href="#source-takeover-from-giving-in-data-takeovercelloutputter">Source: TakeOver from Giving In Data (TakeoverCellOutputter)</a></li>
<li><a href="#source-givingin-statistics-givinginstatisticsoutputter">Source: GivingIn Statistics (GivingInStatisticsOutputter)</a></li>
<li><a href="#source-marginal-utilities">Source: Marginal Utilities</a></li>
</ul></li>
<li><a href="#visualise-csv-data">Visualise CSV Data</a><ul>
<li><a href="#map-data">Map Data</a><ul>
<li><a href="#landuseindex-facets">LandUseIndex: Facets</a></li>
<li><a href="#landuseindex-raw-plot">LandUseIndex: Raw Plot</a></li>
</ul></li>
<li><a href="#aggregate-data">Aggregate Data</a><ul>
<li><a href="#from-cell-level-data">From Cell Level Data</a><ul>
<li><a href="#aft-composition-as-timeline">AFT Composition as Timeline</a></li>
<li><a href="#competitiveness-mean-by-region">Competitiveness (Mean by region)</a></li>
<li><a href="#spatial-autocorrelation">Spatial Autocorrelation</a></li>
<li><a href="#cell-connectedness">Cell Connectedness</a></li>
<li><a href="#cell-volatility">Cell Volatility</a></li>
<li><a href="#further-cell-data-as-timeline">Further Cell Data as Timeline</a></li>
</ul></li>
<li><a href="#from-aggregated-region-level-data">From Aggregated (Region Level) Data</a><ul>
<li><a href="#aft-composition-as-timeline-1">AFT Composition as Timeline</a></li>
<li><a href="#aggregated-demand-and-supply-data">Aggregated Demand and Supply Data</a></li>
<li><a href="#take-overs-giving-in">Take Overs (Giving in)</a></li>
<li><a href="#take-overs-all">Take Overs (All)</a></li>
<li><a href="#givinginstatistics-frequencies-per-aft---regions-aggregated">GivingInStatistics (Frequencies per AFT - Regions aggregated)</a></li>
<li><a href="#pre-allocation-competitiveness">Pre-Allocation Competitiveness</a></li>
<li><a href="#cell-volatility-1">Cell Volatility</a></li>
<li><a href="#marginal-utilities">Marginal Utilities</a></li>
<li><a href="#demand-normalised-per-cell-marginal-utilities">Demand-normalised per-cell marginal Utilities</a></li>
<li><a href="#total-productivity">Total Productivity</a></li>
</ul></li>
<li><a href="#from-single-files">From Single Files</a><ul>
<li><a href="#aft-composition">AFT Composition</a></li>
<li><a href="#aft-composition-1">AFT Composition</a></li>
<li><a href="#demand-and-supply">Demand and Supply</a></li>
</ul></li>
</ul></li>
</ul></li>
<li><a href="#output-write-csv-data">Output (write) CSV Data</a><ul>
<li><a href="#generate-landuseindex-key">Generate LandUseIndex key</a></li>
<li><a href="#aggregate-demand-and-supply">Aggregate demand and supply</a></li>
<li><a href="#supplydemand-gap-regarding-agent-parameters-gu-probability">Supply/Demand gap regarding agent parameters (GU probability)</a></li>
</ul></li>
<li><a href="#conversions">Conversions</a><ul>
<li><a href="#stored-csvdata.frame-rdata-to-raster-file-ascii">Stored CSV/data.frame (rData) to raster file (ASCII)</a></li>
</ul></li>
</ul>
</div>

<div id="input-read-csv-data" class="section level1">
<h1>Input (read) CSV Data</h1>
<div id="overall-features" class="section level2">
<h2>(Overall) Features</h2>
<ul>
<li>Limit considered ticks by starttick, endtick, and interval</li>
<li>Read CSV files of multiple regions at once</li>
</ul>
</div>
<div id="source-regional-csv-data-celltable---land-use-data-per-cell" class="section level2">
<h2>Source: Regional CSV data (CellTable) - Land use data per cell</h2>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(craftyr)
simp &lt;-<span class="st"> </span><span class="kw">param_getExamplesSimp</span>()

futile.logger::<span class="kw">flog.threshold</span>(futile.logger::DEBUG, <span class="dt">name=</span><span class="st">'craftyr.input.csv'</span>)

cdata &lt;-<span class="st"> </span><span class="kw">input_csv_data</span>(simp, <span class="dt">dataname =</span> <span class="ot">NULL</span>, <span class="dt">datatype =</span> <span class="st">&quot;Cell&quot;</span>, <span class="dt">columns =</span> <span class="st">&quot;LandUseIndex&quot;</span>,
        <span class="dt">pertick =</span> <span class="ot">TRUE</span>, <span class="dt">starttick =</span> <span class="dv">2010</span>, <span class="dt">endtick =</span> <span class="dv">2020</span>, <span class="dt">tickinterval =</span> <span class="dv">10</span>,
        <span class="dt">attachfileinfo =</span> <span class="ot">TRUE</span>, <span class="dt">bindrows =</span> <span class="ot">TRUE</span>)
csv_LandUseIndex_rbinded &lt;-<span class="st"> </span>cdata
<span class="kw">input_tools_save</span>(simp, <span class="st">&quot;csv_LandUseIndex_rbinded&quot;</span>)
cdata &lt;-<span class="st"> </span><span class="kw">split</span>(cdata, <span class="kw">list</span>(cdata$Tick, cdata$Runid))
csv_LandUseIndex_split &lt;-<span class="st"> </span>cdata
<span class="kw">input_tools_save</span>(simp, <span class="st">&quot;csv_LandUseIndex_split&quot;</span>)</code></pre>
<p>High level:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hl_store_csvcelldata</span>(simp, <span class="dt">dataname =</span> <span class="st">&quot;csv_LandUseIndex_rbinded&quot;</span>, <span class="dt">tickinterval =</span> <span class="dv">10</span>)</code></pre>
<p>For large data sets it is a good idea to clean the data somewhat before storing:</p>
<pre class="sourceCode r"><code class="sourceCode r">cdata &lt;-<span class="st"> </span><span class="kw">input_csv_data</span>(simp, <span class="dt">dataname =</span> <span class="ot">NULL</span>, <span class="dt">datatype =</span> <span class="st">&quot;Cell&quot;</span>, <span class="dt">colums =</span> <span class="st">&quot;LandUseIndex&quot;</span>,
        <span class="dt">pertick =</span> <span class="ot">TRUE</span>, <span class="dt">starttick =</span> <span class="dv">2010</span>, <span class="dt">endtick =</span> <span class="dv">2040</span>, <span class="dt">tickinterval =</span> <span class="dv">30</span>, <span class="dt">attachfileinfo =</span> <span class="ot">TRUE</span>)

cdata$Region &lt;-<span class="st"> </span><span class="ot">NULL</span>
cdata$Scenario &lt;-<span class="st"> </span><span class="ot">NULL</span>

cdata &lt;-<span class="st"> </span><span class="kw">split</span>(cdata, <span class="kw">list</span>(cdata$Tick,cdata$Runid))

cdata &lt;-<span class="st"> </span><span class="kw">lapply</span>(cdata, function(x) {x$Runid &lt;-<span class="st"> </span><span class="ot">NULL</span>; x})
cdata &lt;-<span class="st"> </span><span class="kw">lapply</span>(cdata, function(x) {x$Tick &lt;-<span class="st"> </span><span class="ot">NULL</span>; x})

csv_LandUseIndex_split &lt;-<span class="st"> </span>cadata
<span class="kw">input_tools_save</span>(simp, <span class="st">&quot;csv_LandUseIndex_split&quot;</span>)
<span class="kw">rm</span>(<span class="kw">list</span>(csv_LandUseIndex_split, cdata)</code></pre>
</div>
<div id="source-regional-csv-data-celltable---aggregated-data" class="section level2">
<h2>Source: Regional CSV data (CellTable) - Aggregated data</h2>
<p>Note that the fields in cell table depend on the output configuration as well as service names. Thus, the aggregation function needs to be adapted.</p>
<pre class="sourceCode r"><code class="sourceCode r">aggregationFunction &lt;-<span class="st"> </span>function(simp, data) {
    <span class="kw">library</span>(plyr) <span class="co"># because '.' function cannot be addressed</span>
    plyr::<span class="kw">ddply</span>(data, .(Runid, Region, Tick, LandUseIndex), <span class="dt">.fun=</span>function(df) {
                df$Counter &lt;-<span class="st"> </span><span class="dv">1</span>
                <span class="kw">with</span>(df, <span class="kw">data.frame</span>(
                                <span class="dt">Runid               =</span> <span class="kw">unique</span>(Runid),
                                <span class="dt">Region              =</span> <span class="kw">unique</span>(Region),
                                <span class="dt">Tick                =</span> <span class="kw">mean</span>(Tick),
                                <span class="dt">LandUseIndex        =</span> <span class="kw">mean</span>(LandUseIndex),
                                <span class="dt">AFT                 =</span> <span class="kw">sum</span>(Counter),
                                <span class="dt">Service.Service1    =</span> <span class="kw">sum</span>(Service.Service1), 
                                <span class="dt">Service.Service2    =</span> <span class="kw">sum</span>(Service.Service2),
                                <span class="dt">Service.Service3    =</span> <span class="kw">sum</span>(Service.Service3),
                                <span class="dt">Capital.Cap1        =</span> <span class="kw">sum</span>(Capital.Cap1)) )
            })
}

csv_cell_aggregated &lt;-<span class="st"> </span><span class="kw">input_csv_data</span>(simp, <span class="dt">dataname =</span> <span class="ot">NULL</span>, <span class="dt">datatype =</span> <span class="st">&quot;Cell&quot;</span>, <span class="dt">columns =</span> <span class="kw">c</span>(<span class="st">&quot;Service.Service1&quot;</span>, <span class="st">&quot;Service.Service2&quot;</span>,
                <span class="st">&quot;Service.Service3&quot;</span>, <span class="st">&quot;Capital.Cap1&quot;</span>, <span class="st">&quot;LandUseIndex&quot;</span>, <span class="st">&quot;AFT&quot;</span>), <span class="dt">pertick =</span> <span class="ot">TRUE</span>,
        <span class="dt">starttick =</span> <span class="dv">2000</span>, <span class="dt">endtick =</span> <span class="dv">2020</span>, <span class="dt">tickinterval =</span> <span class="dv">10</span>,
        <span class="dt">attachfileinfo =</span> <span class="ot">TRUE</span>, <span class="dt">bindrows =</span> <span class="ot">TRUE</span>,
        <span class="dt">aggregationFunction =</span> aggregationFunction,
        <span class="dt">skipXY =</span> <span class="ot">TRUE</span>)</code></pre>
<pre><code>## Warning in loop_apply(n, do.ply): package 'plyr' was built under R version
## 3.1.3</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rownames</span>(csv_cell_aggregated) &lt;-<span class="st"> </span><span class="ot">NULL</span>
<span class="kw">input_tools_save</span>(simp, <span class="st">&quot;csv_cell_aggregated&quot;</span>)</code></pre>
</div>
<div id="source-cell-table-pre-allocation-competitiveness" class="section level2">
<h2>Source: Cell Table (Pre-Allocation Competitiveness)</h2>
<p>Read CSV data of pre-allocation competitiveness and transfer to data.frame of frequencies</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(craftyr)
simp &lt;-<span class="st"> </span><span class="kw">param_getExamplesSimp</span>()
simp$sim$filepartorder  &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;regions&quot;</span>, <span class="st">&quot;D&quot;</span>, <span class="st">&quot;datatype&quot;</span>)
csv_preAllocTable &lt;-<span class="st"> </span><span class="kw">input_csv_prealloccomp</span>(simp)
<span class="kw">input_tools_save</span>(simp, <span class="st">&quot;csv_preAllocTable&quot;</span>)</code></pre>
</div>
<div id="source-aggregated-aft-composition" class="section level2">
<h2>Source: Aggregated AFT Composition</h2>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(craftyr)
simp &lt;-<span class="st"> </span><span class="kw">param_getExamplesSimp</span>()
dataAggregateAFTComposition &lt;-<span class="st"> </span><span class="kw">input_csv_data</span>(simp, <span class="dt">dataname =</span> <span class="ot">NULL</span>, <span class="dt">datatype =</span> <span class="st">&quot;AggregateAFTComposition&quot;</span>,
        <span class="dt">pertick =</span> <span class="ot">FALSE</span>,
        <span class="dt">bindrows =</span> <span class="ot">TRUE</span>,
        <span class="dt">skipXY =</span> <span class="ot">TRUE</span>)
<span class="kw">input_tools_save</span>(simp, <span class="st">&quot;dataAggregateAFTComposition&quot;</span>)</code></pre>
</div>
<div id="source-aggregated-demand-and-supply-data-aggregatedemandsupplycsvoutputter" class="section level2">
<h2>Source: Aggregated Demand and Supply Data (AggregateDemandSupplyCSVOutputter)</h2>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(craftyr)
simp &lt;-<span class="st"> </span><span class="kw">param_getExamplesSimp</span>()
csv_aggregateServiceDemand &lt;-<span class="st"> </span><span class="kw">input_csv_data</span>(simp, <span class="dt">dataname =</span> <span class="ot">NULL</span>, <span class="dt">datatype =</span> <span class="st">&quot;AggregateServiceDemand&quot;</span>,
        <span class="dt">pertick =</span> <span class="ot">FALSE</span>, <span class="dt">bindrows =</span> <span class="ot">TRUE</span>)
<span class="kw">input_tools_save</span>(simp, <span class="st">&quot;csv_aggregateServiceDemand&quot;</span>)</code></pre>
</div>
<div id="source-takeover-from-giving-in-data-takeovercelloutputter" class="section level2">
<h2>Source: TakeOver from Giving In Data (TakeoverCellOutputter)</h2>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(craftyr)
simp &lt;-<span class="st"> </span><span class="kw">param_getExamplesSimp</span>()
csv_aggregateTakeOvers &lt;-<span class="st"> </span><span class="kw">input_csv_data</span>(simp, <span class="dt">dataname =</span> <span class="ot">NULL</span>, <span class="dt">datatype =</span> <span class="st">&quot;TakeOvers&quot;</span>, <span class="dt">pertick =</span> <span class="ot">FALSE</span>,
        <span class="dt">bindrows =</span> <span class="ot">TRUE</span>,
        <span class="dt">skipXY =</span> <span class="ot">TRUE</span>)
<span class="kw">input_tools_save</span>(simp, <span class="st">&quot;csv_aggregateTakeOvers&quot;</span>)</code></pre>
</div>
<div id="source-givingin-statistics-givinginstatisticsoutputter" class="section level2">
<h2>Source: GivingIn Statistics (GivingInStatisticsOutputter)</h2>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(craftyr)
simp &lt;-<span class="st"> </span><span class="kw">param_getExamplesSimp</span>()
csv_aggregateGiStatistics &lt;-<span class="st"> </span><span class="kw">input_csv_data</span>(simp, <span class="dt">dataname =</span> <span class="ot">NULL</span>, <span class="dt">datatype =</span> <span class="st">&quot;GivingInStatistics&quot;</span>,
        <span class="dt">pertick =</span> <span class="ot">FALSE</span>,
        <span class="dt">bindrows =</span> <span class="ot">TRUE</span>,
        <span class="dt">skipXY =</span> <span class="ot">TRUE</span>)
<span class="kw">input_tools_save</span>(simp, <span class="st">&quot;csv_aggregateGiStatistics&quot;</span>)</code></pre>
</div>
<div id="source-marginal-utilities" class="section level2">
<h2>Source: Marginal Utilities</h2>
<p>Note: currently, there is no outputter, but marginal utilities can be extracted from log data using a python script (see Py4ABM, <a href="https://bitbucket.org/S-Holzhauer/py4abm" class="uri">https://bitbucket.org/S-Holzhauer/py4abm</a>). The resulting CSV file should be places in the projects RData folder.</p>
<p>TODO</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(craftyr)
simp &lt;-<span class="st"> </span><span class="kw">param_getExamplesSimp</span>()
csv_MarginalUtilitites_melt &lt;-<span class="st"> </span><span class="kw">input_marginalutilities</span>(simp)
<span class="kw">input_tools_save</span>(simp, <span class="st">&quot;csv_MarginalUtilitites_melt&quot;</span>)</code></pre>
</div>
</div>
<div id="visualise-csv-data" class="section level1">
<h1>Visualise CSV Data</h1>
<div id="map-data" class="section level2">
<h2>Map Data</h2>
<div id="landuseindex-facets" class="section level3">
<h3>LandUseIndex: Facets</h3>
<pre class="sourceCode r"><code class="sourceCode r">simp &lt;-<span class="st"> </span><span class="kw">param_getDefaultSimp</span>()
<span class="kw">input_tools_load</span>(simp, <span class="st">&quot;csv_LandUseIndex_split&quot;</span>)
cdata &lt;-<span class="st"> </span>csv_LandUseIndex_split
cdata$<span class="st">&quot;2010.2&quot;</span>$ID &lt;&lt;-<span class="st"> </span><span class="kw">as.factor</span>(<span class="st">&quot;Homo_2010&quot;</span>)
cdata$<span class="st">&quot;2040.2&quot;</span>$ID &lt;&lt;-<span class="st"> </span><span class="kw">as.factor</span>(<span class="st">&quot;Homo_2040&quot;</span>)

diffcells &lt;&lt;-<span class="st"> </span>cdata$<span class="st">&quot;2010.2&quot;</span>
diffcells$LandUseIndex &lt;&lt;-<span class="st"> </span><span class="ot">NA</span>
diffhomo$LandUseIndex[cdata$<span class="st">&quot;2040.2&quot;</span>$LandUseIndex -<span class="st"> </span>cdata$<span class="st">&quot;2010.2&quot;</span>$LandUseIndex !=<span class="st"> </span><span class="dv">0</span>] &lt;-<span class="st"> </span><span class="dv">3</span>
diffhomo$ID &lt;-<span class="st"> </span><span class="kw">as.factor</span>(<span class="st">&quot;Diff_Homo_2040-2010&quot;</span>)

toplot &lt;-<span class="st"> </span><span class="kw">list</span>(cdata$<span class="st">&quot;2010.2&quot;</span>, cdata$<span class="st">&quot;2040.2&quot;</span>, diffhomo)
<span class="kw">rm</span>(diffhomo)
<span class="kw">rm</span>(cdata)
<span class="kw">visualise_cells_printPlots</span>(simp, toplot, <span class="dt">idcolumn =</span> <span class="st">&quot;ID&quot;</span>,
        <span class="dt">title =</span> <span class="st">&quot;EU-Homo&quot;</span>, <span class="dt">legendtitle =</span> <span class="st">&quot;AFTs&quot;</span>,
        <span class="dt">factorial=</span> <span class="ot">TRUE</span>, <span class="dt">omitaxisticks =</span> <span class="ot">TRUE</span>, <span class="dt">ncol =</span> <span class="dv">3</span>,
        <span class="dt">legenditemnames =</span> simp$mdata$aftNames, <span class="dt">coloursetname=</span><span class="st">&quot;AFT&quot;</span>)</code></pre>
</div>
<div id="landuseindex-raw-plot" class="section level3">
<h3>LandUseIndex: Raw Plot</h3>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(craftyr)
simp &lt;-<span class="st"> </span><span class="kw">param_getExamplesSimp</span>()
<span class="kw">input_tools_load</span>(simp, <span class="st">&quot;csv_LandUseIndex_split&quot;</span>)
<span class="kw">visualise_cells_printRawPlots</span>(simp, csv_LandUseIndex_split,
        <span class="dt">factorial=</span> <span class="ot">TRUE</span>, <span class="dt">ncol =</span> <span class="dv">1</span>, <span class="dt">id=</span><span class="st">&quot;None&quot;</span>)       </code></pre>
<pre><code>## Warning in grid.Call(L_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font family not found in Windows font database</code></pre>
<pre><code>## Warning in grid.Call(L_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font family not found in Windows font database</code></pre>
<pre><code>## Warning in grid.Call(L_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font family not found in Windows font database</code></pre>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAA1BMVEX///+nxBvIAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAaElEQVR4nO3BMQEAAADCoPVPbQ0PoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4NcARS8AAcJedcoAAAAASUVORK5CYII=" /></p>
</div>
</div>
<div id="aggregate-data" class="section level2">
<h2>Aggregate Data</h2>
<div id="from-cell-level-data" class="section level3">
<h3>From Cell Level Data</h3>
<div id="aft-composition-as-timeline" class="section level4">
<h4>AFT Composition as Timeline</h4>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(craftyr)
simp &lt;-<span class="st"> </span><span class="kw">param_getExamplesSimp</span>()
<span class="kw">input_tools_load</span>(simp, <span class="st">&quot;csv_LandUseIndex_rbinded&quot;</span>)

########### aggregate regions:
csv_LandUseIndex_rbinded$AftNumbers &lt;-<span class="st"> </span>csv_LandUseIndex_rbinded$LandUseIndex
aftData &lt;-<span class="st"> </span><span class="kw">aggregate</span>(<span class="kw">subset</span>(csv_LandUseIndex_rbinded, <span class="dt">select=</span><span class="kw">c</span>(<span class="st">&quot;AftNumbers&quot;</span>)),
        <span class="dt">by =</span> <span class="kw">list</span>(<span class="dt">ID =</span> csv_LandUseIndex_rbinded[,<span class="st">&quot;Runid&quot;</span>],
                <span class="dt">Tick=</span>csv_LandUseIndex_rbinded[, <span class="st">&quot;Tick&quot;</span>],  <span class="dt">AFT=</span>csv_LandUseIndex_rbinded[,<span class="st">&quot;LandUseIndex&quot;</span>]),
        <span class="dt">FUN=</span>sum)
aftData$AFT &lt;-<span class="st"> </span><span class="kw">as.factor</span>(aftData$AFT)
aftData$Proportion &lt;-<span class="st"> </span><span class="kw">ave</span>(aftData$AftNumbers, aftData$ID, aftData$Tick, <span class="dt">FUN =</span>  function(.x) .x/<span class="kw">sum</span>(.x))
aftData$Number &lt;-<span class="st"> </span><span class="ot">NULL</span>

<span class="kw">visualise_lines</span>(simp, aftData, <span class="st">&quot;Proportion&quot;</span>, <span class="dt">title =</span> <span class="st">&quot;Total AFT composition&quot;</span>,
        <span class="dt">colour_column =</span> <span class="st">&quot;AFT&quot;</span>,
        <span class="dt">colour_legenditemnames =</span> simp$mdata$aftNames,
        <span class="dt">linetype_column =</span> <span class="st">&quot;ID&quot;</span>,
        <span class="dt">linetype_legendtitle =</span> simp$sim$rundesclabel,
        <span class="dt">linetype_legenditemnames =</span> simp$sim$rundesc,
        <span class="dt">filename =</span> <span class="kw">paste</span>(<span class="st">&quot;TotalAftComposition&quot;</span>, 
                shbasic::<span class="kw">shbasic_condenseRunids</span>(<span class="kw">data.frame</span>(aftData)[, <span class="st">&quot;ID&quot;</span>]), <span class="dt">sep=</span><span class="st">&quot;_&quot;</span>),
        <span class="dt">alpha=</span><span class="fl">0.7</span>)</code></pre>
<p><img src="data:image/png;base64,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" /></p>
<p>High level:</p>
<pre class="sourceCode r"><code class="sourceCode r">simp1 &lt;-<span class="st"> </span>simp
simp1$sim$shortid &lt;-<span class="st"> &quot;G9/C4&quot;</span>
simp2 &lt;-<span class="st"> </span>simp
simp2$sim$shortid &lt;-<span class="st"> &quot;G10/C5&quot;</span>
<span class="kw">hl_comp_cell_aftcomposition</span>(simp, <span class="dt">simps =</span> <span class="kw">list</span>(simp1, simp2), <span class="dt">dataname =</span> <span class="st">&quot;csv_cell_aggregated&quot;</span>)</code></pre>
</div>
<div id="competitiveness-mean-by-region" class="section level4">
<h4>Competitiveness (Mean by region)</h4>
<p>% TODO</p>
<p>High level:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hl_competitivenessPerRegion</span>(simp1, <span class="dt">dataname =</span> <span class="st">&quot;dataAgg&quot;</span>)</code></pre>
</div>
<div id="spatial-autocorrelation" class="section level4">
<h4>Spatial Autocorrelation</h4>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(craftyr)
simp &lt;-<span class="st"> </span><span class="kw">param_getExamplesSimp</span>()
<span class="kw">input_tools_load</span>(simp, <span class="dt">objectName =</span> <span class="st">&quot;csv_LandUseIndex_rbinded&quot;</span>)
data &lt;-<span class="st"> </span><span class="kw">get</span>(<span class="st">&quot;csv_LandUseIndex_rbinded&quot;</span>)

scoresdata &lt;-<span class="st"> </span><span class="kw">do.call</span>(rbind, <span class="kw">lapply</span>(<span class="kw">seq</span>(<span class="dt">from=</span><span class="dv">2010</span>, <span class="dt">to=</span><span class="dv">2040</span>, <span class="dt">by=</span><span class="dv">10</span>), function(tick, datac, regions, type) {
                    <span class="kw">do.call</span>(rbind,<span class="kw">lapply</span>(regions, function(tick, region, data, type) {
            tickdata &lt;-<span class="st"> </span>data[data$Tick ==<span class="st"> </span>tick &amp;<span class="st"> </span>data$Region %in%<span class="st"> </span>region, 
                    <span class="kw">c</span>(simp$csv$cname_x, simp$csv$cname_y, <span class="st">&quot;LandUseIndex&quot;</span>)]
            raster &lt;-<span class="st"> </span>craftyr::<span class="kw">convert_2raster</span>(simp, tickdata, <span class="dt">targetCRS =</span> <span class="st">&quot;+init=EPSG:32632&quot;</span>, <span class="dt">layers=</span><span class="kw">c</span>(<span class="dv">1</span>))
            <span class="kw">data.frame</span>(<span class="dt">Value =</span> <span class="kw">analyse_statistics_sa_local</span>(raster[[<span class="dv">1</span>]], <span class="dt">type =</span> type),
                    <span class="dt">Tick =</span> tick, <span class="dt">type =</span> type
                    <span class="dt">Region =</span> region)}, <span class="dt">tick =</span> tick, <span class="dt">data =</span> data, <span class="dt">type =</span> type))
        }, <span class="dt">data =</span> data, <span class="dt">type =</span> <span class="st">&quot;Moran&quot;</span>, <span class="dt">regions =</span> simp$sim$regions))

<span class="kw">visualise_lines</span>(simp, scoresdata, <span class="st">&quot;Value&quot;</span>, <span class="dt">title =</span> <span class="kw">paste</span>(<span class="st">&quot;Spatial Autocorrelation (Moran)&quot;</span>, simp$sim$rundesc[simp$sim$runid]),
        <span class="dt">linetype_column =</span> <span class="st">&quot;Region&quot;</span>,
        <span class="dt">filename =</span> <span class="kw">paste</span>(<span class="st">&quot;Spatial Autocorrelation (Moran)&quot;</span>, <span class="st">&quot;_&quot;</span>, simp$sim$rundesc[simp$sim$runid], <span class="dt">sep=</span><span class="st">&quot;&quot;</span>))</code></pre>
<p>High level:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hl_aggregate_sa</span>(simp, <span class="dt">celldataname =</span> <span class="st">&quot;csv_LandUseIndex_rbinded&quot;</span>, 
    <span class="dt">starttick =</span> simp$sim$starttick, <span class="dt">tickinterval=</span><span class="dv">10</span>, <span class="dt">endtick =</span> simp$sim$endtick,
    <span class="dt">linetypecol =</span> <span class="st">&quot;Region&quot;</span>, <span class="dt">type =</span> <span class="st">&quot;Moran&quot;</span>, <span class="dt">regions =</span> simp$sim$regions,
    <span class="dt">titleprefix =</span> <span class="kw">paste</span>(<span class="st">&quot;SpatialAutocorrelation (&quot;</span>, type, <span class="st">&quot;)&quot;</span>, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>), 
    <span class="dt">filenameprefix =</span> <span class="kw">paste</span>(<span class="st">&quot;SpatialAutocorrelation&quot;</span>, type, <span class="dt">sep=</span><span class="st">&quot;_&quot;</span>))</code></pre>
</div>
<div id="cell-connectedness" class="section level4">
<h4>Cell Connectedness</h4>
<p>Visualise stored metric LandUseConnectivity as timelines</p>
<p>High level:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hl_connectedness</span>(simp, <span class="dt">dataname =</span> <span class="st">&quot;csv_aggregated_connectivity&quot;</span>, 
        <span class="dt">datatype =</span> <span class="st">&quot;LandUseConnectivity&quot;</span>, <span class="dt">aftcolumns =</span> simp$mdata$aftNames[-<span class="dv">1</span>],
        <span class="dt">percent =</span> <span class="ot">NULL</span>)</code></pre>
</div>
<div id="cell-volatility" class="section level4">
<h4>Cell Volatility</h4>
<p>High level:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hl_volatility</span>(simp, <span class="dt">dataname =</span> <span class="st">&quot;csv_aggregated_cellvolatility&quot;</span>, 
        <span class="dt">datatype =</span> <span class="st">&quot;AggregateCellVolatility&quot;</span>, <span class="dt">datacolumns =</span> <span class="kw">c</span>(<span class="st">&quot;CellVolatility&quot;</span>, <span class="st">&quot;NumVolatileCells&quot;</span>),
        <span class="dt">percent =</span> <span class="ot">NULL</span>)</code></pre>
</div>
<div id="further-cell-data-as-timeline" class="section level4">
<h4>Further Cell Data as Timeline</h4>
<p>High level:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hl_lines_from_csv</span>(simp, <span class="dt">dataname =</span> <span class="st">&quot;dataobjectname&quot;</span>, 
        <span class="dt">datatype =</span> <span class="st">&quot;Datatype&quot;</span>, <span class="dt">datacolumns =</span> <span class="kw">c</span>(<span class="st">&quot;ColumnA&quot;</span>,<span class="st">&quot;ColumnB&quot;</span>), <span class="dt">linetypecol =</span> <span class="st">&quot;Region&quot;</span>,
        <span class="dt">colourcol =</span> <span class="st">&quot;Type&quot;</span>, <span class="dt">titleprefix =</span> <span class="st">&quot;Title&quot;</span>, <span class="dt">filenameprefix =</span> <span class="st">&quot;FilenamePrefix&quot;</span>, 
        <span class="dt">percent =</span> <span class="ot">NULL</span>)</code></pre>
</div>
</div>
<div id="from-aggregated-region-level-data" class="section level3">
<h3>From Aggregated (Region Level) Data</h3>
<div id="aft-composition-as-timeline-1" class="section level4">
<h4>AFT Composition as Timeline</h4>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(craftyr)
simp &lt;-<span class="st"> </span><span class="kw">param_getDefaultSimp</span>()
<span class="kw">input_tools_load</span>(simp, <span class="st">&quot;dataAggregateAFTComposition&quot;</span>)
dataComp &lt;-<span class="st"> </span>dataAggregateAFTComposition
dataComp[,<span class="kw">grep</span>(<span class="st">&quot;AFT.&quot;</span>, <span class="kw">colnames</span>(dataComp))] &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">do.call</span>(cbind, 
    <span class="kw">lapply</span>(dataComp[,<span class="kw">grep</span>(<span class="st">&quot;AFT.&quot;</span>, <span class="kw">colnames</span>(dataComp))], as.character)))
dataComp &lt;-<span class="st"> </span>dataComp[<span class="kw">complete.cases</span>(dataComp),]
<span class="kw">colnames</span>(dataComp) &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&quot;AFT.&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="kw">colnames</span>(dataComp))
    
data &lt;-reshape2::<span class="kw">melt</span>(dataAggregateAFTComposition, <span class="dt">variable.name=</span><span class="st">&quot;Agent&quot;</span>, <span class="dt">id.vars=</span> <span class="kw">c</span>(<span class="st">&quot;Region&quot;</span>, <span class="st">&quot;Tick&quot;</span>, <span class="st">&quot;Runid&quot;</span>, <span class="st">&quot;Scenario&quot;</span>), <span class="dt">direction=</span><span class="st">&quot;long&quot;</span>)
d &lt;-<span class="st"> </span><span class="kw">aggregate</span>(<span class="kw">subset</span>(data, <span class="dt">select=</span><span class="kw">c</span>(<span class="st">&quot;value&quot;</span>)), <span class="dt">by =</span> <span class="kw">list</span>(<span class="dt">Agent =</span> data$Agent, <span class="dt">Tick=</span> data$Tick, <span class="dt">Runid=</span>data$Runid, <span class="dt">Scenario=</span>data$Scenario), <span class="st">&quot;mean&quot;</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)

############### substitute AFT names by AFT ID
aftNumbers &lt;-<span class="st"> </span><span class="kw">names</span>(simp$mdata$aftNames)
<span class="kw">names</span>(aftNumbers) &lt;-<span class="st"> </span>simp$mdata$aftNames
d$AFT &lt;-<span class="st"> </span>aftNumbers[<span class="kw">as.character</span>(d$AFT)]

<span class="kw">visualise_lines</span>(simp, d, <span class="st">&quot;value&quot;</span>, <span class="dt">title =</span> <span class="st">&quot;AftCompositionInvalid&quot;</span>,
        <span class="dt">colour_column =</span> <span class="st">&quot;AFT&quot;</span>, <span class="dt">colour_legenditemnames =</span> simp$mdata$aftNames,
        <span class="dt">filename =</span> <span class="st">&quot;AftCompositionInvalid&quot;</span>,
        <span class="dt">alpha=</span><span class="fl">0.7</span>)</code></pre>
<p>High level:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hl_aggregate_aftcompositions</span>(simp)</code></pre>
</div>
<div id="aggregated-demand-and-supply-data" class="section level4">
<h4>Aggregated Demand and Supply Data</h4>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(craftyr)
simp &lt;-<span class="st"> </span><span class="kw">param_getExamplesSimp</span>()
<span class="kw">input_tools_load</span>(simp, <span class="st">&quot;csv_aggregateServiceDemand&quot;</span>)

data &lt;-<span class="st"> </span><span class="kw">convert_aggregate_meltsupplydemand</span>(simp, csv_aggregateServiceDemand)

############## Aggregate regions:
data &lt;-<span class="st"> </span><span class="kw">aggregate</span>(<span class="kw">subset</span>(data, <span class="dt">select=</span><span class="kw">c</span>(<span class="st">&quot;Value&quot;</span>)),
        <span class="dt">by =</span> <span class="kw">list</span>(<span class="dt">ID =</span> data[,<span class="st">&quot;Runid&quot;</span>],
                <span class="dt">Tick=</span>data[, <span class="st">&quot;Tick&quot;</span>],  <span class="dt">Scenario =</span> data[,<span class="st">&quot;Scenario&quot;</span>],
                <span class="dt">Service=</span>data[,<span class="st">&quot;Service&quot;</span>], <span class="dt">Type=</span>data[,<span class="st">&quot;Type&quot;</span>]),
        <span class="dt">FUN=</span>sum)

<span class="kw">visualise_lines</span>(simp, data, <span class="st">&quot;Value&quot;</span>, <span class="dt">title =</span> <span class="st">&quot;Aggregated Service Supply &amp; Demand&quot;</span>,
        <span class="dt">colour_column =</span> <span class="st">&quot;Service&quot;</span>,
        <span class="dt">linetype_column =</span> <span class="st">&quot;Type&quot;</span>,
        <span class="dt">filename =</span> <span class="kw">paste</span>(<span class="st">&quot;AggregateServiceDemand&quot;</span>, 
                shbasic::<span class="kw">shbasic_condenseRunids</span>(<span class="kw">data.frame</span>(data)[, <span class="st">&quot;ID&quot;</span>]), <span class="dt">sep=</span><span class="st">&quot;_&quot;</span>),
        <span class="dt">alpha=</span><span class="fl">0.7</span>)</code></pre>
<p><img src="data:image/png;base64,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" /></p>
<p>High level:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hl_aggregate_demandsupply</span>(simp)</code></pre>
</div>
<div id="take-overs-giving-in" class="section level4">
<h4>Take Overs (Giving in)</h4>
<pre class="sourceCode r"><code class="sourceCode r">#################### TODO correct output_visualise_takeovers to work with gradient2sided (bezierArrowGradient2sided.R:304)
<span class="kw">library</span>(craftyr)
simp &lt;-<span class="st"> </span><span class="kw">param_getExamplesSimp</span>()
<span class="kw">input_tools_load</span>(simp, <span class="st">&quot;csv_aggregateTakeOvers&quot;</span>)
<span class="kw">input_tools_load</span>(simp, <span class="st">&quot;csv_cell_aggregated&quot;</span>)
    
startPopulation &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">names</span>(simp$mdata$aftNames), <span class="dv">0</span>)
<span class="kw">names</span>(startPopulation) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Agent&quot;</span>, <span class="st">&quot;AFT&quot;</span>)
sp &lt;-<span class="st"> </span><span class="kw">aggregate</span>(<span class="kw">subset</span>(csv_cell_aggregated, <span class="dt">select=</span><span class="kw">c</span>(<span class="st">&quot;AFT&quot;</span>),
        <span class="dt">subset =</span> csv_cell_aggregated$Tick==<span class="dv">2000</span> &amp;&amp;<span class="st"> </span>csv_cell_aggregated$Runid ==<span class="st"> &quot;0-0&quot;</span>),
        <span class="dt">by =</span> <span class="kw">list</span>(<span class="dt">Agent =</span> csv_cell_aggregated[csv_cell_aggregated$Tick ==<span class="st"> </span><span class="dv">2000</span> &amp;&amp;<span class="st"> </span>
<span class="st">                    </span>csv_cell_aggregated$Runid ==<span class="st"> &quot;0-0&quot;</span>,<span class="st">&quot;LandUseIndex&quot;</span>]), <span class="dt">FUN=</span>sum)
startPopulation[startPopulation$Agent %in%<span class="st"> </span>sp$Agent,<span class="st">&quot;AFT&quot;</span>] &lt;-<span class="st"> </span>sp$AFT 
startPopulation$Agent &lt;-<span class="st"> </span>simp$mdata$aftNames[<span class="kw">as.character</span>(startPopulation$Agent)]
    
simp$mdata$aftNames &lt;-<span class="st"> </span>simp$mdata$aftNames[-<span class="dv">1</span>]
dat &lt;-<span class="st"> </span><span class="kw">aggregate</span>(<span class="kw">subset</span>(csv_aggregateTakeOvers, <span class="dt">select=</span>simp$mdata$aftNames), <span class="dt">by =</span> <span class="kw">list</span>(
        <span class="dt">Tick=</span>csv_aggregateTakeOvers[, <span class="st">&quot;Tick&quot;</span>],
        <span class="dt">Runid=</span>csv_aggregateTakeOvers[, <span class="st">&quot;Runid&quot;</span>],
        <span class="dt">AFT=</span>csv_aggregateTakeOvers[,<span class="st">&quot;AFT&quot;</span>]),
        <span class="dt">FUN=</span>sum)

startPopulation &lt;-<span class="st"> </span>startPopulation[<span class="kw">match</span>(simp$mdata$aftNames, startPopulation$Agent),]
<span class="kw">colnames</span>(startPopulation)[<span class="kw">colnames</span>(startPopulation) ==<span class="st"> &quot;AFT&quot;</span>] &lt;-<span class="st"> &quot;Number&quot;</span>
    
<span class="kw">output_visualise_takeovers</span>(simp,
        <span class="dt">data =</span> dat, 
        <span class="dt">startpopulation =</span> startPopulation,
        <span class="dt">starttick =</span> <span class="dv">2000</span>,
        <span class="dt">endtick =</span> <span class="dv">2020</span>,
        <span class="dt">tickinterval=</span> <span class="dv">1</span>,
        <span class="dt">type_of_arrow =</span> <span class="st">&quot;simple&quot;</span>, <span class="co">#&quot;gradient2sided&quot;,</span>
        <span class="dt">transitionthreshold =</span> <span class="dv">1</span>)</code></pre>
<p>High level:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hl_takeovers</span>(simp)</code></pre>
</div>
<div id="take-overs-all" class="section level4">
<h4>Take Overs (All)</h4>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(craftyr)
simp &lt;-<span class="st"> </span><span class="kw">param_getExamplesSimp</span>()

dataTakeOversAll &lt;-<span class="st"> </span><span class="kw">convert_aggregate_takeovers</span>(simp,
    <span class="dt">landusedataname =</span> <span class="st">&quot;csv_LandUseIndex_rbinded&quot;</span>)
<span class="kw">input_tools_save</span>(simp, <span class="st">&quot;dataTakeOversAll&quot;</span>)
    
<span class="kw">hl_takeovers</span>(simp, <span class="dt">runid =</span> simp$sim$runids[<span class="dv">1</span>], 
        <span class="dt">dataname            =</span> <span class="st">&quot;csv_cell_aggregated&quot;</span>,
        <span class="dt">starttick           =</span> <span class="dv">2000</span>, 
        <span class="dt">tickinterval        =</span> <span class="dv">5</span>, 
        <span class="dt">endtick             =</span> <span class="dv">2020</span>,
        <span class="dt">datanametakeovers   =</span> <span class="st">&quot;csv_aggregateTakeOver&quot;</span>)</code></pre>
<p>High level:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hl_takeovers_all</span>(simp, <span class="dt">landusedataname =</span> <span class="st">&quot;csv_LandUseIndex_rbinded&quot;</span>,
    <span class="dt">starttick =</span> <span class="dv">2000</span>, <span class="dt">tickinterval=</span><span class="dv">5</span>, <span class="dt">endtick =</span> <span class="dv">2020</span>)</code></pre>
</div>
<div id="givinginstatistics-frequencies-per-aft---regions-aggregated" class="section level4">
<h4>GivingInStatistics (Frequencies per AFT - Regions aggregated)</h4>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(craftyr)
<span class="kw">library</span>(reshape2)</code></pre>
<pre><code>## Warning: package 'reshape2' was built under R version 3.1.3</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">simp &lt;-<span class="st"> </span><span class="kw">param_getExamplesSimp</span>()
<span class="kw">input_tools_load</span>(simp, <span class="st">&quot;csv_aggregateGiStatistics&quot;</span>)

regions =<span class="st"> </span>simp$sim$regions
csv_aggregateGiStatistics &lt;-<span class="st"> </span>csv_aggregateGiStatistics[csv_aggregateGiStatistics[,<span class="st">&quot;Region&quot;</span>] %in%<span class="st"> </span>regions,]

dat &lt;-<span class="st"> </span><span class="kw">aggregate</span>(<span class="kw">subset</span>(csv_aggregateGiStatistics, <span class="dt">select=</span>simp$mdata$aftNames[-<span class="dv">1</span>]), <span class="dt">by =</span> <span class="kw">list</span>(
                <span class="dt">Trials=</span>csv_aggregateGiStatistics[, <span class="st">&quot;Trials&quot;</span>],
                <span class="dt">Runid=</span>csv_aggregateGiStatistics[, <span class="st">&quot;Runid&quot;</span>]),
        <span class="dt">FUN=</span>sum)

melteddat &lt;-<span class="st"> </span>reshape2::<span class="kw">melt</span>(dat, <span class="dt">variable.name=</span><span class="st">&quot;AFT&quot;</span>, <span class="dt">id.vars=</span> <span class="kw">c</span>(<span class="st">&quot;Trials&quot;</span>, <span class="st">&quot;Runid&quot;</span>), 
        <span class="dt">direction=</span><span class="st">&quot;long&quot;</span>, <span class="dt">value.name =</span> <span class="st">&quot;Number&quot;</span>)

<span class="kw">visualise_bars</span>(simp, <span class="dt">data =</span> melteddat, <span class="dt">y_column =</span> <span class="st">&quot;Number&quot;</span>, <span class="dt">title =</span> <span class="st">&quot;Giving In Statistics&quot;</span>,
        <span class="dt">facet_column =</span> <span class="st">&quot;AFT&quot;</span>, <span class="dt">facet_ncol =</span> <span class="dv">1</span>, <span class="dt">fill_column =</span> <span class="st">&quot;AFT&quot;</span>,
        <span class="dt">alpha=</span><span class="fl">1.0</span>, <span class="dt">x_column =</span> <span class="st">&quot;Trials&quot;</span>, <span class="dt">ggplotaddons =</span> ggplot2::<span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;none&quot;</span>))</code></pre>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAqAAAAEgCAMAAABcujGyAAABFFBMVEUAAAAAADEAAEIAAFoAAHMAOHsARZQAXZQAcb0xAAAxADExAFoxOHsxXVoxfa0xfb1CAABCAEJCcb1Cmt5aAABaADFaXVpams5zAABzAEJzAHNzcXNzvv97OAB7fXt7fZR7faV7lr17qtZ7ts6URQCUXQCUfXuUfZSUfaWUlnuUlr2UmnOUqqWUtnuUvpSUw9aUw+eUz86U3/+lfXulfZSlfaWl1/+tfTGtmpStz869cQC9lnu9lpS935S96/+9/729///OmlrOtnvOz5TOz63Oz87WqnvWw5TW///emkLe35Te/97e///nGBjnw5Tn19bn5+fn///38/f/vnP/16X/35T/673//73//9b//97//+f////kFhHkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAQOElEQVR4nO2dC1vbyBWGFZJNyNLusiUXtiXaJVzSpt0GwhYa03YXE7N1l7oQX7jo//+PamYkW5Jl6cxIls5kvvd5EixLSMealzM3WfICABjjtR0AAEVAUMAaCApYA0EBayAoYA0EBayBoIA1EBSwBoIC1kBQwBoIClgDQQFrIChgDQQFrIGggDUQFLAGggLWQFDAGggKWANBAWsgKGANBAWsgaCANRAUsAaC5nCz6YWsipd3u48vp++nFvJ+bTXv7aHY2cr7Bb+Us8+Sw7gFBJ2n4ymEVNUFjfcm1vUf/ZxcJRYz+8x5y20g6ByhUVvqZ1qnUnIFHXrStvG62GknvcfO/AFy3nIbCJplvB470leikskVtB9V7uP1DQhqAATNMtPy5veyuv11V0ojXz2+DH/8Z93zNuQGYVt15a/rG/H2QtDk+vTuwlWqppeN0o1oUdXnoh0gK/fZW2LnytZopZtA0AyZBqBYVI6FKfBOCqqalBuy2o5fSiJB02+KjVbjfUlB+9EGCRs7UZs38ZbaufAyXtncOeAEBM2QqaeFLOqtjvBHCroq8uKq8E1ZmhU0Wh8RaSyXRQV+symsu9kUXkY9InWAoRc1AqLDbKj0m1jpIhA0QySoGmmSNfpl5JVauNuN/Rqvyy2HWUGn/k3pxCkwbmGKTJkS1Is3TzsbReJypx6CZoiq+JSgwzCRiX9KULFe/D9UrcvxXBv0MmdAKtzfaiRolFITgka1vszT0VuzvSZWuggEzdKZtvamPgrzZnWvnqDj38U7C3egUrFooKaq+NnfQ56gs5UuAkGzjNdjFWY+9h/9FMs3E3BRFZ8SVLU4g4SgyuuMoGrT8E9jvopPrHQRCDpHPFAfVsWxj+P1P4j30oIu6iSlM2hH9b9V30lk56F4oRqWYnGm+t2uEDR6K9x+S+x8NUisdBEIOk88OelNE1yoy0zLqYALhpnSgsbDTnIHYXNyVVXYcuf99DCT6v6nhplkz2o2VeogEDQHJVU8PC9M60sLM4IuGqjPdJLkuLxKyjJxSkO3RKoUi7/uRuZ6UdUfvzUbqJ+udBEIWpVkdwbUDgQ1Ro11Ott7aQgIao7bjcOGgKAVcLpx2BDagvYAWBIQFLAGggLWQFDAGggKWANBAWsgKGANBG2Kswc7vV73qRzHly/XDtsOyQYgaEN8fPXiiXwRiXn+7CEEJQBBG6K79oMyUwl64v0WGZQCBG2Ikye9va/ECyXo3z+giicBQZvh/PlO7+yLD71Z2xOCkoCgzSDkPH/2sgdBNYGgjfDxley9i24SBNUCgjaCsrH75Q4E1QSCNsKeGmIS3SQIqgUEbQLRRRKcPTyEoHpAUMAaCApYA0EBayAoYE0tgl4p4p/L4NMS921t4C7EDUGv7A3chbgh6JW9gbsQdy2CflLEP63D1sBdiBsZ9MrewF2I20zQyb6/fQ1BKXApaF24xG0k6O3RQTB4DUEpcCloXbjEbSTo5I//Dm5//BcEJcCloHXhEndFQX1J2fYA1Amhij8OBv7xdNngD0MXZNAcXIjbSFDRSXp3CkEpcCloXbjEbSaoyKJog5LgUtC6cInbWFDRDoWg5XApaF24xG0kqMieF4lhJoMJAlbYGrgLcZtl0JGPgXoiXDKRLlziNhP0/tT3DyAoBS4FrQuXuM0Evdi+nrxBJ4kCl4LWhUvcRoIme/AQtBguBa0Ll7iNBJ314DGTBJqnVNDR9i9+YiIJGbQALplIFy5xmwka9pBG36ENSoFLQevCJW7DDHodduQx1UmBS0HrwiVuI0FFGxSC0uBS0LpwidtI0OAirOK/n011GkwQsMLWwF2I20xQMVCPThIJLplIFy5xmwk68v1EHwmCFsCloHXhEreRoGIWKVnFGxxXFwiagwtxm2XQANeDUuFS0LpwidtY0IG8nAkzSaB5CIJO9tEGpcElE+nCJW5DQQO0QYlwKWhduMRtLCjaoDS4FLQuXOKGoFf2Bu5C3EaCiup98nb2nQ+DCQJW2Bq4C3GbZdCB7yeaoMigBXDJRLpwidtM0PtTCEqES0HrwiVuM0EvXqe+dmxwXF0gaA4uxG0kqOgg4cYNNLgUtC5c4jYSFHe3A22C+4PWCJdMpAuXuGsRFIAmgaCANdqdJACaRHuYCYAmKRf09ig1UA9Ak+Bpx4ANEBSwBoIC1kBQwBoIClgDQQFrIChgDQRtirMHO71e96kneLAjXrxsOyQbgKAN8fHViyfyRXftsNc7f/ZSGQtKgKAN0V37QZgZCXr2xYdQWaTQciBoQ5w86e19JV50lacqi4IyIGgznD/fkWkzIeiJXATFEAW9292AoFUQcqqUGQt68vCw3ZDsgCjozeYWBK3Ax1ey9y66SZGgJ+gikSAKGgwf/QxBzVFWdr/ciV8ifxIhZ1BPketp2x+CP3tqiEl0k6SgUlVAgJpBC2n7Q7BHdJEEZ2HelILuyb929OLLgaCANWRBw0r+8WUnvy/f9ocAny9UQYcr7/uPL282cw1t+0OAzxeioGIcNBQ06Od2kgxuGKEL7iySgwtxEwUV46BC0PzRJoPj6gJBc3Ahbs0M2gn/QVAduBS0LlziJgoatUH7Xu6EksFxdYGgObgQN1VQNVS/8j5vFe5R3xIuxE0WNMVk39+ePUMBGbQALplIFy5xGwl6e3QQDHALcBJcCloXLnGTBZVVfNRFwg1s6XApaF24xE0VdCi7R33VCIWgdLgUtC5c4iYKGl+wrIaZbo+Og4F/HOAe9aANCi5Yjgbqw07Su9Pj6VqDPwxdkEFzcCFuoqB3u6vyZ386UI8qngaXgtaFS9xEQcM2qKjjh7OBUDwniQaXgtaFS9wUQaeX08dX1IvsiSfN0eBS0LpwiZuaQdOM/NRAvcEEAStsDdyFuM0EvT/1/QNkUApcMpEuXOKmChpX86oXf7F9PXmDThIFLgWtC5e4iYLe7Savs8s+xMvguLpA0BxciJsoaPrGDdmHeBkcVxcImoMLcZMzaPLLSKPtX3w5keT6TNLXZbQd4OdJXht0/E3iUtBR2EMafYc26FWpoHwykS5c4iYLup7oJI22r8OOPKY6IagZS5zqVIg2KAS9YikoISQSlgmaubvdRVjFf4+pTghqxtI7SXKgfpZA3Z1JKrWhzijnyYu75ZBILGMmKdVJElOdiT5S5QxaelK/RgbNg0EGNTrcUqr45MUiYhapzioegpoBQQuo83pQCGoGBC1gkLicyeC4ep8SguYCQadk77A82Vdt0HpmksoFrW2jqqFqBk7diPTh6gup4TNQN4szaOLeYY23QQkbmeaP5WbQWuImZyKzMzCPZRk0pjMdr2+8DUoqQ7PigaDzWCroLIVaLKjRSTULnKmgpLjrOgPVTrimoOoGtqJ6n7xtuJNE2AiCui7ozaaq4ge+n2iCVp5JKv0AX9e2Eelw9QVO3ah0m9yYjGeSjI623DOwCKKgcS8+uq7+/jQlaMEfdF35o/EMWtdGNWbQejb6rDNozMVr8teOKcGVbgNBIaiOoKKDRL1xAyW40m0gKAQtEHTuxg06d7ejBFe6DQSFoKQM2pE3wEkI6vh3kkArLBI0zKTqsuVsBgWgSRYIOl6PR+khKGiTfEH7XurWi9nvxgPQFHmC3u16iS99ZIaZAGiS/IH65Lfmbo9SA/UANMm8oEMv9xmdMW0/ERd8vpAETTQ/IShoFIqgcwP1EBQ0BSmDltH2hwCfLxAUsAaCAtZAUMAaCNoUZw92er3uU9nVfLBzJv5rOyQbgKAN8fHViyfyRXftMPzvy53e2cPDlmOyAQjaEN21H9YO1YvIy/PnSKHlQNCGOHnS2/tKvJgKevLFhzYDsgQI2gwiXZ5JIyNBu0/RBqUAQZtByHn+7GUvkUHRBqUAQRvh4yvZexfdJLRBtYCgjaCsFH13CKoHBG2EPTXEJLpJUlBRvXd/g05SORC0CeJkKb2UGfTE89AEpQBBAWsgKGANBAWsgaCANbUIWnRvpprg+ZQPAlweKagLl7gh6JW9gbsQ99IF/W8ZtDghaA4uxF2LoAV3pP5UKij5btPLw9an4LoQNzLolRuZSBcucZsJOtn3E09ChKAFcCloXbjEbSTo7dFBMCDeox6CLg8X4jYSVOcW4BB0ebgQd0VBy28BXipo2cEAyECo4o+DgX88XS76w0AGXR4uxG0kqOgkvTuFoBS4FLQuXOI2EzSgP0wWgi4PF+I2FpT6IC8IujxciNtIUJE9k/eoL5ogKBW0+sREZVyYkeHE8meSRj4G6olwyUS6cInbTND7U98/gKAUuBS0LlziNhP0Yvt68gadJApcCloXLnEbCZp9ylzRcSHo8nAhbiNBZz14zCSB5ikVdLT9i5+YSEIGLYBLJtKFS9xmgoY9pNF3aINS4FLQunCJ2zCDXocdeUx1UuBS0LpwidtIUNEGhaA0uBS0LlziNhI0uAir+MTTZIsmCEoFrT4xURkXZmQ4sfyZJDFQj04SCS6ZSBcucZsJOvL9RB8JghbApaB14RK3kaBiFilZxRcdF4IuDxfiNsugAa4HpcKloHXhErexoAN5ORNmkkDzEASd7KMNSoNLJtKFS9yGggZogxLhUtC6cInbWFC0QWlwKWhduMQNQa/cKGhduMRtJKio3idvZ9/5KJogKBW0+sREZVyYkeHE8meSBr6faIIigxbAJRPpwiVuM0HvTyEoES4FrQuXuM0EvXid+tpx0XEh6PJwIW4jQUUHCTduoMGloHXhEreRoDp3twOgbmq9P2hNIIPm4ELctQgaYW0mtTVwV+OGoJbgatzanaSajtsatgbuatzaw0w1Hbc1bA3c1bjLBb09Sg3U13Tc1rA1cFfj1n6QV03HbQ1bA3c1blNBAWgECApYA0EBayAoYA0EBawxEjRziag9TPbTT4SwBDlRYuFJl3FXPOdGguaP3VvAyMqob4+EmfaddBV3xXNuIuiC2U8LuDgo34YdA/8v0fUQdp10FXfVc24i6ILrR/hz/w8Lgw7+dy1OuH0nXcVd9Zw7Jejtj39K3anPFuwUNBal2jl3SlBxp77bv9lUTSpsFrTqOXdKUIGNgdssqKBK3G51kgJ7BbXxpLclqIUjHorsXVJsQRa0hSddxF31nBsJmn+JqAVk7pJiC1JQC0+6jLviOcdUJ2ANBAWsgaCANRAUsAaCAtZAUMAaCFobN5ue4tHPanEruW5r0a+BQiBorYy/eZ/7PgQ1BYLWCgStGwhaK0rQm2//7D36STrZCav8LSXoeF29BjpA0FqJBN18fKmSZmc1CPor78XCeD1cHsJQTSBorcSCbqikefNtuCjMDBeGqu8E9ICgtRILujVrdg5FvR4u3GzCUAMgaK1kBe173qN/qgwa3O2iDaoPBK2VjKCy3RlV8XJ9ZyW/lw8WAUFrJSOobHcOvZmgGG7SBYLWSk4Gvdn0NmQnSSTPITKoJhC0VnLaoCvvw3pdplNPLLQdoW1AUMAaCApYA0EBayAoYA0EBayBoIA1EBSwBoIC1kBQwBoIClgDQQFrIChgDQQFrIGggDX/B6JwxMiQ6YBqAAAAAElFTkSuQmCC" /></p>
<p>High level:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hl_gistatistics_singleRegion</span>(simp, <span class="dt">dataname =</span> <span class="st">&quot;csv_aggregateGiStatistics&quot;</span>, 
        <span class="dt">regions =</span> simp$sim$regions, <span class="dt">facet_ncol =</span> <span class="dv">1</span>)</code></pre>
</div>
<div id="pre-allocation-competitiveness" class="section level4">
<h4>Pre-Allocation Competitiveness</h4>
<p>% TODO High level:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hl_competitiveness_prealloc</span>(simp, <span class="dt">dataname =</span> <span class="st">&quot;csv_preAlloc_rbinded&quot;</span>, 
        <span class="dt">facet_ncol =</span> <span class="kw">length</span>(simp$mdata$aftNames), <span class="dt">filename =</span> <span class="kw">paste</span>(<span class="st">&quot;PreAllocationCompetition&quot;</span>, 
        simp$sim$id, <span class="dt">sep=</span><span class="st">&quot;_b_&quot;</span>),
        <span class="dt">maxcompetitiveness =</span> <span class="st">&quot;100%&quot;</span>, <span class="dt">numbins =</span> <span class="dv">15</span>, <span class="dt">title =</span> <span class="ot">NULL</span>, <span class="dt">ggplotaddons =</span> <span class="ot">NULL</span>, <span class="dt">checkexists =</span> <span class="ot">FALSE</span>)</code></pre>
<p>High level when separating AFTs:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hl_competitiveness_preallocPerAft</span>(simp, <span class="dt">dataname =</span> <span class="st">&quot;csv_preAlloc_rbinded&quot;</span>, 
        <span class="dt">facet_ncol =</span> <span class="kw">length</span>(simp$mdata$aftNames), <span class="dt">filename =</span> <span class="kw">paste</span>(<span class="st">&quot;PreAllocationCompetition&quot;</span>, 
        simp$sim$id, <span class="dt">sep=</span><span class="st">&quot;_b_&quot;</span>),
        <span class="dt">maxcompetitiveness =</span> <span class="st">&quot;100%&quot;</span>, <span class="dt">numbins =</span> <span class="dv">15</span>, <span class="dt">title =</span> <span class="ot">NULL</span>, <span class="dt">ggplotaddons =</span> <span class="ot">NULL</span>, <span class="dt">checkexists =</span> <span class="ot">FALSE</span>)</code></pre>
</div>
<div id="cell-volatility-1" class="section level4">
<h4>Cell Volatility</h4>
<p>TODO</p>
<pre class="sourceCode r"><code class="sourceCode r">cellnumber &lt;-<span class="st"> </span><span class="kw">input_csv_param_capitals_cellnumbers</span>(simp, <span class="dt">capitals =</span> simp$mdata$capitals, 
        <span class="dt">regionpartfromend =</span> <span class="dv">2</span>, <span class="dt">regionpartdevider =</span> <span class="st">&quot;_&quot;</span>)</code></pre>
<p>High level:</p>
<pre class="sourceCode r"><code class="sourceCode r">numcells &lt;-<span class="st"> </span>cellnumbers &lt;-<span class="st"> </span><span class="kw">input_csv_param_capitals_cellnumbers</span>(simp, <span class="dt">regionpartfromend =</span> <span class="dv">2</span>, <span class="dt">regionpartdevider =</span> <span class="st">&quot;_&quot;</span>)
<span class="kw">hl_volatility</span>(simp, <span class="dt">dataname =</span> <span class="st">&quot;csv_aggregated_cellvolatility&quot;</span>, 
        <span class="dt">datatype =</span> <span class="st">&quot;AggregateCellVolatility&quot;</span>, <span class="dt">datacolumns =</span> <span class="kw">c</span>(<span class="st">&quot;CellVolatility&quot;</span>, <span class="st">&quot;NumVolatileCells&quot;</span>),
        <span class="dt">percent =</span> numcells)</code></pre>
</div>
<div id="marginal-utilities" class="section level4">
<h4>Marginal Utilities</h4>
<p>TODO</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">input_tools_load</span>(simp, <span class="st">&quot;csv_MarginalUtilitites_melt&quot;</span>)
<span class="kw">visualise_lines</span>(simp, data, <span class="st">&quot;value&quot;</span>, <span class="dt">title =</span> <span class="st">&quot;Marginal Utilities&quot;</span>,
        <span class="dt">colour_column =</span> <span class="st">&quot;Service&quot;</span>,
        <span class="dt">filename =</span> <span class="kw">paste</span>(<span class="st">&quot;MarginalUtilities&quot;</span>, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>),
        <span class="dt">alpha=</span><span class="fl">0.7</span>)</code></pre>
<p>High level:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hl_marginalutilities</span>(simp)</code></pre>
</div>
<div id="demand-normalised-per-cell-marginal-utilities" class="section level4">
<h4>Demand-normalised per-cell marginal Utilities</h4>
<p>The file MarginalUtilitiesPerCell.csv can be craeted by python script extractMarginalUtilityFromFiles.py.</p>
<p>TODO</p>
<p>High level:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hl_normalisedutilities</span>(simp,
        <span class="dt">filenamemarginalutils =</span> <span class="kw">paste</span>(simp$dirs$output$rdata, <span class="st">&quot;MarginalUtilitiesPerCell.csv&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;/&quot;</span>),
        <span class="dt">filenameNormalisedResiduals =</span> <span class="kw">paste</span>(<span class="st">&quot;NormalisedResiduals&quot;</span>, 
                shbasic::<span class="kw">shbasic_condenseRunids</span>(<span class="kw">data.frame</span>(data)[, <span class="st">&quot;ID&quot;</span>]), <span class="dt">sep=</span><span class="st">&quot;_&quot;</span>),
        <span class="dt">capitalfilepartorder =</span> <span class="kw">c</span>(<span class="st">&quot;regionalisation&quot;</span>, <span class="st">&quot;U&quot;</span>, <span class="st">&quot;regions&quot;</span>, <span class="st">&quot;U&quot;</span>, <span class="st">&quot;datatype&quot;</span>))</code></pre>
</div>
<div id="total-productivity" class="section level4">
<h4>Total Productivity</h4>
</div>
</div>
<div id="from-single-files" class="section level3">
<h3>From Single Files</h3>
<div id="aft-composition" class="section level4">
<h4>AFT Composition</h4>
<p>Reads single CSV file with AFT composition and produces timeline figure.</p>
<p>High level:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hl_aftcomposisition_file</span>(simp, csvfilename, <span class="dt">title =</span> <span class="st">&quot;AftComposition&quot;</span>, 
        <span class="dt">figurefilename =</span> <span class="st">&quot;AftComposition&quot;</span>) 

### Comparisons
To compare different data sets, according sip lists need to be defined:</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">source</span>(<span class="st">&quot;./simp44.R&quot;</span>)
simp1 &lt;-<span class="st"> </span>simp
simp1$sim$shortid &lt;-<span class="st"> &quot;SD.9&quot;</span>

<span class="kw">source</span>(<span class="st">&quot;./simp45.R&quot;</span>)
simp2 &lt;-<span class="st"> </span>simp
simp2$sim$shortid &lt;-<span class="st"> &quot;SD.4&quot;</span>

<span class="kw">source</span>(<span class="st">&quot;./simp46.R&quot;</span>)
simp3 &lt;-<span class="st"> </span>simp
simp3$sim$shortid &lt;-<span class="st"> &quot;SD.55&quot;</span>
simps &lt;-<span class="st"> </span><span class="kw">list</span>(simp1, simp2, simp3)</code></pre>
</div>
<div id="aft-composition-1" class="section level4">
<h4>AFT Composition</h4>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hl_comp_aggregate_aftcompositions</span>(simp, simps, <span class="dt">dataname=</span><span class="st">&quot;dataAggregateAFTComposition&quot;</span>)</code></pre>
</div>
<div id="demand-and-supply" class="section level4">
<h4>Demand and Supply</h4>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hl_comp_demandsupply</span>(simp, simps, <span class="dt">dataname=</span><span class="st">&quot;dataAggregateSupplyDemand&quot;</span>)</code></pre>
</div>
</div>
</div>
</div>
<div id="output-write-csv-data" class="section level1">
<h1>Output (write) CSV Data</h1>
<div id="generate-landuseindex-key" class="section level2">
<h2>Generate LandUseIndex key</h2>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hl_landindiceskey_csv</span>(simp)</code></pre>
</div>
<div id="aggregate-demand-and-supply" class="section level2">
<h2>Aggregate demand and supply</h2>
<p>Aggregates demand and supply for all regions per tick and stores data as CSV file.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hl_aggregate_demandsupply_csv</span>(simp)</code></pre>
</div>
<div id="supplydemand-gap-regarding-agent-parameters-gu-probability" class="section level2">
<h2>Supply/Demand gap regarding agent parameters (GU probability)</h2>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hl_comp_demandsupplygap_agentparams</span>(simp, <span class="dt">simps =</span> <span class="kw">input_tools_buildsimplist</span>(<span class="dv">111</span>:<span class="dv">116</span>),
        <span class="dt">dataname =</span> <span class="st">&quot;dataAggregateSupplyDemand&quot;</span>, 
        <span class="dt">filename =</span> <span class="kw">paste</span>(<span class="st">&quot;SupplyDemandGap_&quot;</span>, 
                if(!<span class="kw">is.null</span>(simp$sim$rundesc))<span class="kw">paste</span>(simp$sim$rundesc, <span class="dt">collapse =</span> <span class="st">&quot;-&quot;</span>) else simp$sim$id, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>),
        <span class="dt">title =</span> <span class="st">&quot;Demand/Supply Gap&quot;</span>,
        <span class="dt">agentparam =</span> <span class="st">&quot;givingUpProb&quot;</span>, <span class="dt">aft =</span> simp$mdata$aftNames[<span class="dv">2</span>], 
        <span class="dt">ggplotparams =</span> ggplot2::<span class="kw">xlab</span>(<span class="st">&quot;Probability of Giving up&quot;</span>))</code></pre>
</div>
</div>
<div id="conversions" class="section level1">
<h1>Conversions</h1>
<ul>
<li>convert_csv2shapefile</li>
</ul>
<div id="stored-csvdata.frame-rdata-to-raster-file-ascii" class="section level2">
<h2>Stored CSV/data.frame (rData) to raster file (ASCII)</h2>
<pre class="sourceCode r"><code class="sourceCode r">simp &lt;-<span class="st"> </span><span class="kw">param_getExamplesSimp</span>()
<span class="kw">input_tools_load</span>(simp, <span class="dt">dataname =</span> <span class="st">&quot;csv_LandUseIndex_rbinded&quot;</span>)

data &lt;-<span class="st"> </span><span class="kw">get</span>(dataname)
data &lt;-<span class="st"> </span>data[data$Tick ==<span class="st"> </span><span class="dv">2010</span>, <span class="kw">c</span>(simp$csv$cname_x, simp$csv$cname_y, <span class="st">&quot;LandUseIndex&quot;</span>)]
<span class="kw">rownames</span>(data) &lt;-<span class="st"> </span><span class="ot">NULL</span>

raster &lt;-<span class="st"> </span>craftyr::<span class="kw">convert_2raster</span>(simp, data, <span class="dt">targetCRS =</span> <span class="st">&quot;+init=EPSG:32632&quot;</span>, <span class="dt">layers=</span><span class="kw">c</span>(<span class="dv">1</span>))

filename &lt;-<span class="st"> </span><span class="kw">sprintf</span>(<span class="st">&quot;%s/%s_LandUseIndex_%d.%s&quot;</span>,
        simp$dirs$output$raster,
        <span class="kw">output_tools_getDefaultFilename</span>(simp),
        <span class="kw">as.integer</span>(tick),
        <span class="st">&quot;asc&quot;</span>)
shbasic::<span class="kw">sh.ensurePath</span>(filename, <span class="dt">stripFilename =</span> <span class="ot">TRUE</span>)
raster::<span class="kw">writeRaster</span>(raster[[<span class="dv">1</span>]][[<span class="dv">1</span>]], <span class="dt">filename =</span> filename, <span class="dt">format =</span> <span class="st">&quot;ascii&quot;</span>, 
        <span class="dt">NAflag=</span>naflag, <span class="dt">overwrite=</span><span class="ot">TRUE</span>)</code></pre>
<p>High level:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hl_cell2raster</span>(simp, tick, <span class="dt">dataname =</span> <span class="st">&quot;csv_LandUseIndex_rbinded&quot;</span>, 
        <span class="dt">landuseindexcolname =</span> <span class="st">&quot;LandUseIndex&quot;</span>, <span class="dt">naflag =</span> -<span class="dv">9</span>)</code></pre>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
