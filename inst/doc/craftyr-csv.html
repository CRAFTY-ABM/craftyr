<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="author" content="Sascha Holzhauer" />

<meta name="date" content="2015-06-08" />

<title>Using CSV data with craftyr</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; }
code > span.dt { color: #902000; }
code > span.dv { color: #40a070; }
code > span.bn { color: #40a070; }
code > span.fl { color: #40a070; }
code > span.ch { color: #4070a0; }
code > span.st { color: #4070a0; }
code > span.co { color: #60a0b0; font-style: italic; }
code > span.ot { color: #007020; }
code > span.al { color: #ff0000; font-weight: bold; }
code > span.fu { color: #06287e; }
code > span.er { color: #ff0000; font-weight: bold; }
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<link href="data:text/css,body%20%7B%0A%20%20background%2Dcolor%3A%20%23fff%3B%0A%20%20margin%3A%201em%20auto%3B%0A%20%20max%2Dwidth%3A%20700px%3B%0A%20%20overflow%3A%20visible%3B%0A%20%20padding%2Dleft%3A%202em%3B%0A%20%20padding%2Dright%3A%202em%3B%0A%20%20font%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0A%20%20font%2Dsize%3A%2014px%3B%0A%20%20line%2Dheight%3A%201%2E35%3B%0A%7D%0A%0A%23header%20%7B%0A%20%20text%2Dalign%3A%20center%3B%0A%7D%0A%0A%23TOC%20%7B%0A%20%20clear%3A%20both%3B%0A%20%20margin%3A%200%200%2010px%2010px%3B%0A%20%20padding%3A%204px%3B%0A%20%20width%3A%20400px%3B%0A%20%20border%3A%201px%20solid%20%23CCCCCC%3B%0A%20%20border%2Dradius%3A%205px%3B%0A%0A%20%20background%2Dcolor%3A%20%23f6f6f6%3B%0A%20%20font%2Dsize%3A%2013px%3B%0A%20%20line%2Dheight%3A%201%2E3%3B%0A%7D%0A%20%20%23TOC%20%2Etoctitle%20%7B%0A%20%20%20%20font%2Dweight%3A%20bold%3B%0A%20%20%20%20font%2Dsize%3A%2015px%3B%0A%20%20%20%20margin%2Dleft%3A%205px%3B%0A%20%20%7D%0A%0A%20%20%23TOC%20ul%20%7B%0A%20%20%20%20padding%2Dleft%3A%2040px%3B%0A%20%20%20%20margin%2Dleft%3A%20%2D1%2E5em%3B%0A%20%20%20%20margin%2Dtop%3A%205px%3B%0A%20%20%20%20margin%2Dbottom%3A%205px%3B%0A%20%20%7D%0A%20%20%23TOC%20ul%20ul%20%7B%0A%20%20%20%20margin%2Dleft%3A%20%2D2em%3B%0A%20%20%7D%0A%20%20%23TOC%20li%20%7B%0A%20%20%20%20line%2Dheight%3A%2016px%3B%0A%20%20%7D%0A%0Atable%20%7B%0A%20%20margin%3A%201em%20auto%3B%0A%20%20border%2Dwidth%3A%201px%3B%0A%20%20border%2Dcolor%3A%20%23DDDDDD%3B%0A%20%20border%2Dstyle%3A%20outset%3B%0A%20%20border%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0A%20%20border%2Dwidth%3A%202px%3B%0A%20%20padding%3A%205px%3B%0A%20%20border%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0A%20%20border%2Dwidth%3A%201px%3B%0A%20%20border%2Dstyle%3A%20inset%3B%0A%20%20line%2Dheight%3A%2018px%3B%0A%20%20padding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0A%20%20border%2Dleft%2Dstyle%3A%20none%3B%0A%20%20border%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0A%0Ap%20%7B%0A%20%20margin%3A%200%2E5em%200%3B%0A%7D%0A%0Ablockquote%20%7B%0A%20%20background%2Dcolor%3A%20%23f6f6f6%3B%0A%20%20padding%3A%200%2E25em%200%2E75em%3B%0A%7D%0A%0Ahr%20%7B%0A%20%20border%2Dstyle%3A%20solid%3B%0A%20%20border%3A%20none%3B%0A%20%20border%2Dtop%3A%201px%20solid%20%23777%3B%0A%20%20margin%3A%2028px%200%3B%0A%7D%0A%0Adl%20%7B%0A%20%20margin%2Dleft%3A%200%3B%0A%7D%0A%20%20dl%20dd%20%7B%0A%20%20%20%20margin%2Dbottom%3A%2013px%3B%0A%20%20%20%20margin%2Dleft%3A%2013px%3B%0A%20%20%7D%0A%20%20dl%20dt%20%7B%0A%20%20%20%20font%2Dweight%3A%20bold%3B%0A%20%20%7D%0A%0Aul%20%7B%0A%20%20margin%2Dtop%3A%200%3B%0A%7D%0A%20%20ul%20li%20%7B%0A%20%20%20%20list%2Dstyle%3A%20circle%20outside%3B%0A%20%20%7D%0A%20%20ul%20ul%20%7B%0A%20%20%20%20margin%2Dbottom%3A%200%3B%0A%20%20%7D%0A%0Apre%2C%20code%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20color%3A%20%23333%3B%0A%7D%0Apre%20%7B%0A%20%20white%2Dspace%3A%20pre%2Dwrap%3B%20%20%20%20%2F%2A%20Wrap%20long%20lines%20%2A%2F%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20margin%3A%205px%200px%2010px%200px%3B%0A%20%20padding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0A%0Acode%20%7B%0A%20%20font%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0A%20%20font%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0A%20%20padding%3A%202px%200px%3B%0A%7D%0A%0Adiv%2Efigure%20%7B%0A%20%20text%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0A%20%20background%2Dcolor%3A%20%23FFFFFF%3B%0A%20%20padding%3A%202px%3B%0A%20%20border%3A%201px%20solid%20%23DDDDDD%3B%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20border%3A%201px%20solid%20%23CCCCCC%3B%0A%20%20margin%3A%200%205px%3B%0A%7D%0A%0Ah1%20%7B%0A%20%20margin%2Dtop%3A%200%3B%0A%20%20font%2Dsize%3A%2035px%3B%0A%20%20line%2Dheight%3A%2040px%3B%0A%7D%0A%0Ah2%20%7B%0A%20%20border%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0A%20%20padding%2Dtop%3A%2010px%3B%0A%20%20padding%2Dbottom%3A%202px%3B%0A%20%20font%2Dsize%3A%20145%25%3B%0A%7D%0A%0Ah3%20%7B%0A%20%20border%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0A%20%20padding%2Dtop%3A%2010px%3B%0A%20%20font%2Dsize%3A%20120%25%3B%0A%7D%0A%0Ah4%20%7B%0A%20%20border%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0A%20%20margin%2Dleft%3A%208px%3B%0A%20%20font%2Dsize%3A%20105%25%3B%0A%7D%0A%0Ah5%2C%20h6%20%7B%0A%20%20border%2Dbottom%3A%201px%20solid%20%23ccc%3B%0A%20%20font%2Dsize%3A%20105%25%3B%0A%7D%0A%0Aa%20%7B%0A%20%20color%3A%20%230033dd%3B%0A%20%20text%2Ddecoration%3A%20none%3B%0A%7D%0A%20%20a%3Ahover%20%7B%0A%20%20%20%20color%3A%20%236666ff%3B%20%7D%0A%20%20a%3Avisited%20%7B%0A%20%20%20%20color%3A%20%23800080%3B%20%7D%0A%20%20a%3Avisited%3Ahover%20%7B%0A%20%20%20%20color%3A%20%23BB00BB%3B%20%7D%0A%20%20a%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0A%20%20%20%20text%2Ddecoration%3A%20underline%3B%20%7D%0A%20%20a%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0A%20%20%20%20text%2Ddecoration%3A%20underline%3B%20%7D%0A%0A%2F%2A%20Class%20described%20in%20https%3A%2F%2Fbenjeffrey%2Ecom%2Fposts%2Fpandoc%2Dsyntax%2Dhighlighting%2Dcss%0A%20%20%20Colours%20from%20https%3A%2F%2Fgist%2Egithub%2Ecom%2Frobsimmons%2F1172277%20%2A%2F%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20Keyword%20%2A%2F%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%2F%2A%20DataType%20%2A%2F%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%2F%2A%20DecVal%20%28decimal%20values%29%20%2A%2F%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20BaseN%20%2A%2F%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20Float%20%2A%2F%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20Char%20%2A%2F%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20String%20%2A%2F%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%2F%2A%20Comment%20%2A%2F%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%2F%2A%20OtherToken%20%2A%2F%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20AlertToken%20%2A%2F%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20Function%20calls%20%2A%2F%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%2F%2A%20ErrorTok%20%2A%2F%0A%0A" rel="stylesheet" type="text/css" />

</head>

<body>



<div id="header">
<h1 class="title">Using CSV data with craftyr</h1>
<h4 class="author"><em>Sascha Holzhauer</em></h4>
<h4 class="date"><em>2015-06-08</em></h4>
</div>

<div id="TOC">
<ul>
<li><a href="#input-read-csv-data">Input (read) CSV Data</a><ul>
<li><a href="#features">Features</a></li>
<li><a href="#source-regional-csv-data-celltable">Source: Regional CSV data (CellTable)</a></li>
<li><a href="#source-aggregated-demand-and-supply-data-aggregatedemandsupplycsvoutputter">Source: Aggregated Demand and Supply Data (AggregateDemandSupplyCSVOutputter)</a></li>
<li><a href="#source-marginal-utilities">Source: Marginal Utilities</a></li>
</ul></li>
<li><a href="#visualise-csv-data">Visualise CSV Data</a><ul>
<li><a href="#map-data">Map Data</a><ul>
<li><a href="#landuseindex-facets">LandUseIndex: Facets</a></li>
<li><a href="#landuseindex-raw-plot">LandUseIndex: Raw Plot</a></li>
</ul></li>
<li><a href="#aggregate-data">Aggregate Data</a><ul>
<li><a href="#aft-composition-as-timeline">AFT Composition as Timeline</a></li>
<li><a href="#aggregated-demand-and-supply-data">Aggregated Demand and Supply Data</a></li>
<li><a href="#marginal-utilities">Marginal Utilities</a></li>
<li><a href="#total-productivity">Total Productivity</a></li>
</ul></li>
</ul></li>
</ul>
</div>

<div id="input-read-csv-data" class="section level1">
<h1>Input (read) CSV Data</h1>
<div id="features" class="section level2">
<h2>Features</h2>
<pre><code>* Limit considered ticks by starttick, endtick, and interval
* Read CSV files of multiple regions at once</code></pre>
</div>
<div id="source-regional-csv-data-celltable" class="section level2">
<h2>Source: Regional CSV data (CellTable)</h2>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(craftyr)
simp &lt;-<span class="st"> </span><span class="kw">param_getExamplesSimp</span>()
cdata &lt;-<span class="st"> </span><span class="kw">input_csv_data</span>(simp, <span class="dt">dataname =</span> <span class="ot">NULL</span>, <span class="dt">datatype =</span> <span class="st">&quot;Cell&quot;</span>, <span class="dt">columns =</span> <span class="st">&quot;LandUseIndex&quot;</span>,
        <span class="dt">pertick =</span> <span class="ot">TRUE</span>, <span class="dt">starttick =</span> <span class="dv">2010</span>, <span class="dt">endtick =</span> <span class="dv">2020</span>, <span class="dt">tickinterval =</span> <span class="dv">10</span>,
        <span class="dt">attachfileinfo =</span> <span class="ot">TRUE</span>, <span class="dt">bindrows =</span> <span class="ot">TRUE</span>)
csv_LandUseIndex &lt;-<span class="st"> </span>cdata
<span class="kw">input_tools_save</span>(simp, <span class="st">&quot;csv_LandUseIndex&quot;</span>)
cdata &lt;-<span class="st"> </span><span class="kw">split</span>(cdata, <span class="kw">list</span>(cdata$Tick,cdata$Runid))
csv_LandUseIndex_split &lt;-<span class="st"> </span>cdata
<span class="kw">input_tools_save</span>(simp, <span class="st">&quot;csv_LandUseIndex_split&quot;</span>)</code></pre>
<p>For large data sets it is a good idea to clean the data somewhat before storing:</p>
<pre class="sourceCode r"><code class="sourceCode r">cdata &lt;-<span class="st"> </span><span class="kw">input_csv_data</span>(simp, <span class="dt">dataname =</span> <span class="ot">NULL</span>, <span class="dt">datatype =</span> <span class="st">&quot;Cell&quot;</span>, <span class="dt">colums =</span> <span class="st">&quot;LandUseIndex&quot;</span>,
        <span class="dt">pertick =</span> <span class="ot">TRUE</span>, <span class="dt">starttick =</span> <span class="dv">2010</span>, <span class="dt">endtick =</span> <span class="dv">2040</span>, <span class="dt">tickinterval =</span> <span class="dv">30</span>, <span class="dt">attachfileinfo =</span> <span class="ot">TRUE</span>)

cdata$Region &lt;-<span class="st"> </span><span class="ot">NULL</span>
cdata$Scenario &lt;-<span class="st"> </span><span class="ot">NULL</span>

cdata &lt;-<span class="st"> </span><span class="kw">split</span>(cdata, <span class="kw">list</span>(cdata$Tick,cdata$Runid))

cdata &lt;-<span class="st"> </span><span class="kw">lapply</span>(cdata, function(x) {x$Runid &lt;-<span class="st"> </span><span class="ot">NULL</span>; x})
cdata &lt;-<span class="st"> </span><span class="kw">lapply</span>(cdata, function(x) {x$Tick &lt;-<span class="st"> </span><span class="ot">NULL</span>; x})

csv_LandUseIndex_split &lt;-<span class="st"> </span>cadata
<span class="kw">input_tools_save</span>(simp, <span class="st">&quot;csv_LandUseIndex_split&quot;</span>)
<span class="kw">rm</span>(<span class="kw">list</span>(csv_LandUseIndex_split, cdata)</code></pre>
</div>
<div id="source-aggregated-demand-and-supply-data-aggregatedemandsupplycsvoutputter" class="section level2">
<h2>Source: Aggregated Demand and Supply Data (AggregateDemandSupplyCSVOutputter)</h2>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(craftyr)
simp &lt;-<span class="st"> </span><span class="kw">param_getExamplesSimp</span>()
csv_aggregateServiceDemand &lt;-<span class="st"> </span><span class="kw">input_csv_data</span>(simp, <span class="dt">dataname =</span> <span class="ot">NULL</span>, <span class="dt">datatype =</span> <span class="st">&quot;AggregateServiceDemand&quot;</span>,
        <span class="dt">pertick =</span> <span class="ot">FALSE</span>, <span class="dt">bindrows =</span> <span class="ot">TRUE</span>)
<span class="kw">input_tools_save</span>(simp, <span class="st">&quot;csv_aggregateServiceDemand&quot;</span>)</code></pre>
</div>
<div id="source-marginal-utilities" class="section level2">
<h2>Source: Marginal Utilities</h2>
<p>Note: currently, there is no outputter, but marginal utilities can be extracted from log data using a python script (see Py4ABM, <a href="https://bitbucket.org/S-Holzhauer/py4abm" class="uri">https://bitbucket.org/S-Holzhauer/py4abm</a>). The resulting CSV file should be places in the projects RData folder.</p>
<p>TODO</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(craftyr)
simp &lt;-<span class="st"> </span><span class="kw">param_getExamplesSimp</span>()
csv_MarginalUtilitites_melt &lt;-<span class="st"> </span><span class="kw">input_marginalutilities</span>(simp)
<span class="kw">input_tools_save</span>(simp, <span class="st">&quot;csv_MarginalUtilitites_melt&quot;</span>)</code></pre>
</div>
</div>
<div id="visualise-csv-data" class="section level1">
<h1>Visualise CSV Data</h1>
<div id="map-data" class="section level2">
<h2>Map Data</h2>
<div id="landuseindex-facets" class="section level3">
<h3>LandUseIndex: Facets</h3>
<pre class="sourceCode r"><code class="sourceCode r">simp &lt;-<span class="st"> </span><span class="kw">param_getDefaultSimp</span>()
<span class="kw">input_tools_load</span>(simp, <span class="st">&quot;csv_LandUseIndex_split&quot;</span>)
cdata &lt;-<span class="st"> </span>csv_LandUseIndex_split
cdata$<span class="st">&quot;2010.2&quot;</span>$ID &lt;&lt;-<span class="st"> </span><span class="kw">as.factor</span>(<span class="st">&quot;Homo_2010&quot;</span>)
cdata$<span class="st">&quot;2040.2&quot;</span>$ID &lt;&lt;-<span class="st"> </span><span class="kw">as.factor</span>(<span class="st">&quot;Homo_2040&quot;</span>)

diffcells &lt;&lt;-<span class="st"> </span>cdata$<span class="st">&quot;2010.2&quot;</span>
diffcells$LandUseIndex &lt;&lt;-<span class="st"> </span><span class="ot">NA</span>
diffhomo$LandUseIndex[cdata$<span class="st">&quot;2040.2&quot;</span>$LandUseIndex -<span class="st"> </span>cdata$<span class="st">&quot;2010.2&quot;</span>$LandUseIndex !=<span class="st"> </span><span class="dv">0</span>] &lt;-<span class="st"> </span><span class="dv">3</span>
diffhomo$ID &lt;-<span class="st"> </span><span class="kw">as.factor</span>(<span class="st">&quot;Diff_Homo_2040-2010&quot;</span>)

toplot &lt;-<span class="st"> </span><span class="kw">list</span>(cdata$<span class="st">&quot;2010.2&quot;</span>, cdata$<span class="st">&quot;2040.2&quot;</span>, diffhomo)
<span class="kw">rm</span>(diffhomo)
<span class="kw">rm</span>(cdata)
<span class="kw">visualise_cells_printPlots</span>(simp, toplot, <span class="dt">idcolumn =</span> <span class="st">&quot;ID&quot;</span>,
        <span class="dt">title =</span> <span class="st">&quot;EU-Homo&quot;</span>, <span class="dt">legendtitle =</span> <span class="st">&quot;AFTs&quot;</span>,
        <span class="dt">factorial=</span> <span class="ot">TRUE</span>, <span class="dt">omitaxisticks =</span> <span class="ot">TRUE</span>, <span class="dt">ncol =</span> <span class="dv">3</span>,
        <span class="dt">legenditemnames =</span> simp$mdata$aftNames, <span class="dt">coloursetname=</span><span class="st">&quot;AFT&quot;</span>)</code></pre>
</div>
<div id="landuseindex-raw-plot" class="section level3">
<h3>LandUseIndex: Raw Plot</h3>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(craftyr)
simp &lt;-<span class="st"> </span><span class="kw">param_getExamplesSimp</span>()
<span class="kw">input_tools_load</span>(simp, <span class="st">&quot;csv_LandUseIndex_split&quot;</span>)
<span class="kw">visualise_cells_printRawPlots</span>(simp, csv_LandUseIndex_split,
        <span class="dt">factorial=</span> <span class="ot">TRUE</span>, <span class="dt">ncol =</span> <span class="dv">1</span>, <span class="dt">id=</span><span class="st">&quot;None&quot;</span>)       </code></pre>
<pre><code>## Warning in grid.Call(L_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font family not found in Windows font database</code></pre>
<pre><code>## Warning in grid.Call(L_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font family not found in Windows font database</code></pre>
<pre><code>## Warning in grid.Call(L_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font family not found in Windows font database</code></pre>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAABlBMVEUA5f9MAP/P1Gy4AAAACXBIWXMAAA7DAAAOwwHHb6hkAAACVUlEQVR4nO3QgQ2DMADEQNh/6W6ApSghQO8m+PdxPsyxxvieid+mECgIFAQKAgWBgkBBoCBQECgIFAQKAgWBgkBBoCBQECgIFAQKAgWBgkBBoCBQECgIFAQK/xJo0c81BAoCBYGCQEGgIFAQKAgUBAoCBYGCQEGgIFAQKAgUBAoCBYGCQEGgIFAQKAgUBAoCBYGCQGFRoN23biJQECgIFAQKAgWBgkBBoCBQECgIFAQKAgWBgkBBoCBQECgIFAQKAgWBgkBBoCBQECgIFAQKAgWBgkBBoCBQECgIFAQKAgWBgkBBoCBQECgIFAQKAgWBgkBBoCBQECgIFAQKAgWBgkBBoCBQECgIFAQKAgWBgkBBoCBQECgIFAQKAgWBgkBBoCBQECgIFAQKAgWBgkBBoCBQECgIFAQKAgWBgkBBoCBQECgIFAQKAgWBgkBBoCBQECgIFAQKAgWBgkBBoCBQECgIFAQKAgWBgkBBoCBQECgIFAQKAgWBgkBBoCBQECgIFAQKAgWBgkBBoCBQECgIFAQKAgWBgkBBoCBQECgIFAQKAgWBgkBhPNB36l0eEUigJFAQKAgUBAoCBYGCQEGgIFAQKAgUBAoCBYGCQEGgIFAQKAgUBAoCBYGCQEGgIFAQKOwINGxDg+s9E79NIVAQKAgUBAoCBYGCQEGgIFAQKAgUBAoCBYGCQEGgIFAQKAgUBAoCBYGCQEGgIFAQKAgUBHoZgYJAQaAgUBAoCBQECgIFgYJAQaAgUBAoCBQECgIFgYJAQaAgUBAoCBQECgIFgYJAQaDwAzhFh7meInuAAAAAAElFTkSuQmCC" /></p>
</div>
</div>
<div id="aggregate-data" class="section level2">
<h2>Aggregate Data</h2>
<div id="aft-composition-as-timeline" class="section level3">
<h3>AFT Composition as Timeline</h3>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(craftyr)
simp &lt;-<span class="st"> </span><span class="kw">param_getExamplesSimp</span>()
<span class="kw">input_tools_load</span>(simp, <span class="st">&quot;csv_LandUseIndex&quot;</span>)

<span class="co"># aggregate regions:</span>
csv_LandUseIndex$AftNumbers &lt;-<span class="st"> </span>csv_LandUseIndex$LandUseIndex
aftData &lt;-<span class="st"> </span><span class="kw">aggregate</span>(<span class="kw">subset</span>(csv_LandUseIndex, <span class="dt">select=</span><span class="kw">c</span>(<span class="st">&quot;AftNumbers&quot;</span>)),
        <span class="dt">by =</span> <span class="kw">list</span>(<span class="dt">ID =</span> csv_LandUseIndex[,<span class="st">&quot;Runid&quot;</span>],
                <span class="dt">Tick=</span>csv_LandUseIndex[, <span class="st">&quot;Tick&quot;</span>],  <span class="dt">AFT=</span>csv_LandUseIndex[,<span class="st">&quot;LandUseIndex&quot;</span>]),
        <span class="dt">FUN=</span>sum)
aftData$AFT &lt;-<span class="st"> </span><span class="kw">as.factor</span>(aftData$AFT)
aftData$Proportion &lt;-<span class="st"> </span><span class="kw">ave</span>(aftData$AftNumbers, aftData$ID, aftData$Tick, <span class="dt">FUN =</span>  function(.x) .x/<span class="kw">sum</span>(.x))
aftData$Number &lt;-<span class="st"> </span><span class="ot">NULL</span>

<span class="kw">visualise_lines</span>(simp, aftData, <span class="st">&quot;Proportion&quot;</span>, <span class="dt">title =</span> <span class="st">&quot;Total AFT composition&quot;</span>,
        <span class="dt">colour_column =</span> <span class="st">&quot;AFT&quot;</span>,
        <span class="dt">colour_legenditemnames =</span> simp$mdata$aftNames,
        <span class="dt">linetype_column =</span> <span class="st">&quot;ID&quot;</span>,
        <span class="dt">linetype_legendtitle =</span> simp$sim$rundesclabel,
        <span class="dt">linetype_legenditemnames =</span> simp$sim$rundesc,
        <span class="dt">filename =</span> <span class="kw">paste</span>(<span class="st">&quot;TotalAftComposition&quot;</span>, 
                shbasic::<span class="kw">shbasic_condenseRunids</span>(<span class="kw">data.frame</span>(aftData)[, <span class="st">&quot;ID&quot;</span>]), <span class="dt">sep=</span><span class="st">&quot;_&quot;</span>),
        <span class="dt">alpha=</span><span class="fl">0.7</span>)</code></pre>
<p><img src="data:image/png;base64,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" /></p>
</div>
<div id="aggregated-demand-and-supply-data" class="section level3">
<h3>Aggregated Demand and Supply Data</h3>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(craftyr)
<span class="kw">library</span>(reshape2)</code></pre>
<pre><code>## Warning: package 'reshape2' was built under R version 3.1.3</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">simp &lt;-<span class="st"> </span><span class="kw">param_getExamplesSimp</span>()
<span class="kw">input_tools_load</span>(simp, <span class="st">&quot;csv_aggregateServiceDemand&quot;</span>)

data &lt;-<span class="st"> </span><span class="kw">convert_aggregate_meltsupplydemand</span>(simp, csv_aggregateServiceDemand)

<span class="co"># aggregate regions:</span>
data &lt;-<span class="st"> </span><span class="kw">aggregate</span>(<span class="kw">subset</span>(data, <span class="dt">select=</span><span class="kw">c</span>(<span class="st">&quot;Value&quot;</span>)),
        <span class="dt">by =</span> <span class="kw">list</span>(<span class="dt">ID =</span> data[,<span class="st">&quot;Runid&quot;</span>],
                <span class="dt">Tick=</span>data[, <span class="st">&quot;Tick&quot;</span>],  <span class="dt">Scenario =</span> data[,<span class="st">&quot;Scenario&quot;</span>],
                <span class="dt">Service=</span>data[,<span class="st">&quot;Service&quot;</span>], <span class="dt">Type=</span>data[,<span class="st">&quot;Type&quot;</span>]),
        <span class="dt">FUN=</span>sum)

<span class="kw">visualise_lines</span>(simp, data, <span class="st">&quot;Value&quot;</span>, <span class="dt">title =</span> <span class="st">&quot;Aggregated Service Supply &amp; Demand&quot;</span>,
        <span class="dt">colour_column =</span> <span class="st">&quot;Service&quot;</span>,
        <span class="dt">linetype_column =</span> <span class="st">&quot;Type&quot;</span>,
        <span class="dt">filename =</span> <span class="kw">paste</span>(<span class="st">&quot;AggregateServiceDemand&quot;</span>, 
                shbasic::<span class="kw">shbasic_condenseRunids</span>(<span class="kw">data.frame</span>(data)[, <span class="st">&quot;ID&quot;</span>]), <span class="dt">sep=</span><span class="st">&quot;_&quot;</span>),
        <span class="dt">alpha=</span><span class="fl">0.7</span>)</code></pre>
<p><img src="data:image/png;base64,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" /></p>
<p>High level:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hl_aggregate_demandsupply</span>(simp)</code></pre>
</div>
<div id="marginal-utilities" class="section level3">
<h3>Marginal Utilities</h3>
<p>TODO</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">input_tools_load</span>(simp, <span class="st">&quot;csv_MarginalUtilitites_melt&quot;</span>)
<span class="kw">visualise_lines</span>(simp, data, <span class="st">&quot;value&quot;</span>, <span class="dt">title =</span> <span class="st">&quot;Marginal Utilities&quot;</span>,
        <span class="dt">colour_column =</span> <span class="st">&quot;Service&quot;</span>,
        <span class="dt">filename =</span> <span class="kw">paste</span>(<span class="st">&quot;MarginalUtilities&quot;</span>, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>),
        <span class="dt">alpha=</span><span class="fl">0.7</span>)</code></pre>
<p>High level:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hl_marginalutilities</span>(simp)</code></pre>
</div>
<div id="total-productivity" class="section level3">
<h3>Total Productivity</h3>
</div>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
