<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="author" content="Sascha Holzhauer" />

<meta name="date" content="2016-03-15" />

<title>Using CSV data with craftyr</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; }
code > span.dt { color: #902000; }
code > span.dv { color: #40a070; }
code > span.bn { color: #40a070; }
code > span.fl { color: #40a070; }
code > span.ch { color: #4070a0; }
code > span.st { color: #4070a0; }
code > span.co { color: #60a0b0; font-style: italic; }
code > span.ot { color: #007020; }
code > span.al { color: #ff0000; font-weight: bold; }
code > span.fu { color: #06287e; }
code > span.er { color: #ff0000; font-weight: bold; }
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<link href="data:text/css,body%20%7B%0A%20%20background%2Dcolor%3A%20%23fff%3B%0A%20%20margin%3A%201em%20auto%3B%0A%20%20max%2Dwidth%3A%20700px%3B%0A%20%20overflow%3A%20visible%3B%0A%20%20padding%2Dleft%3A%202em%3B%0A%20%20padding%2Dright%3A%202em%3B%0A%20%20font%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0A%20%20font%2Dsize%3A%2014px%3B%0A%20%20line%2Dheight%3A%201%2E35%3B%0A%7D%0A%0A%23header%20%7B%0A%20%20text%2Dalign%3A%20center%3B%0A%7D%0A%0A%23TOC%20%7B%0A%20%20clear%3A%20both%3B%0A%20%20margin%3A%200%200%2010px%2010px%3B%0A%20%20padding%3A%204px%3B%0A%20%20width%3A%20400px%3B%0A%20%20border%3A%201px%20solid%20%23CCCCCC%3B%0A%20%20border%2Dradius%3A%205px%3B%0A%0A%20%20background%2Dcolor%3A%20%23f6f6f6%3B%0A%20%20font%2Dsize%3A%2013px%3B%0A%20%20line%2Dheight%3A%201%2E3%3B%0A%7D%0A%20%20%23TOC%20%2Etoctitle%20%7B%0A%20%20%20%20font%2Dweight%3A%20bold%3B%0A%20%20%20%20font%2Dsize%3A%2015px%3B%0A%20%20%20%20margin%2Dleft%3A%205px%3B%0A%20%20%7D%0A%0A%20%20%23TOC%20ul%20%7B%0A%20%20%20%20padding%2Dleft%3A%2040px%3B%0A%20%20%20%20margin%2Dleft%3A%20%2D1%2E5em%3B%0A%20%20%20%20margin%2Dtop%3A%205px%3B%0A%20%20%20%20margin%2Dbottom%3A%205px%3B%0A%20%20%7D%0A%20%20%23TOC%20ul%20ul%20%7B%0A%20%20%20%20margin%2Dleft%3A%20%2D2em%3B%0A%20%20%7D%0A%20%20%23TOC%20li%20%7B%0A%20%20%20%20line%2Dheight%3A%2016px%3B%0A%20%20%7D%0A%0Atable%20%7B%0A%20%20margin%3A%201em%20auto%3B%0A%20%20border%2Dwidth%3A%201px%3B%0A%20%20border%2Dcolor%3A%20%23DDDDDD%3B%0A%20%20border%2Dstyle%3A%20outset%3B%0A%20%20border%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0A%20%20border%2Dwidth%3A%202px%3B%0A%20%20padding%3A%205px%3B%0A%20%20border%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0A%20%20border%2Dwidth%3A%201px%3B%0A%20%20border%2Dstyle%3A%20inset%3B%0A%20%20line%2Dheight%3A%2018px%3B%0A%20%20padding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0A%20%20border%2Dleft%2Dstyle%3A%20none%3B%0A%20%20border%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0A%0Ap%20%7B%0A%20%20margin%3A%200%2E5em%200%3B%0A%7D%0A%0Ablockquote%20%7B%0A%20%20background%2Dcolor%3A%20%23f6f6f6%3B%0A%20%20padding%3A%200%2E25em%200%2E75em%3B%0A%7D%0A%0Ahr%20%7B%0A%20%20border%2Dstyle%3A%20solid%3B%0A%20%20border%3A%20none%3B%0A%20%20border%2Dtop%3A%201px%20solid%20%23777%3B%0A%20%20margin%3A%2028px%200%3B%0A%7D%0A%0Adl%20%7B%0A%20%20margin%2Dleft%3A%200%3B%0A%7D%0A%20%20dl%20dd%20%7B%0A%20%20%20%20margin%2Dbottom%3A%2013px%3B%0A%20%20%20%20margin%2Dleft%3A%2013px%3B%0A%20%20%7D%0A%20%20dl%20dt%20%7B%0A%20%20%20%20font%2Dweight%3A%20bold%3B%0A%20%20%7D%0A%0Aul%20%7B%0A%20%20margin%2Dtop%3A%200%3B%0A%7D%0A%20%20ul%20li%20%7B%0A%20%20%20%20list%2Dstyle%3A%20circle%20outside%3B%0A%20%20%7D%0A%20%20ul%20ul%20%7B%0A%20%20%20%20margin%2Dbottom%3A%200%3B%0A%20%20%7D%0A%0Apre%2C%20code%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20color%3A%20%23333%3B%0A%7D%0Apre%20%7B%0A%20%20white%2Dspace%3A%20pre%2Dwrap%3B%20%20%20%20%2F%2A%20Wrap%20long%20lines%20%2A%2F%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20margin%3A%205px%200px%2010px%200px%3B%0A%20%20padding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0A%0Acode%20%7B%0A%20%20font%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0A%20%20font%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0A%20%20padding%3A%202px%200px%3B%0A%7D%0A%0Adiv%2Efigure%20%7B%0A%20%20text%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0A%20%20background%2Dcolor%3A%20%23FFFFFF%3B%0A%20%20padding%3A%202px%3B%0A%20%20border%3A%201px%20solid%20%23DDDDDD%3B%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20border%3A%201px%20solid%20%23CCCCCC%3B%0A%20%20margin%3A%200%205px%3B%0A%7D%0A%0Ah1%20%7B%0A%20%20margin%2Dtop%3A%200%3B%0A%20%20font%2Dsize%3A%2035px%3B%0A%20%20line%2Dheight%3A%2040px%3B%0A%7D%0A%0Ah2%20%7B%0A%20%20border%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0A%20%20padding%2Dtop%3A%2010px%3B%0A%20%20padding%2Dbottom%3A%202px%3B%0A%20%20font%2Dsize%3A%20145%25%3B%0A%7D%0A%0Ah3%20%7B%0A%20%20border%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0A%20%20padding%2Dtop%3A%2010px%3B%0A%20%20font%2Dsize%3A%20120%25%3B%0A%7D%0A%0Ah4%20%7B%0A%20%20border%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0A%20%20margin%2Dleft%3A%208px%3B%0A%20%20font%2Dsize%3A%20105%25%3B%0A%7D%0A%0Ah5%2C%20h6%20%7B%0A%20%20border%2Dbottom%3A%201px%20solid%20%23ccc%3B%0A%20%20font%2Dsize%3A%20105%25%3B%0A%7D%0A%0Aa%20%7B%0A%20%20color%3A%20%230033dd%3B%0A%20%20text%2Ddecoration%3A%20none%3B%0A%7D%0A%20%20a%3Ahover%20%7B%0A%20%20%20%20color%3A%20%236666ff%3B%20%7D%0A%20%20a%3Avisited%20%7B%0A%20%20%20%20color%3A%20%23800080%3B%20%7D%0A%20%20a%3Avisited%3Ahover%20%7B%0A%20%20%20%20color%3A%20%23BB00BB%3B%20%7D%0A%20%20a%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0A%20%20%20%20text%2Ddecoration%3A%20underline%3B%20%7D%0A%20%20a%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0A%20%20%20%20text%2Ddecoration%3A%20underline%3B%20%7D%0A%0A%2F%2A%20Class%20described%20in%20https%3A%2F%2Fbenjeffrey%2Ecom%2Fposts%2Fpandoc%2Dsyntax%2Dhighlighting%2Dcss%0A%20%20%20Colours%20from%20https%3A%2F%2Fgist%2Egithub%2Ecom%2Frobsimmons%2F1172277%20%2A%2F%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20Keyword%20%2A%2F%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%2F%2A%20DataType%20%2A%2F%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%2F%2A%20DecVal%20%28decimal%20values%29%20%2A%2F%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20BaseN%20%2A%2F%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20Float%20%2A%2F%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20Char%20%2A%2F%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20String%20%2A%2F%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%2F%2A%20Comment%20%2A%2F%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%2F%2A%20OtherToken%20%2A%2F%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20AlertToken%20%2A%2F%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20Function%20calls%20%2A%2F%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%2F%2A%20ErrorTok%20%2A%2F%0A%0A" rel="stylesheet" type="text/css" />

</head>

<body>



<div id="header">
<h1 class="title">Using CSV data with craftyr</h1>
<h4 class="author"><em>Sascha Holzhauer</em></h4>
<h4 class="date"><em>2016-03-15</em></h4>
</div>

<div id="TOC">
<ul>
<li><a href="#input-read-csv-data">Input (read) CSV Data</a><ul>
<li><a href="#overall-features">(Overall) Features</a></li>
<li><a href="#source-regional-csv-data-celltable---land-use-data-per-cell">Source: Regional CSV data (CellTable) - Land use data per cell</a></li>
<li><a href="#source-regional-csv-data-celltable---aggregated-data">Source: Regional CSV data (CellTable) - Aggregated data</a></li>
<li><a href="#source-cell-table-pre-allocation-competitiveness">Source: Cell Table (Pre-Allocation Competitiveness)</a></li>
<li><a href="#source-aggregated-aft-composition">Source: Aggregated AFT Composition</a></li>
<li><a href="#source-aggregated-demand-and-supply-data-aggregatedemandsupplycsvoutputter">Source: Aggregated Demand and Supply Data (AggregateDemandSupplyCSVOutputter)</a></li>
<li><a href="#source-takeover-from-giving-in-data-takeovercelloutputter">Source: TakeOver from Giving In Data (TakeoverCellOutputter)</a></li>
<li><a href="#source-givingin-statistics-givinginstatisticsoutputter">Source: GivingIn Statistics (GivingInStatisticsOutputter)</a></li>
<li><a href="#source-marginal-utilities">Source: Marginal Utilities</a></li>
</ul></li>
<li><a href="#visualise-csv-data">Visualise CSV Data</a><ul>
<li><a href="#map-data">Map Data</a><ul>
<li><a href="#landuseindex-facets">LandUseIndex: Facets</a></li>
<li><a href="#landuseindex-raw-plot">LandUseIndex: Raw Plot</a></li>
</ul></li>
<li><a href="#aggregate-data">Aggregate Data</a><ul>
<li><a href="#from-cell-level-data">From Cell Level Data</a><ul>
<li><a href="#aft-composition-as-timeline">AFT Composition as Timeline</a></li>
<li><a href="#competitiveness-mean-by-region">Competitiveness (Mean by region)</a></li>
<li><a href="#spatial-autocorrelation">Spatial Autocorrelation</a></li>
<li><a href="#cell-connectedness">Cell Connectedness</a></li>
<li><a href="#cell-volatility">Cell Volatility</a></li>
<li><a href="#further-cell-data-as-timeline">Further Cell Data as Timeline</a></li>
</ul></li>
<li><a href="#from-aggregated-region-level-data">From Aggregated (Region Level) Data</a><ul>
<li><a href="#aft-composition-as-timeline-1">AFT Composition as Timeline</a></li>
<li><a href="#aggregated-demand-and-supply-data">Aggregated Demand and Supply Data</a></li>
<li><a href="#take-overs-giving-in">Take Overs (Giving in)</a></li>
<li><a href="#take-overs-all">Take Overs (All)</a></li>
<li><a href="#givinginstatistics-frequencies-per-aft---regions-aggregated">GivingInStatistics (Frequencies per AFT - Regions aggregated)</a></li>
<li><a href="#pre-allocation-competitiveness">Pre-Allocation Competitiveness</a></li>
<li><a href="#cell-volatility-1">Cell Volatility</a></li>
<li><a href="#marginal-utilities">Marginal Utilities</a></li>
<li><a href="#demand-normalised-per-cell-marginal-utilities">Demand-normalised per-cell marginal Utilities</a></li>
<li><a href="#total-productivity">Total Productivity</a></li>
</ul></li>
<li><a href="#from-single-files">From Single Files</a><ul>
<li><a href="#aft-composition">AFT Composition</a></li>
<li><a href="#aft-composition-1">AFT Composition</a></li>
<li><a href="#demand-and-supply">Demand and Supply</a></li>
</ul></li>
</ul></li>
</ul></li>
<li><a href="#output-write-csv-data">Output (write) CSV Data</a><ul>
<li><a href="#generate-landuseindex-key">Generate LandUseIndex key</a></li>
<li><a href="#aggregate-demand-and-supply">Aggregate demand and supply</a></li>
<li><a href="#supplydemand-gap-regarding-agent-parameters-gu-probability">Supply/Demand gap regarding agent parameters (GU probability)</a></li>
</ul></li>
<li><a href="#conversions">Conversions</a><ul>
<li><a href="#stored-csvdata.frame-rdata-to-raster-file-ascii">Stored CSV/data.frame (rData) to raster file (ASCII)</a></li>
</ul></li>
</ul>
</div>

<div id="input-read-csv-data" class="section level1">
<h1>Input (read) CSV Data</h1>
<div id="overall-features" class="section level2">
<h2>(Overall) Features</h2>
<ul>
<li>Limit considered ticks by starttick, endtick, and interval</li>
<li>Read CSV files of multiple regions at once</li>
</ul>
</div>
<div id="source-regional-csv-data-celltable---land-use-data-per-cell" class="section level2">
<h2>Source: Regional CSV data (CellTable) - Land use data per cell</h2>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(craftyr)
simp &lt;-<span class="st"> </span><span class="kw">param_getExamplesSimp</span>()

futile.logger::<span class="kw">flog.threshold</span>(futile.logger::DEBUG, <span class="dt">name=</span><span class="st">'craftyr.input.csv'</span>)

cdata &lt;-<span class="st"> </span><span class="kw">input_csv_data</span>(simp, <span class="dt">dataname =</span> <span class="ot">NULL</span>, <span class="dt">datatype =</span> <span class="st">&quot;Cell&quot;</span>, <span class="dt">columns =</span> <span class="st">&quot;LandUseIndex&quot;</span>,
        <span class="dt">pertick =</span> <span class="ot">TRUE</span>, <span class="dt">starttick =</span> <span class="dv">2000</span>, <span class="dt">endtick =</span> <span class="dv">2020</span>, <span class="dt">tickinterval =</span> <span class="dv">10</span>,
        <span class="dt">attachfileinfo =</span> <span class="ot">TRUE</span>, <span class="dt">bindrows =</span> <span class="ot">TRUE</span>)
csv_LandUseIndex_rbinded &lt;-<span class="st"> </span>cdata
<span class="kw">input_tools_save</span>(simp, <span class="st">&quot;csv_LandUseIndex_rbinded&quot;</span>)
cdata &lt;-<span class="st"> </span><span class="kw">split</span>(cdata, <span class="kw">list</span>(cdata$Tick, cdata$Runid))
csv_LandUseIndex_split &lt;-<span class="st"> </span>cdata
<span class="kw">input_tools_save</span>(simp, <span class="st">&quot;csv_LandUseIndex_split&quot;</span>)</code></pre>
<p>High level:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hl_store_csvcelldata</span>(simp, <span class="dt">dataname =</span> <span class="st">&quot;csv_LandUseIndex_rbinded&quot;</span>, <span class="dt">tickinterval =</span> <span class="dv">10</span>)</code></pre>
<p>For large data sets it is a good idea to clean the data somewhat before storing:</p>
<pre class="sourceCode r"><code class="sourceCode r">cdata &lt;-<span class="st"> </span><span class="kw">input_csv_data</span>(simp, <span class="dt">dataname =</span> <span class="ot">NULL</span>, <span class="dt">datatype =</span> <span class="st">&quot;Cell&quot;</span>, <span class="dt">colums =</span> <span class="st">&quot;LandUseIndex&quot;</span>,
        <span class="dt">pertick =</span> <span class="ot">TRUE</span>, <span class="dt">starttick =</span> <span class="dv">2010</span>, <span class="dt">endtick =</span> <span class="dv">2040</span>, <span class="dt">tickinterval =</span> <span class="dv">30</span>, <span class="dt">attachfileinfo =</span> <span class="ot">TRUE</span>)

cdata$Region &lt;-<span class="st"> </span><span class="ot">NULL</span>
cdata$Scenario &lt;-<span class="st"> </span><span class="ot">NULL</span>

cdata &lt;-<span class="st"> </span><span class="kw">split</span>(cdata, <span class="kw">list</span>(cdata$Tick,cdata$Runid))

cdata &lt;-<span class="st"> </span><span class="kw">lapply</span>(cdata, function(x) {x$Runid &lt;-<span class="st"> </span><span class="ot">NULL</span>; x})
cdata &lt;-<span class="st"> </span><span class="kw">lapply</span>(cdata, function(x) {x$Tick &lt;-<span class="st"> </span><span class="ot">NULL</span>; x})

csv_LandUseIndex_split &lt;-<span class="st"> </span>cadata
<span class="kw">input_tools_save</span>(simp, <span class="st">&quot;csv_LandUseIndex_split&quot;</span>)
<span class="kw">rm</span>(<span class="kw">list</span>(csv_LandUseIndex_split, cdata)</code></pre>
</div>
<div id="source-regional-csv-data-celltable---aggregated-data" class="section level2">
<h2>Source: Regional CSV data (CellTable) - Aggregated data</h2>
<p>Note that the fields in cell table depend on the output configuration as well as service names. Thus, the aggregation function needs to be adapted.</p>
<pre class="sourceCode r"><code class="sourceCode r">aggregationFunction &lt;-<span class="st"> </span>function(simp, data) {
    <span class="kw">library</span>(plyr) <span class="co"># because '.' function cannot be addressed</span>
    plyr::<span class="kw">ddply</span>(data, .(Runid, Region, Tick, LandUseIndex), <span class="dt">.fun=</span>function(df) {
                df$Counter &lt;-<span class="st"> </span><span class="dv">1</span>
                <span class="kw">with</span>(df, <span class="kw">data.frame</span>(
                                <span class="dt">Runid               =</span> <span class="kw">unique</span>(Runid),
                                <span class="dt">Region              =</span> <span class="kw">unique</span>(Region),
                                <span class="dt">Tick                =</span> <span class="kw">mean</span>(Tick),
                                <span class="dt">LandUseIndex        =</span> <span class="kw">mean</span>(LandUseIndex),
                                <span class="dt">AFT                 =</span> <span class="kw">sum</span>(Counter),
                                <span class="dt">Service.Service1    =</span> <span class="kw">sum</span>(Service.Service1), 
                                <span class="dt">Service.Service2    =</span> <span class="kw">sum</span>(Service.Service2),
                                <span class="dt">Service.Service3    =</span> <span class="kw">sum</span>(Service.Service3),
                                <span class="dt">Capital.Cap1        =</span> <span class="kw">sum</span>(Capital.Cap1)) )
            })
}

csv_cell_aggregated &lt;-<span class="st"> </span><span class="kw">input_csv_data</span>(simp, <span class="dt">dataname =</span> <span class="ot">NULL</span>, <span class="dt">datatype =</span> <span class="st">&quot;Cell&quot;</span>, <span class="dt">columns =</span> <span class="kw">c</span>(<span class="st">&quot;Service.Service1&quot;</span>, <span class="st">&quot;Service.Service2&quot;</span>,
                <span class="st">&quot;Service.Service3&quot;</span>, <span class="st">&quot;Capital.Cap1&quot;</span>, <span class="st">&quot;LandUseIndex&quot;</span>, <span class="st">&quot;AFT&quot;</span>), <span class="dt">pertick =</span> <span class="ot">TRUE</span>,
        <span class="dt">starttick =</span> <span class="dv">2000</span>, <span class="dt">endtick =</span> <span class="dv">2020</span>, <span class="dt">tickinterval =</span> <span class="dv">10</span>,
        <span class="dt">attachfileinfo =</span> <span class="ot">TRUE</span>, <span class="dt">bindrows =</span> <span class="ot">TRUE</span>,
        <span class="dt">aggregationFunction =</span> aggregationFunction,
        <span class="dt">skipXY =</span> <span class="ot">TRUE</span>)
<span class="kw">rownames</span>(csv_cell_aggregated) &lt;-<span class="st"> </span><span class="ot">NULL</span>
<span class="kw">input_tools_save</span>(simp, <span class="st">&quot;csv_cell_aggregated&quot;</span>)</code></pre>
</div>
<div id="source-cell-table-pre-allocation-competitiveness" class="section level2">
<h2>Source: Cell Table (Pre-Allocation Competitiveness)</h2>
<p>Read CSV data of pre-allocation competitiveness and transfer to data.frame of frequencies</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(craftyr)
simp &lt;-<span class="st"> </span><span class="kw">param_getExamplesSimp</span>()
simp$sim$filepartorder  &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;regions&quot;</span>, <span class="st">&quot;D&quot;</span>, <span class="st">&quot;datatype&quot;</span>)
csv_preAllocTable &lt;-<span class="st"> </span><span class="kw">input_csv_prealloccomp</span>(simp)
<span class="kw">input_tools_save</span>(simp, <span class="st">&quot;csv_preAllocTable&quot;</span>)</code></pre>
</div>
<div id="source-aggregated-aft-composition" class="section level2">
<h2>Source: Aggregated AFT Composition</h2>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(craftyr)
simp &lt;-<span class="st"> </span><span class="kw">param_getExamplesSimp</span>()
dataAggregateAFTComposition &lt;-<span class="st"> </span><span class="kw">input_csv_data</span>(simp, <span class="dt">dataname =</span> <span class="ot">NULL</span>, <span class="dt">datatype =</span> <span class="st">&quot;AggregateAFTComposition&quot;</span>,
        <span class="dt">pertick =</span> <span class="ot">FALSE</span>,
        <span class="dt">bindrows =</span> <span class="ot">TRUE</span>,
        <span class="dt">skipXY =</span> <span class="ot">TRUE</span>)
<span class="kw">input_tools_save</span>(simp, <span class="st">&quot;dataAggregateAFTComposition&quot;</span>)</code></pre>
</div>
<div id="source-aggregated-demand-and-supply-data-aggregatedemandsupplycsvoutputter" class="section level2">
<h2>Source: Aggregated Demand and Supply Data (AggregateDemandSupplyCSVOutputter)</h2>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(craftyr)
simp &lt;-<span class="st"> </span><span class="kw">param_getExamplesSimp</span>()
csv_aggregateServiceDemand &lt;-<span class="st"> </span><span class="kw">input_csv_data</span>(simp, <span class="dt">dataname =</span> <span class="ot">NULL</span>, <span class="dt">datatype =</span> <span class="st">&quot;AggregateServiceDemand&quot;</span>,
        <span class="dt">pertick =</span> <span class="ot">FALSE</span>, <span class="dt">bindrows =</span> <span class="ot">TRUE</span>)
<span class="kw">input_tools_save</span>(simp, <span class="st">&quot;csv_aggregateServiceDemand&quot;</span>)</code></pre>
</div>
<div id="source-takeover-from-giving-in-data-takeovercelloutputter" class="section level2">
<h2>Source: TakeOver from Giving In Data (TakeoverCellOutputter)</h2>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(craftyr)
simp &lt;-<span class="st"> </span><span class="kw">param_getExamplesSimp</span>()
csv_aggregateTakeOvers &lt;-<span class="st"> </span><span class="kw">input_csv_data</span>(simp, <span class="dt">dataname =</span> <span class="ot">NULL</span>, <span class="dt">datatype =</span> <span class="st">&quot;TakeOvers&quot;</span>, <span class="dt">pertick =</span> <span class="ot">FALSE</span>,
        <span class="dt">bindrows =</span> <span class="ot">TRUE</span>,
        <span class="dt">skipXY =</span> <span class="ot">TRUE</span>)
<span class="kw">input_tools_save</span>(simp, <span class="st">&quot;csv_aggregateTakeOvers&quot;</span>)</code></pre>
</div>
<div id="source-givingin-statistics-givinginstatisticsoutputter" class="section level2">
<h2>Source: GivingIn Statistics (GivingInStatisticsOutputter)</h2>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(craftyr)
simp &lt;-<span class="st"> </span><span class="kw">param_getExamplesSimp</span>()
csv_aggregateGiStatistics &lt;-<span class="st"> </span><span class="kw">input_csv_data</span>(simp, <span class="dt">dataname =</span> <span class="ot">NULL</span>, <span class="dt">datatype =</span> <span class="st">&quot;GivingInStatistics&quot;</span>,
        <span class="dt">pertick =</span> <span class="ot">FALSE</span>,
        <span class="dt">bindrows =</span> <span class="ot">TRUE</span>,
        <span class="dt">skipXY =</span> <span class="ot">TRUE</span>)
<span class="kw">input_tools_save</span>(simp, <span class="st">&quot;csv_aggregateGiStatistics&quot;</span>)</code></pre>
</div>
<div id="source-marginal-utilities" class="section level2">
<h2>Source: Marginal Utilities</h2>
<p>Note: currently, there is no outputter, but marginal utilities can be extracted from log data using a python script (see Py4ABM, <a href="https://bitbucket.org/S-Holzhauer/py4abm" class="uri">https://bitbucket.org/S-Holzhauer/py4abm</a>). The resulting CSV file should be places in the projects RData folder.</p>
<p>TODO</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(craftyr)
simp &lt;-<span class="st"> </span><span class="kw">param_getExamplesSimp</span>()
csv_MarginalUtilitites_melt &lt;-<span class="st"> </span><span class="kw">input_marginalutilities</span>(simp)
<span class="kw">input_tools_save</span>(simp, <span class="st">&quot;csv_MarginalUtilitites_melt&quot;</span>)</code></pre>
</div>
</div>
<div id="visualise-csv-data" class="section level1">
<h1>Visualise CSV Data</h1>
<div id="map-data" class="section level2">
<h2>Map Data</h2>
<div id="landuseindex-facets" class="section level3">
<h3>LandUseIndex: Facets</h3>
<pre class="sourceCode r"><code class="sourceCode r">simp &lt;-<span class="st"> </span><span class="kw">param_getDefaultSimp</span>()
<span class="kw">input_tools_load</span>(simp, <span class="st">&quot;csv_LandUseIndex_split&quot;</span>)
cdata &lt;-<span class="st"> </span>csv_LandUseIndex_split
cdata$<span class="st">&quot;2010.2&quot;</span>$ID &lt;&lt;-<span class="st"> </span><span class="kw">as.factor</span>(<span class="st">&quot;Homo_2010&quot;</span>)
cdata$<span class="st">&quot;2040.2&quot;</span>$ID &lt;&lt;-<span class="st"> </span><span class="kw">as.factor</span>(<span class="st">&quot;Homo_2040&quot;</span>)

diffcells &lt;&lt;-<span class="st"> </span>cdata$<span class="st">&quot;2010.2&quot;</span>
diffcells$LandUseIndex &lt;&lt;-<span class="st"> </span><span class="ot">NA</span>
diffhomo$LandUseIndex[cdata$<span class="st">&quot;2040.2&quot;</span>$LandUseIndex -<span class="st"> </span>cdata$<span class="st">&quot;2010.2&quot;</span>$LandUseIndex !=<span class="st"> </span><span class="dv">0</span>] &lt;-<span class="st"> </span><span class="dv">3</span>
diffhomo$ID &lt;-<span class="st"> </span><span class="kw">as.factor</span>(<span class="st">&quot;Diff_Homo_2040-2010&quot;</span>)

toplot &lt;-<span class="st"> </span><span class="kw">list</span>(cdata$<span class="st">&quot;2010.2&quot;</span>, cdata$<span class="st">&quot;2040.2&quot;</span>, diffhomo)
<span class="kw">rm</span>(diffhomo)
<span class="kw">rm</span>(cdata)
<span class="kw">visualise_cells_printPlots</span>(simp, toplot, <span class="dt">idcolumn =</span> <span class="st">&quot;ID&quot;</span>,
        <span class="dt">title =</span> <span class="st">&quot;EU-Homo&quot;</span>, <span class="dt">legendtitle =</span> <span class="st">&quot;AFTs&quot;</span>,
        <span class="dt">factorial=</span> <span class="ot">TRUE</span>, <span class="dt">omitaxisticks =</span> <span class="ot">TRUE</span>, <span class="dt">ncol =</span> <span class="dv">3</span>,
        <span class="dt">legenditemnames =</span> simp$mdata$aftNames, <span class="dt">coloursetname=</span><span class="st">&quot;AFT&quot;</span>)</code></pre>
</div>
<div id="landuseindex-raw-plot" class="section level3">
<h3>LandUseIndex: Raw Plot</h3>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(craftyr)
simp &lt;-<span class="st"> </span><span class="kw">param_getExamplesSimp</span>()
<span class="kw">input_tools_load</span>(simp, <span class="st">&quot;csv_LandUseIndex_split&quot;</span>)
<span class="kw">visualise_cells_printRawPlots</span>(simp, csv_LandUseIndex_split,
        <span class="dt">factorial=</span> <span class="ot">TRUE</span>, <span class="dt">ncol =</span> <span class="dv">1</span>, <span class="dt">id=</span><span class="st">&quot;None&quot;</span>)       </code></pre>
<pre><code>## Warning in grid.Call(L_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font family not found in Windows font database</code></pre>
<pre><code>## Warning in grid.Call(L_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font family not found in Windows font database</code></pre>
<pre><code>## Warning in grid.Call(L_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font family not found in Windows font database</code></pre>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAABlBMVEUA/03//wArwTc8AAAACXBIWXMAAA7DAAAOwwHHb6hkAAACXElEQVR4nO3Q0UkgUBTFQO2/6f2/DzagyBGc6SD5+PgZn7/MD2V+3XrItf7xWA+51j8e6yHX+sdjPeRa/3ish1zrH4/1kGv947Eecq1/PNZDrvWPx3rItf7xWA+51j8e6yHX+sdjPeRa/3ish1zrH4/1kGv947Eecq1/PNZDrvWPx3rItf7xWA+51j8e6yHX+sdjPeRa/3ish1zrH4/1kGv947Eecq1/PNZDrvWPx3rItf7xWA+51j8e6yHX+sdjPeTy4DsMCgYFg4JBwaBgUDAoGBQMCgYFg4JBwaBgUDAoGBQMCgYFg4JBwaBgUDAoGBQMCgYFg4JBwaBgUDAoGBQMCgYFg4JBwaBgUDAoGBQMCgYFg4JBwaBgUDAoGBQMCgYFg4JBwaBgUDAoGBQMCh58g0HBoGBQMCgYFAwKBgWDgkHBoGBQMCgYFAwKBgWDgkHBoGBQMCgYFAwKBgWDgkHBoGBQMCgYFAwKBgWDgkHBoGBQMCgYFAwKBgWDgkHBoGBQMCgYFAwKBgWDgkHBoGBQMCgYFAwKBgWDwv8H/ZF735hgkEGfBiWDgkHBoGBQMCgYFAwKBgWDgkHBoGBQMCgYFAwKBgWDgkHBoGBQMCgYFAwKBgWDgkHBoGBQMCgYFAwKBgWDgkHBoGBQMCgYFAwKBgWDgkHBoGBQMCgYFAwKBgWDgkHBoGBQMCgYFH5o0Nf9kcyvMygYFAwKBgWDgkHBoGBQMCgYFAwKBgWDgkHBoGBQMCgYFAwKBgWDgkHBoGBQMCgYFAwKBgEAAAAAAAAAAAAAAAAAAAC/wj+K4a9CxSYSCgAAAABJRU5ErkJggg==" /></p>
</div>
</div>
<div id="aggregate-data" class="section level2">
<h2>Aggregate Data</h2>
<div id="from-cell-level-data" class="section level3">
<h3>From Cell Level Data</h3>
<div id="aft-composition-as-timeline" class="section level4">
<h4>AFT Composition as Timeline</h4>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(craftyr)
simp &lt;-<span class="st"> </span><span class="kw">param_getExamplesSimp</span>()
<span class="kw">input_tools_load</span>(simp, <span class="st">&quot;csv_LandUseIndex_rbinded&quot;</span>)

 <span class="co"># aggregate regions:</span>
csv_LandUseIndex_rbinded$AftNumbers &lt;-<span class="st"> </span>csv_LandUseIndex_rbinded$LandUseIndex
aftData &lt;-<span class="st"> </span><span class="kw">aggregate</span>(<span class="kw">subset</span>(csv_LandUseIndex_rbinded, <span class="dt">select=</span><span class="kw">c</span>(<span class="st">&quot;AftNumbers&quot;</span>)),
        <span class="dt">by =</span> <span class="kw">list</span>(<span class="dt">ID =</span> csv_LandUseIndex_rbinded[,<span class="st">&quot;Runid&quot;</span>],
                <span class="dt">Tick=</span>csv_LandUseIndex_rbinded[, <span class="st">&quot;Tick&quot;</span>],  <span class="dt">AFT=</span>csv_LandUseIndex_rbinded[,<span class="st">&quot;LandUseIndex&quot;</span>]),
        <span class="dt">FUN=</span>sum)
aftData$AFT &lt;-<span class="st"> </span><span class="kw">as.factor</span>(aftData$AFT)
aftData$Proportion &lt;-<span class="st"> </span><span class="kw">ave</span>(aftData$AftNumbers, aftData$ID, aftData$Tick, <span class="dt">FUN =</span>  function(.x) .x/<span class="kw">sum</span>(.x))
aftData$Number &lt;-<span class="st"> </span><span class="ot">NULL</span>

<span class="kw">visualise_lines</span>(simp, aftData, <span class="st">&quot;Proportion&quot;</span>, <span class="dt">title =</span> <span class="st">&quot;Total AFT composition&quot;</span>,
        <span class="dt">colour_column =</span> <span class="st">&quot;AFT&quot;</span>,
        <span class="dt">colour_legenditemnames =</span> simp$mdata$aftNames,
        <span class="dt">linetype_column =</span> <span class="st">&quot;ID&quot;</span>,
        <span class="dt">linetype_legendtitle =</span> simp$sim$rundesclabel,
        <span class="dt">linetype_legenditemnames =</span> simp$sim$rundesc,
        <span class="dt">filename =</span> <span class="kw">paste</span>(<span class="st">&quot;TotalAftComposition&quot;</span>, 
                shbasic::<span class="kw">shbasic_condenseRunids</span>(<span class="kw">data.frame</span>(aftData)[, <span class="st">&quot;ID&quot;</span>]), <span class="dt">sep=</span><span class="st">&quot;_&quot;</span>),
        <span class="dt">alpha=</span><span class="fl">0.7</span>)</code></pre>
<p><img src="data:image/png;base64,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" /></p>
<p>High level:</p>
<pre class="sourceCode r"><code class="sourceCode r">simp1 &lt;-<span class="st"> </span>simp
simp1$sim$shortid &lt;-<span class="st"> &quot;G9/C4&quot;</span>
simp2 &lt;-<span class="st"> </span>simp
simp2$sim$shortid &lt;-<span class="st"> &quot;G10/C5&quot;</span>
<span class="kw">hl_comp_cell_aftcomposition</span>(simp, <span class="dt">simps =</span> <span class="kw">list</span>(simp1, simp2), <span class="dt">dataname =</span> <span class="st">&quot;csv_cell_aggregated&quot;</span>)</code></pre>
</div>
<div id="competitiveness-mean-by-region" class="section level4">
<h4>Competitiveness (Mean by region)</h4>
<p>% TODO</p>
<p>High level:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hl_competitivenessPerRegion</span>(simp1, <span class="dt">dataname =</span> <span class="st">&quot;dataAgg&quot;</span>)</code></pre>
</div>
<div id="spatial-autocorrelation" class="section level4">
<h4>Spatial Autocorrelation</h4>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(craftyr)
simp &lt;-<span class="st"> </span><span class="kw">param_getExamplesSimp</span>()
<span class="kw">input_tools_load</span>(simp, <span class="dt">objectName =</span> <span class="st">&quot;csv_LandUseIndex_rbinded&quot;</span>)
data &lt;-<span class="st"> </span><span class="kw">get</span>(<span class="st">&quot;csv_LandUseIndex_rbinded&quot;</span>)

scoresdata &lt;-<span class="st"> </span><span class="kw">do.call</span>(rbind, <span class="kw">lapply</span>(<span class="kw">seq</span>(<span class="dt">from=</span><span class="dv">2010</span>, <span class="dt">to=</span><span class="dv">2040</span>, <span class="dt">by=</span><span class="dv">10</span>), function(tick, datac, regions, type) {
                    <span class="kw">do.call</span>(rbind,<span class="kw">lapply</span>(regions, function(tick, region, data, type) {
            tickdata &lt;-<span class="st"> </span>data[data$Tick ==<span class="st"> </span>tick &amp;<span class="st"> </span>data$Region %in%<span class="st"> </span>region, 
                    <span class="kw">c</span>(simp$csv$cname_x, simp$csv$cname_y, <span class="st">&quot;LandUseIndex&quot;</span>)]
            raster &lt;-<span class="st"> </span>craftyr::<span class="kw">convert_2raster</span>(simp, tickdata, <span class="dt">targetCRS =</span> <span class="st">&quot;+init=EPSG:32632&quot;</span>, <span class="dt">layers=</span><span class="kw">c</span>(<span class="dv">1</span>))
            <span class="kw">data.frame</span>(<span class="dt">Value =</span> <span class="kw">analyse_statistics_sa_local</span>(raster[[<span class="dv">1</span>]], <span class="dt">type =</span> type),
                    <span class="dt">Tick =</span> tick, <span class="dt">type =</span> type
                    <span class="dt">Region =</span> region)}, <span class="dt">tick =</span> tick, <span class="dt">data =</span> data, <span class="dt">type =</span> type))
        }, <span class="dt">data =</span> data, <span class="dt">type =</span> <span class="st">&quot;Moran&quot;</span>, <span class="dt">regions =</span> simp$sim$regions))

<span class="kw">visualise_lines</span>(simp, scoresdata, <span class="st">&quot;Value&quot;</span>, <span class="dt">title =</span> <span class="kw">paste</span>(<span class="st">&quot;Spatial Autocorrelation (Moran)&quot;</span>, simp$sim$rundesc[simp$sim$runid]),
        <span class="dt">linetype_column =</span> <span class="st">&quot;Region&quot;</span>,
        <span class="dt">filename =</span> <span class="kw">paste</span>(<span class="st">&quot;Spatial Autocorrelation (Moran)&quot;</span>, <span class="st">&quot;_&quot;</span>, simp$sim$rundesc[simp$sim$runid], <span class="dt">sep=</span><span class="st">&quot;&quot;</span>))</code></pre>
<p>High level:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hl_aggregate_sa</span>(simp, <span class="dt">celldataname =</span> <span class="st">&quot;csv_LandUseIndex_rbinded&quot;</span>, 
    <span class="dt">starttick =</span> simp$sim$starttick, <span class="dt">tickinterval=</span><span class="dv">10</span>, <span class="dt">endtick =</span> simp$sim$endtick,
    <span class="dt">linetypecol =</span> <span class="st">&quot;Region&quot;</span>, <span class="dt">type =</span> <span class="st">&quot;Moran&quot;</span>, <span class="dt">regions =</span> simp$sim$regions,
    <span class="dt">titleprefix =</span> <span class="kw">paste</span>(<span class="st">&quot;SpatialAutocorrelation (&quot;</span>, type, <span class="st">&quot;)&quot;</span>, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>), 
    <span class="dt">filenameprefix =</span> <span class="kw">paste</span>(<span class="st">&quot;SpatialAutocorrelation&quot;</span>, type, <span class="dt">sep=</span><span class="st">&quot;_&quot;</span>))</code></pre>
</div>
<div id="cell-connectedness" class="section level4">
<h4>Cell Connectedness</h4>
<p>Visualise stored metric LandUseConnectivity as timelines</p>
<p>High level:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hl_connectedness</span>(simp, <span class="dt">dataname =</span> <span class="st">&quot;csv_aggregated_connectivity&quot;</span>, 
        <span class="dt">datatype =</span> <span class="st">&quot;LandUseConnectivity&quot;</span>, <span class="dt">aftcolumns =</span> simp$mdata$aftNames[-<span class="dv">1</span>],
        <span class="dt">percent =</span> <span class="ot">NULL</span>)</code></pre>
</div>
<div id="cell-volatility" class="section level4">
<h4>Cell Volatility</h4>
<p>High level:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hl_volatility</span>(simp, <span class="dt">dataname =</span> <span class="st">&quot;csv_aggregated_cellvolatility&quot;</span>, 
        <span class="dt">datatype =</span> <span class="st">&quot;AggregateCellVolatility&quot;</span>, <span class="dt">datacolumns =</span> <span class="kw">c</span>(<span class="st">&quot;CellVolatility&quot;</span>, <span class="st">&quot;NumVolatileCells&quot;</span>),
        <span class="dt">percent =</span> <span class="ot">NULL</span>)</code></pre>
</div>
<div id="further-cell-data-as-timeline" class="section level4">
<h4>Further Cell Data as Timeline</h4>
<p>High level:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hl_lines_from_csv</span>(simp, <span class="dt">dataname =</span> <span class="st">&quot;dataobjectname&quot;</span>, 
        <span class="dt">datatype =</span> <span class="st">&quot;Datatype&quot;</span>, <span class="dt">datacolumns =</span> <span class="kw">c</span>(<span class="st">&quot;ColumnA&quot;</span>,<span class="st">&quot;ColumnB&quot;</span>), <span class="dt">linetypecol =</span> <span class="st">&quot;Region&quot;</span>,
        <span class="dt">colourcol =</span> <span class="st">&quot;Type&quot;</span>, <span class="dt">titleprefix =</span> <span class="st">&quot;Title&quot;</span>, <span class="dt">filenameprefix =</span> <span class="st">&quot;FilenamePrefix&quot;</span>, 
        <span class="dt">percent =</span> <span class="ot">NULL</span>)</code></pre>
</div>
</div>
<div id="from-aggregated-region-level-data" class="section level3">
<h3>From Aggregated (Region Level) Data</h3>
<div id="aft-composition-as-timeline-1" class="section level4">
<h4>AFT Composition as Timeline</h4>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(craftyr)
simp &lt;-<span class="st"> </span><span class="kw">param_getDefaultSimp</span>()
<span class="kw">input_tools_load</span>(simp, <span class="st">&quot;dataAggregateAFTComposition&quot;</span>)
dataComp &lt;-<span class="st"> </span>dataAggregateAFTComposition
dataComp[,<span class="kw">grep</span>(<span class="st">&quot;AFT.&quot;</span>, <span class="kw">colnames</span>(dataComp))] &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">do.call</span>(cbind, 
    <span class="kw">lapply</span>(dataComp[,<span class="kw">grep</span>(<span class="st">&quot;AFT.&quot;</span>, <span class="kw">colnames</span>(dataComp))], as.character)))
dataComp &lt;-<span class="st"> </span>dataComp[<span class="kw">complete.cases</span>(dataComp),]
<span class="kw">colnames</span>(dataComp) &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&quot;AFT.&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="kw">colnames</span>(dataComp))
    
data &lt;-reshape2::<span class="kw">melt</span>(dataAggregateAFTComposition, <span class="dt">variable.name=</span><span class="st">&quot;Agent&quot;</span>, <span class="dt">id.vars=</span> <span class="kw">c</span>(<span class="st">&quot;Region&quot;</span>, <span class="st">&quot;Tick&quot;</span>, <span class="st">&quot;Runid&quot;</span>, <span class="st">&quot;Scenario&quot;</span>), <span class="dt">direction=</span><span class="st">&quot;long&quot;</span>)
d &lt;-<span class="st"> </span><span class="kw">aggregate</span>(<span class="kw">subset</span>(data, <span class="dt">select=</span><span class="kw">c</span>(<span class="st">&quot;value&quot;</span>)), <span class="dt">by =</span> <span class="kw">list</span>(<span class="dt">Agent =</span> data$Agent, <span class="dt">Tick=</span> data$Tick, <span class="dt">Runid=</span>data$Runid, <span class="dt">Scenario=</span>data$Scenario), <span class="st">&quot;mean&quot;</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)

############### substitute AFT names by AFT ID
aftNumbers &lt;-<span class="st"> </span><span class="kw">names</span>(simp$mdata$aftNames)
<span class="kw">names</span>(aftNumbers) &lt;-<span class="st"> </span>simp$mdata$aftNames
d$AFT &lt;-<span class="st"> </span>aftNumbers[<span class="kw">as.character</span>(d$AFT)]

<span class="kw">visualise_lines</span>(simp, d, <span class="st">&quot;value&quot;</span>, <span class="dt">title =</span> <span class="st">&quot;AftCompositionInvalid&quot;</span>,
        <span class="dt">colour_column =</span> <span class="st">&quot;AFT&quot;</span>, <span class="dt">colour_legenditemnames =</span> simp$mdata$aftNames,
        <span class="dt">filename =</span> <span class="st">&quot;AftCompositionInvalid&quot;</span>,
        <span class="dt">alpha=</span><span class="fl">0.7</span>)</code></pre>
<p>High level:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hl_aggregate_aftcompositions</span>(simp)</code></pre>
</div>
<div id="aggregated-demand-and-supply-data" class="section level4">
<h4>Aggregated Demand and Supply Data</h4>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(craftyr)
simp &lt;-<span class="st"> </span><span class="kw">param_getExamplesSimp</span>()
<span class="kw">input_tools_load</span>(simp, <span class="st">&quot;csv_aggregateServiceDemand&quot;</span>)

data &lt;-<span class="st"> </span><span class="kw">convert_aggregate_meltsupplydemand</span>(simp, csv_aggregateServiceDemand)

############## Aggregate regions:
data &lt;-<span class="st"> </span><span class="kw">aggregate</span>(<span class="kw">subset</span>(data, <span class="dt">select=</span><span class="kw">c</span>(<span class="st">&quot;Value&quot;</span>)),
        <span class="dt">by =</span> <span class="kw">list</span>(<span class="dt">ID =</span> data[,<span class="st">&quot;Runid&quot;</span>],
                <span class="dt">Tick=</span>data[, <span class="st">&quot;Tick&quot;</span>],  <span class="dt">Scenario =</span> data[,<span class="st">&quot;Scenario&quot;</span>],
                <span class="dt">Service=</span>data[,<span class="st">&quot;Service&quot;</span>], <span class="dt">Type=</span>data[,<span class="st">&quot;Type&quot;</span>]),
        <span class="dt">FUN=</span>sum)

<span class="kw">visualise_lines</span>(simp, data, <span class="st">&quot;Value&quot;</span>, <span class="dt">title =</span> <span class="st">&quot;Aggregated Service Supply &amp; Demand&quot;</span>,
        <span class="dt">colour_column =</span> <span class="st">&quot;Service&quot;</span>,
        <span class="dt">linetype_column =</span> <span class="st">&quot;Type&quot;</span>,
        <span class="dt">filename =</span> <span class="kw">paste</span>(<span class="st">&quot;AggregateServiceDemand&quot;</span>, 
                shbasic::<span class="kw">shbasic_condenseRunids</span>(<span class="kw">data.frame</span>(data)[, <span class="st">&quot;ID&quot;</span>]), <span class="dt">sep=</span><span class="st">&quot;_&quot;</span>),
        <span class="dt">alpha=</span><span class="fl">0.7</span>)</code></pre>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAqAAAAEgCAMAAABcujGyAAABL1BMVEUAAAAAAEgAAHQASEgASHQASJwAdHQAdJwAdL9IAABIAEhIAHRISABISEhISHRISJxIdHRIdL9InJxInL9InN90AAB0AEh0AHR0SAB0dAB0dEh0dHR0nJx0v990v/93le95hLt6hb17hr57mfN/f39/f5d/f65/l5d/l8R/rtiXf3+Xf5eXf66Xl3+Xl8SXrq6XxOucSACcSEicdACcnEicnHScv5yc37+c3/+uf3+uf5euf66ul8Su2P+/dAC/dEi/nEi/35y//7+//9+////El3/El5fEl67E6//Yrn/YxJfY68TY///fnEjfv7/f35zf/7/f/9/f///l5eXrxJfr2Njr///y8vL7k5P7vEj/lpb/v3T/wEz/2K7/35z/68T//7///9j//9///+v///9KLSAbAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAVwklEQVR4nO2dC3/bSLnGnSwFuwW6gM3uwmIW8JbuBdgs5/SkPUTLJYUEKpYNoQVMHCfV9/8MzFUa2SNb0ryjmUmf59dWqjx+/Grm77lZI40KCIpYo9ABQNAuAVAoagFQKGoBUChqAVAoagFQKGoBUChqAVAoagFQKGoBUChqAVAoagFQKGoBUChqAVAoagFQKGoBUChqAVAoagFQKGoBUChqAVAoagFQKGoBUChqAVAoagFQKGoFB/T26ODYl/dqMi73lyOmPR91e3TvYmeCNiY7rG6PRqPD0w07pvFWytYyT/FOKjigq8lo6u6Sm+VueJell7VhYR+grUyarTifNUI1oO2YtwqA+lZ2+J4Vrq4uNo+q9JYjwQv7Nsz7f0gXExugS052Zrx5qfazUe8sAKCetZ6NlwRV6D5Ac1VHrSYOn9XFxA7ovIKyPMCV9c4CAOpZ+Wi+nqmyXM9YY/dElH65e3s0znkLKJrH6WYy0UZO5YvjYjPR2AC0VumV6YS7anUZUl8JqvhbJe+G36aJBFD8y74cmXpHtctfkUCzz1DvWc8OT2vgloCyr2nt4zIWij6xcVGdKLf9cqISbZziHVVgQG+PWGmqVo81nSNVDtXu7dFbE9ayqgPjerJc7SlAtxK9VZYe/39ZklU66f5b8fmsXhT0yFc5ZIbflkkN0Pd0P7La5a+s1JeoxLr8MiiVLxkfLD4hu/drvvujo40TVd1YI4/eAqBetZRZreqPqRozbe3KfwXJxmu8RuIViazFrIksUG6nk/VXdnDMOZGH8vJFs9NYM6kAlWzKDqbelVY8jdH7yDfGVxW7Ga9bq4/LRhJY9i/v+FYnyhKNuc/Ycop3U4EBzXiBypkm1VhxZI1dUcXqA7y1NF6Th0YjBagtkVl6marcjHTSXbxbFj+Hoap1y3TbJiagqiXnbUG5K17hbXzlx0L9xlGts1kD1Pw4lS26r1CdqDzGY7We4h1UWEB5N0o3WUvd0E/NXVk+ullnRWS8pg+XgJaJ1DCmgqP6vLGZTpU+91yKOrN8a1H70G2Teh+UH+Y0VrvilfVsakIocB3Nq0FhrYk3Py6r0DRbfx2wEefWKd41hQU01xOBrEBaAXp4arzG8Z5WTbyRaKv0Vt+RW14DGekUoDyd7CRYAdVttGnSClDWl7woW3gZDDctZz1LQHl1aH7cBqDViQLQQaVaWNnxamriJaBly2i8JsvXAHQ7kSo92YkrNKBlOt1+5oe/n401DFUTX5/7qZlUbe2OJr5YHvzfbFq+XdXWVaNsTDPNax+3AWh1oiagaOK9q8zd1USPTrYHSbJERBEtzcHBVL6d1S4KEiORnFg0RhBy9FKIMUbNTAK6mvyQH1ODpLkk3PTbMhGfwPbEIInjpAZJevdWzVi9fV9Xl2oQlBsD+WqiniWuhb8JqD7R2tgMgyTfysrGTlYhG1MooxJQfUAOpvRrugfLSjM3ppmqRG9PjAFK1Z+s0hkjkI3+nvFJB8c2EzEz+bV3xZfjm7ojUO0q58zowCq7w/dKx/pPncbHWZp4s09ixPk2ppn8yeg/6TrCMlFfDWJVYVfJRMHN1eBDVkI6kZji3rpYRNVYZbpy2jxX8/aWiXpziGSasO+EnNnPDv9wpJJVu+UXy+gmiHD5HJa21ICqNNXHbQ6SyhM1jm2f4p1U6F+StlTrSTb/AOj0myWtjInOrV9c8wNvl2q9IYoHUDmIWM9EfVju7koWiXYAWv6KC/VVPIDqi9nG9d1dyeJQI6C8YXa4eAriighQOSs639zdlSwKNQJ6W//dCOojGkD/bpH1oEWv2iUjtkN4fycpee8CoDR+CYZHUvLeBUBp/BIMj6TkvQuA0vglGB5JyXsXAKXxSzA8kpL3LgBK45dgeCQl7137AX39fLH4TGwevdjcaAXKYgc7hHdnAD1//PL6k7Pi/CP+Z2OjFSiLHewQ3l0B9ObZmd5cf/qivikTBcpiBzuEd1cAVRzyDcOyvmHHF0K2N/4Mike00AypvYBePf7zYnHSCKhUoDrAwQ7h3ZUa9IqNkK4+PAOgg9oBUK0WNehLNmY/AaCD2gFQrVZ9UAYoBkmD2gUDtFpOsKVyieOgajHNxJr4Ry8wzTSoXShAOYRNV1nHCiifqD8pipunYmq+vtEKlMUOdgjPCmh8y+zxUyeNX4Lh2QqyXPvPm3qxWu+tibiBKyNX1KDqBmrq5QEEQGn8EgzPWpJLCR5v5uXfg2N9ZyDZ/I/5PTP0yyTw7BYApfFLMLyGssx4FSnuH5UfHAsK1Z2BOKDqVhP6ZRJ4dguA0vglGF5TYfKbDaqbZqmbC2f3/jaTNxpU9/DVL5PAs1sAlMYvwfAaSzOv7sAnAV3df3L/uNisQYcRAKXxSzA8W0HKG1bJqaZqykneGUj/X/VBB5p1AqA0fgmGZy3JXN0dSk3Yq5FQLm9zXR/FDzMrCkBp/BIMj6TkvQuA0vglGB5JyXsXAKXxSzA8kpL3LgBK45dgeCQl710AlMYvwfBISt67ACiNX4LhkZS8dwFQGr8Ew7MV5CurSBjpKQBK45dgeLaCBKCkWexgh/AAqP8sdrBDeADUfxY72CE8AOo/ix3sEB4A9Z/FDnYID4D6z2IHO4TXEVDxlDHLirrVg9NWx/oKgNL4JRierSCbAc3G6ln2+1WuvKMQDaC2s/rPv0hFbEftF3l4thJqW5Ai5fr74nGibarGfPQ2alBnO4TXrQatKs/1jF+qvPr2u/KZue8/kFcxz/UrxV8v0MS72yG8BkD/uSVZ1/Jr6Dmjt0dz/jTc1WTO91YPv3xwup7Ned2qXinQB6WwQ3jdR/GM0bGAj7X3q/vHRT4u8in7/1IukFevFACUwg7h9ZlmYliKx9QfHHMGVw+/+pzvqMeLq1cKAEphh/C6AboUA3PWiiv4xOaLJw8v6jWoFAB1t0N4XQdJnMKcrzYWHU7BIF8ev1J90PvH6pUCgFLYIbyuTTx/DLq8bRNvxwWD63dOxU41ipd3wwGg7nYIDz91+s9iBzuEB0D9Z7GDHcIDoP6z2MEO4QFQ/1nsYIfwAKj/LHawQ3hYduw/ix3sEB5qUP9Z7GCH8ACo/yx2sEN4ANR/FjvYITwA6j+LHewQHgD1n8UOdggPgPrPYgc7hAdA/Wexgx3C87bsWF3bRCQASuOXYHi2gmwGtPWyY3516JLuIXQAlMYvwfBsBdkIaPvFRkvxSCWyKhSA0vglGJ6tIBsB7bDsuJC1KJEAKI1fguHZCvLVq+2bPnRfdqw3FGoD6PWnL4ri9fPFo62NVqAsdrBDeB6XHecD3/rmnLN4/hH/s7HRCpTFDnYIz9+yY9LndLcA9OrnrAa9eXbGa9L6pkwSKIsd7BCet2XHlPVnG0Bf/+kvDMVrCWl9w15dCBEGBIXUjkFS22XHvPEn1H5ALz+73gGoVKA6wMEO4fladszTEc7U7wX05jcvAejgdhECGkh7AT0/KQDo4HYAVGsfoDdPRSfzBIOkQe0AqFbreVBMMw1pB0C1WgPKqtJHWxutQFnsYIfw7hCg+xUoix3sEB6WHfvPYgc7hJdyDbqeje5dZNP2LoGy2MEO4SUM6PLgOL93sZ61JzRQFjvYIbx0Ab09morrpTr8phooix3sEF66gPKfVjmgSwDa3i/B8GwFmQSgugbN2l91GiiLHewQXrqAqj5o3uEH/0BZ7GCH8BIGVFzeP+py1WmgLHawQ3jelh0vu7GzR5gHpfFLMDxbQTYD2nrZMb8etMPwZZ8AKI1fguHZCrIR0G7POJSpSWQdxY+kMIpv75dgeLaCbAS027LjQVZ1dqmmA2Wxgx3CawD0x1vqvOx4NRmmD5q16HAoBcpiBzuE53HZ8UB9UEzUd/BLMDxbQe6ZZmr5tGPPfVAt/NTZwS/B8GwF2Qhop6cdDwPoeoYmvr1fguHZCnLHIKntsmOO8uqhz0GSHsV3GIkFymIHO4Tn7WnHeZf5n73CPCiNX4Lh2QpyTx80gAAojV+C4dkKEoCSZrGDHcJLFNDyZyT8ktTJL8HwbAUZP6D9ZDurf/+TVMR21H6Rh2crobYFeRcADVQHONghvISXHetmHk18e78Ew6ODyKdsgGb3LvJxsZrgivr2fgmGRweRT1kn6qfiWSIdrpkKlMUOdggvZUDn8veBllenFgA0yfAIKfKohlWd/Nd+ANrBL8HwCCnyKFsflF/GlE3RxHfxSzA8Qoo8yjrNlI2Ny/fbKFAWO9ghvJQB7axAWexgh/ASBbTfUxYDZbGDHcJLFlDr8vw9CpTFDnYIL1FA5S0kuq7KC5TFDnYIL1lAC1mNdrh9LQBNMjwagHyraZC07HTdfqAsdrBDeIkDWmDZcSe/BMMjoGcA7ahBsWiug1+C4dEA5Fvog9L4JRgeDUC+hVE8jV+C4RER5FmYB6XxSzA8GoB8C78k0fglGB4FPv6F3+Jp/BIMj6TkvQuA0vglGB5JyXsXAKXxSzA8kpL3LgBK45dgeJZyzORy3u6jZH8CoDR+CYZnLUl5m8WItB/Q648Xi5OieP188ejF5kYrUBY72CG8uwLozdOT4urDs+L8I/5nY6MVKIsd7BDeDkBvjw5Pi+Vovp597V19588uv3xTai+gV49fsvry5ObZWXH96Yv6pkwUKIsd7BDerhqUPwYzOzhmXM5vj/iWP509DKGt+qCsFuU4MizrG/bSQshvjNBwkoCuJuMSSlaT8lt9Fznhs2U6qBWgl49fNgEqFagOcLBDeLtqUNbG/24yLRSg01wO7vv8xuisNoBesvEQAB3ULvQgaXnwA1Zh1mrQQGoB6CUbIgHQYe1CA8p6n2wr+6CHpxxUMXAKoP2AXor5JAySBrULDWiR8UqTgflrceklH8WH4XM/oNefyIoS00xD2gX/qTOTs0vhJ0X3AnouhuknbCQvpubrG61AWexgh/B2Arqe8QozCUBbKVAWO9ghvF2ALuWQHYA6ZrGDHcLD1Uz+s9jBDuEBUP9Z7GCH8ACo/yx2sEN4b9SDvAJlsYMdwgOg/rPYwQ7hAVD/Wexgh/AAqP8sdrBDeADUfxY72CE8AOo/ix3sEB4A9Z/FDnYIrxugqwm/ZLnlZaH8MXBUAqA0fgmGZyvIZkD5Ywf5U1zbCIC62yG8HoC2vek2AHW3Q3gNgH5rSwagnDz5DMLbo/cnozFr+Mfi2ie2WT34H9EHYP/7OgB1tkN4fWrQ26M5+8Of4sqvvOdX463uH/M7di4PjleTKa9h+f8oF4ACUBq/BMOzFeR+QPkOq0g5p/pvIapWhipPteRrmVCDOtshvD6Acg75cP6gBig/xGpQloL9zQEoiR3C6zlIkjuFASivOjm5ElDUoDR2CK/nNJOoMh+cGoDyoX1W1qDog9LYIbw+E/VyoRJfiWwAyh8L8z3ZORV/J6PvogZ1tkN4b9RPndazsp9sXxHbITwrdg3vDijUoDR+CYZnK0gASprFDnYID4D6z2IHO4QHQP1nsYMdwsOyY/9Z7GCH8FCD+s9iBzuEB0D9Z7GDHcIDoP6z2MEO4QFQ/1nsYIfwAKj/LHawQ3gA1H8WO9ghPADqP4sd7BBeR0D5NUu2xyCr60MNNaVsSL5HAJTGL8HwbAXZDGg25ui1eVD3zpQANCICHOyiA1ReJN8Gr90pAWhEBDjYhQNULjQ2twLQqkqUy45X335XrT6W1yirZyKLQyqluoL59vP/5S2+2rADvIYt8jZ1MRcApfFLMDxbQTY38fxZXhwqtex4NRELkFcPv5SrPNQqkFw+n06k1ICKR9VN1YYd4MfVYlAAOphfguF1A7QQjIoqUC8yZrVgPlXr5IpCv1JLqbhlSdVGHWjf0gNQGr8Ew7MV5J5pJoalWnYs6Hv41efHaqVxoZYt6eVyPKUB6PLeV3LDKlwJdlu0ACiNX4Lh2QqyEVB5VyZ144ZCDXa+ePLwol6Dbqa01aDF+p0/fN56VR0ApfFLMDxbQTYCKh8yK+55IxpoQSN/TLdaacxqzHJBskopFiAfnsqb5MzVRrwve/9h6yfYAVAavwTD6wQof7zsiD+iWy07luvk3ylXGqtRvGjhdcp8NPruOwzQH/KbiqmNArvtEAmAUvklGJ6tIPf0QftIDdjNcXuXyVAASuOXYHi2ghwG0NaToAUApfJLMDxbQQ4B6GrS7ja4UgCUxi/B8GwF6QFQR/UE9PXzxaMX1X8DZbGDHcK724Cef8T/lLLlyU8/+OADvv1gz/Yn7dIV+3zU9lXLdMR+xd7zlNtXLdMR+7UFND71A/Tm2Vlx/WlVhdoARRXlYBeqBo1P/QDlcHJIi2IhZEvzbyZs49kmKldApQLVAQ52CO8NqUGlAmWxgx3CA6D+s9jBDuHdaUAxSPJsB0C1/E0zgQAHOwCq1RPQm6eYqPdpB0C18FMnjV+C4ZGUvHcBUBq/BMMjKXnvogHUpkXUdggvEQHQKO1iD284AdAo7WIPbzgB0CjtYg9vOAHQKO1iD284AdAo7WIPbzj5AxSCCARAoagFQKGoBUChqAVAoahFCuj1x4vFibEmWVwyurFC2dWuqF2I6u6nDlLZXS0WH57te2cHv/6n23i2j1/2iy+MKAG9eXpSXLHi0ReL3jzlWbNx6airnd4Q+emDRHbXn5wVV/3iazjd4pzS7qpXSYQUJaBX7Lv5+vmJvtz+cvErtTKkXyVgtdMbKj91kCy8oqithXH3u/p5v9O1251/1scrpKj7oOyLqxcs/eMl39tcvuRopzdkfvIgpd1l/zZ02+/1n/7S/3S37F7/sW9BBBM1oKx0KiTdAd2yKxz6oA1+DkRZ7K4/7tsHtfpdfuZwult2N89+0buLHEjEgF4+MpF0BnTbrnAC1Op32bNP22DXtw9q9bv5jUODYSkM1kW++f/+3+8AogX0kn896QC12BUugFr9LntXKfbwHL6O237nJ/1Plzq8MCIFVNZF1bBI507PPLbZFQ6AWv3c6k9LeP2/jtt+N0/FnYV6dZGpwwskSkB5A8JVTiyJPOk9zWS3c5gYtPnpg0R2vHm//mWvLi3x6VKHF0qUgJ6rr3u5Jlnk7cYKZVe7/oBa/c57V1H28C4XfX+WID5d6vBCCT91QlELgEJRC4BCUQuAQlELgEJRC4BCUQuAbmg9G0kd/n42N462fn40RCoAatHq/ubTogFoKAFQiwBoPAKgFklA16KJz1lrP5aA5iNQOrgAqEUGoPnBMaeTA5p3eMo5RCUAalEFqG7a2XYJPkMIgFpUAbqaSCrXs2+hfQ8iAGqRAagaLq1nB0+2Rk7QAAKgFtlq0GmR3bsIG9YbKQBqkbUPWsIKDSkAatHGKP72aCxAzQ5PQ0f25gmAWtQwD7qejUNH9uYJgEJRC4BCUQuAQlELgEJRC4BCUQuAQlELgEJRC4BCUQuAQlELgEJRC4BCUQuAQlELgEJRC4BCUeu/gKkSvaVAbbQAAAAASUVORK5CYII=" /></p>
<p>High level:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hl_aggregate_demandsupply</span>(simp)</code></pre>
</div>
<div id="take-overs-giving-in" class="section level4">
<h4>Take Overs (Giving in)</h4>
<p>Visualize take overs due to giving in as arrows between columns of AFTs. Use <a href="https://www.wiki.ed.ac.uk/display/CRAFTY/Output#Output-TakeoverCellOutputter">CRAFTY outputter TakeoverCellOutputter</a> to output the data from CRAFTY. To visualise all take overs (giving in and giving up), see below (using cell data).</p>
<pre class="sourceCode r"><code class="sourceCode r">#################### TODO correct output_visualise_takeovers to work with gradient2sided (bezierArrowGradient2sided.R:304)

<span class="kw">library</span>(craftyr)
simp &lt;-<span class="st"> </span><span class="kw">param_getExamplesSimp</span>()
<span class="kw">input_tools_load</span>(simp, <span class="st">&quot;csv_aggregateTakeOvers&quot;</span>)
<span class="kw">input_tools_load</span>(simp, <span class="st">&quot;csv_cell_aggregated&quot;</span>)
    
startPopulation &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">names</span>(simp$mdata$aftNames), <span class="dv">0</span>)
<span class="kw">names</span>(startPopulation) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Agent&quot;</span>, <span class="st">&quot;AFT&quot;</span>)
sp &lt;-<span class="st"> </span><span class="kw">aggregate</span>(<span class="kw">subset</span>(csv_cell_aggregated, <span class="dt">select=</span><span class="kw">c</span>(<span class="st">&quot;AFT&quot;</span>),
        <span class="dt">subset =</span> csv_cell_aggregated$Tick==<span class="dv">2000</span> &amp;&amp;<span class="st"> </span>csv_cell_aggregated$Runid ==<span class="st"> &quot;0-0&quot;</span>),
        <span class="dt">by =</span> <span class="kw">list</span>(<span class="dt">Agent =</span> csv_cell_aggregated[csv_cell_aggregated$Tick ==<span class="st"> </span><span class="dv">2000</span> &amp;&amp;<span class="st"> </span>
<span class="st">                    </span>csv_cell_aggregated$Runid ==<span class="st"> &quot;0-0&quot;</span>,<span class="st">&quot;LandUseIndex&quot;</span>]), <span class="dt">FUN=</span>sum)
startPopulation[startPopulation$Agent %in%<span class="st"> </span>sp$Agent,<span class="st">&quot;AFT&quot;</span>] &lt;-<span class="st"> </span>sp$AFT 
startPopulation$Agent &lt;-<span class="st"> </span>simp$mdata$aftNames[<span class="kw">as.character</span>(startPopulation$Agent)]
    
simp$mdata$aftNames &lt;-<span class="st"> </span>simp$mdata$aftNames[-<span class="dv">1</span>]
dat &lt;-<span class="st"> </span><span class="kw">aggregate</span>(<span class="kw">subset</span>(csv_aggregateTakeOvers, <span class="dt">select=</span>simp$mdata$aftNames), <span class="dt">by =</span> <span class="kw">list</span>(
        <span class="dt">Tick=</span>csv_aggregateTakeOvers[, <span class="st">&quot;Tick&quot;</span>],
        <span class="dt">Runid=</span>csv_aggregateTakeOvers[, <span class="st">&quot;Runid&quot;</span>],
        <span class="dt">AFT=</span>csv_aggregateTakeOvers[,<span class="st">&quot;AFT&quot;</span>]),
        <span class="dt">FUN=</span>sum)

startPopulation &lt;-<span class="st"> </span>startPopulation[<span class="kw">match</span>(simp$mdata$aftNames, startPopulation$Agent),]
<span class="kw">colnames</span>(startPopulation)[<span class="kw">colnames</span>(startPopulation) ==<span class="st"> &quot;AFT&quot;</span>] &lt;-<span class="st"> &quot;Number&quot;</span>
    
<span class="kw">output_visualise_takeovers</span>(simp,
        <span class="dt">data =</span> dat, 
        <span class="dt">startpopulation =</span> startPopulation,
        <span class="dt">starttick =</span> <span class="dv">2000</span>,
        <span class="dt">endtick =</span> <span class="dv">2020</span>,
        <span class="dt">tickinterval=</span> <span class="dv">1</span>,
        <span class="dt">type_of_arrow =</span> <span class="st">&quot;simple&quot;</span>, <span class="co">#&quot;gradient2sided&quot;,</span>
        <span class="dt">transitionthreshold =</span> <span class="dv">1</span>)</code></pre>
<p>High level:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hl_takeovers</span>(simp)</code></pre>
</div>
<div id="take-overs-all" class="section level4">
<h4>Take Overs (All)</h4>
<p>Requirements: * Land use indices stored in an object whose name is given by <code>landusedataname</code></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(craftyr)
simp &lt;-<span class="st"> </span><span class="kw">param_getExamplesSimp</span>()
 
csv_dataTakeOversAll &lt;-<span class="st"> </span><span class="kw">convert_aggregate_takeovers</span>(simp,
    <span class="dt">landusedataname =</span> <span class="st">&quot;csv_LandUseIndex_rbinded&quot;</span>)
<span class="kw">input_tools_save</span>(simp, <span class="st">&quot;csv_dataTakeOversAll&quot;</span>)

<span class="kw">hl_takeovers</span>(simp, <span class="dt">runid =</span> simp$sim$runids[<span class="dv">1</span>], 
        <span class="dt">dataname            =</span> <span class="st">&quot;csv_cell_aggregated&quot;</span>,
        <span class="dt">starttick           =</span> <span class="dv">2000</span>, 
        <span class="dt">tickinterval        =</span> <span class="dv">5</span>, 
        <span class="dt">endtick             =</span> <span class="dv">2020</span>,
        <span class="dt">datanametakeovers   =</span> <span class="st">&quot;csv_dataTakeOversAll&quot;</span>)</code></pre>
<p>For larger sets of AFT it is advisable to group these into fewer sets. This can be achieved by passing the <code>aftaggregation</code> parameter:</p>
<pre class="sourceCode r"><code class="sourceCode r">aftaggregation &lt;-<span class="st"> </span>simp$mdata$aftNames
<span class="kw">data.entry</span>(simp$mdata$aftNames, aftaggregation, <span class="dt">Modes=</span><span class="kw">list</span>(<span class="st">&quot;character&quot;</span>, <span class="st">&quot;character&quot;</span>))
<span class="kw">hl_takeovers</span>(simp, <span class="dt">runid =</span> simp$sim$runids[<span class="dv">1</span>],
        <span class="dt">dataname            =</span> <span class="st">&quot;csv_cell_aggregated&quot;</span>,
        <span class="dt">starttick           =</span> <span class="dv">2000</span>, 
        <span class="dt">tickinterval        =</span> <span class="dv">5</span>, 
        <span class="dt">endtick             =</span> <span class="dv">2020</span>,
        <span class="dt">datanametakeovers   =</span> <span class="st">&quot;csv_dataTakeOversAll&quot;</span>,
        <span class="dt">aftaggregation      =</span> aftaggregation)</code></pre>
<p>High level:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hl_takeovers_all</span>(simp, <span class="dt">landusedataname =</span> <span class="st">&quot;csv_LandUseIndex_rbinded&quot;</span>,
    <span class="dt">starttick =</span> <span class="dv">2000</span>, <span class="dt">tickinterval=</span><span class="dv">5</span>, <span class="dt">endtick =</span> <span class="dv">2020</span>)</code></pre>
</div>
<div id="givinginstatistics-frequencies-per-aft---regions-aggregated" class="section level4">
<h4>GivingInStatistics (Frequencies per AFT - Regions aggregated)</h4>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(craftyr)
<span class="kw">library</span>(reshape2)
simp &lt;-<span class="st"> </span><span class="kw">param_getExamplesSimp</span>()
<span class="kw">input_tools_load</span>(simp, <span class="st">&quot;csv_aggregateGiStatistics&quot;</span>)

regions =<span class="st"> </span>simp$sim$regions
csv_aggregateGiStatistics &lt;-<span class="st"> </span>csv_aggregateGiStatistics[csv_aggregateGiStatistics[,<span class="st">&quot;Region&quot;</span>] %in%<span class="st"> </span>regions,]

dat &lt;-<span class="st"> </span><span class="kw">aggregate</span>(<span class="kw">subset</span>(csv_aggregateGiStatistics, <span class="dt">select=</span>simp$mdata$aftNames[-<span class="dv">1</span>]), <span class="dt">by =</span> <span class="kw">list</span>(
                <span class="dt">Trials=</span>csv_aggregateGiStatistics[, <span class="st">&quot;Trials&quot;</span>],
                <span class="dt">Runid=</span>csv_aggregateGiStatistics[, <span class="st">&quot;Runid&quot;</span>]),
        <span class="dt">FUN=</span>sum)

melteddat &lt;-<span class="st"> </span>reshape2::<span class="kw">melt</span>(dat, <span class="dt">variable.name=</span><span class="st">&quot;AFT&quot;</span>, <span class="dt">id.vars=</span> <span class="kw">c</span>(<span class="st">&quot;Trials&quot;</span>, <span class="st">&quot;Runid&quot;</span>), 
        <span class="dt">direction=</span><span class="st">&quot;long&quot;</span>, <span class="dt">value.name =</span> <span class="st">&quot;Number&quot;</span>)

<span class="kw">visualise_bars</span>(simp, <span class="dt">data =</span> melteddat, <span class="dt">y_column =</span> <span class="st">&quot;Number&quot;</span>, <span class="dt">title =</span> <span class="st">&quot;Giving In Statistics&quot;</span>,
        <span class="dt">facet_column =</span> <span class="st">&quot;AFT&quot;</span>, <span class="dt">facet_ncol =</span> <span class="dv">1</span>, <span class="dt">fill_column =</span> <span class="st">&quot;AFT&quot;</span>,
        <span class="dt">alpha=</span><span class="fl">1.0</span>, <span class="dt">x_column =</span> <span class="st">&quot;Trials&quot;</span>, <span class="dt">ggplotaddons =</span> ggplot2::<span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;none&quot;</span>))</code></pre>
<p><img src="data:image/png;base64,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" /></p>
<p>High level:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hl_gistatistics_singleRegion</span>(simp, <span class="dt">dataname =</span> <span class="st">&quot;csv_aggregateGiStatistics&quot;</span>, 
        <span class="dt">regions =</span> simp$sim$regions, <span class="dt">facet_ncol =</span> <span class="dv">1</span>)</code></pre>
</div>
<div id="pre-allocation-competitiveness" class="section level4">
<h4>Pre-Allocation Competitiveness</h4>
<p>% TODO High level:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hl_competitiveness_prealloc</span>(simp, <span class="dt">dataname =</span> <span class="st">&quot;csv_preAlloc_rbinded&quot;</span>, 
        <span class="dt">facet_ncol =</span> <span class="kw">length</span>(simp$mdata$aftNames), <span class="dt">filename =</span> <span class="kw">paste</span>(<span class="st">&quot;PreAllocationCompetition&quot;</span>, 
        simp$sim$id, <span class="dt">sep=</span><span class="st">&quot;_b_&quot;</span>),
        <span class="dt">maxcompetitiveness =</span> <span class="st">&quot;100%&quot;</span>, <span class="dt">numbins =</span> <span class="dv">15</span>, <span class="dt">title =</span> <span class="ot">NULL</span>, <span class="dt">ggplotaddons =</span> <span class="ot">NULL</span>, <span class="dt">checkexists =</span> <span class="ot">FALSE</span>)</code></pre>
<p>High level when separating AFTs:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hl_competitiveness_preallocPerAft</span>(simp, <span class="dt">dataname =</span> <span class="st">&quot;csv_preAlloc_rbinded&quot;</span>, 
        <span class="dt">facet_ncol =</span> <span class="kw">length</span>(simp$mdata$aftNames), <span class="dt">filename =</span> <span class="kw">paste</span>(<span class="st">&quot;PreAllocationCompetition&quot;</span>, 
        simp$sim$id, <span class="dt">sep=</span><span class="st">&quot;_b_&quot;</span>),
        <span class="dt">maxcompetitiveness =</span> <span class="st">&quot;100%&quot;</span>, <span class="dt">numbins =</span> <span class="dv">15</span>, <span class="dt">title =</span> <span class="ot">NULL</span>, <span class="dt">ggplotaddons =</span> <span class="ot">NULL</span>, <span class="dt">checkexists =</span> <span class="ot">FALSE</span>)</code></pre>
</div>
<div id="cell-volatility-1" class="section level4">
<h4>Cell Volatility</h4>
<p>TODO</p>
<pre class="sourceCode r"><code class="sourceCode r">cellnumber &lt;-<span class="st"> </span><span class="kw">input_csv_param_capitals_cellnumbers</span>(simp, <span class="dt">capitals =</span> simp$mdata$capitals, 
        <span class="dt">regionpartfromend =</span> <span class="dv">2</span>, <span class="dt">regionpartdevider =</span> <span class="st">&quot;_&quot;</span>)</code></pre>
<p>High level:</p>
<pre class="sourceCode r"><code class="sourceCode r">numcells &lt;-<span class="st"> </span>cellnumbers &lt;-<span class="st"> </span><span class="kw">input_csv_param_capitals_cellnumbers</span>(simp, <span class="dt">regionpartfromend =</span> <span class="dv">2</span>, <span class="dt">regionpartdevider =</span> <span class="st">&quot;_&quot;</span>)
<span class="kw">hl_volatility</span>(simp, <span class="dt">dataname =</span> <span class="st">&quot;csv_aggregated_cellvolatility&quot;</span>, 
        <span class="dt">datatype =</span> <span class="st">&quot;AggregateCellVolatility&quot;</span>, <span class="dt">datacolumns =</span> <span class="kw">c</span>(<span class="st">&quot;CellVolatility&quot;</span>, <span class="st">&quot;NumVolatileCells&quot;</span>),
        <span class="dt">percent =</span> numcells)</code></pre>
</div>
<div id="marginal-utilities" class="section level4">
<h4>Marginal Utilities</h4>
<p>TODO</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">input_tools_load</span>(simp, <span class="st">&quot;csv_MarginalUtilitites_melt&quot;</span>)
<span class="kw">visualise_lines</span>(simp, data, <span class="st">&quot;value&quot;</span>, <span class="dt">title =</span> <span class="st">&quot;Marginal Utilities&quot;</span>,
        <span class="dt">colour_column =</span> <span class="st">&quot;Service&quot;</span>,
        <span class="dt">filename =</span> <span class="kw">paste</span>(<span class="st">&quot;MarginalUtilities&quot;</span>, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>),
        <span class="dt">alpha=</span><span class="fl">0.7</span>)</code></pre>
<p>High level:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hl_marginalutilities</span>(simp)</code></pre>
</div>
<div id="demand-normalised-per-cell-marginal-utilities" class="section level4">
<h4>Demand-normalised per-cell marginal Utilities</h4>
<p>The file MarginalUtilitiesPerCell.csv can be craeted by python script extractMarginalUtilityFromFiles.py.</p>
<p>TODO</p>
<p>High level:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hl_normalisedutilities</span>(simp,
        <span class="dt">filenamemarginalutils =</span> <span class="kw">paste</span>(simp$dirs$output$rdata, <span class="st">&quot;MarginalUtilitiesPerCell.csv&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;/&quot;</span>),
        <span class="dt">filenameNormalisedResiduals =</span> <span class="kw">paste</span>(<span class="st">&quot;NormalisedResiduals&quot;</span>, 
                shbasic::<span class="kw">shbasic_condenseRunids</span>(<span class="kw">data.frame</span>(data)[, <span class="st">&quot;ID&quot;</span>]), <span class="dt">sep=</span><span class="st">&quot;_&quot;</span>),
        <span class="dt">capitalfilepartorder =</span> <span class="kw">c</span>(<span class="st">&quot;regionalisation&quot;</span>, <span class="st">&quot;U&quot;</span>, <span class="st">&quot;regions&quot;</span>, <span class="st">&quot;U&quot;</span>, <span class="st">&quot;datatype&quot;</span>))</code></pre>
</div>
<div id="total-productivity" class="section level4">
<h4>Total Productivity</h4>
</div>
</div>
<div id="from-single-files" class="section level3">
<h3>From Single Files</h3>
<div id="aft-composition" class="section level4">
<h4>AFT Composition</h4>
<p>Reads single CSV file with AFT composition and produces timeline figure.</p>
<p>High level:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hl_aftcomposisition_file</span>(simp, csvfilename, <span class="dt">title =</span> <span class="st">&quot;AftComposition&quot;</span>, 
        <span class="dt">figurefilename =</span> <span class="st">&quot;AftComposition&quot;</span>) 

### Comparisons
To compare different data sets, according sip lists need to be defined:</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">source</span>(<span class="st">&quot;./simp44.R&quot;</span>)
simp1 &lt;-<span class="st"> </span>simp
simp1$sim$shortid &lt;-<span class="st"> &quot;SD.9&quot;</span>

<span class="kw">source</span>(<span class="st">&quot;./simp45.R&quot;</span>)
simp2 &lt;-<span class="st"> </span>simp
simp2$sim$shortid &lt;-<span class="st"> &quot;SD.4&quot;</span>

<span class="kw">source</span>(<span class="st">&quot;./simp46.R&quot;</span>)
simp3 &lt;-<span class="st"> </span>simp
simp3$sim$shortid &lt;-<span class="st"> &quot;SD.55&quot;</span>
simps &lt;-<span class="st"> </span><span class="kw">list</span>(simp1, simp2, simp3)</code></pre>
</div>
<div id="aft-composition-1" class="section level4">
<h4>AFT Composition</h4>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hl_comp_aggregate_aftcompositions</span>(simp, simps, <span class="dt">dataname=</span><span class="st">&quot;dataAggregateAFTComposition&quot;</span>)</code></pre>
</div>
<div id="demand-and-supply" class="section level4">
<h4>Demand and Supply</h4>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hl_comp_demandsupply</span>(simp, simps, <span class="dt">dataname=</span><span class="st">&quot;dataAggregateSupplyDemand&quot;</span>)</code></pre>
</div>
</div>
</div>
</div>
<div id="output-write-csv-data" class="section level1">
<h1>Output (write) CSV Data</h1>
<div id="generate-landuseindex-key" class="section level2">
<h2>Generate LandUseIndex key</h2>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hl_landindiceskey_csv</span>(simp)</code></pre>
</div>
<div id="aggregate-demand-and-supply" class="section level2">
<h2>Aggregate demand and supply</h2>
<p>Aggregates demand and supply for all regions per tick and stores data as CSV file.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hl_aggregate_demandsupply_csv</span>(simp)</code></pre>
</div>
<div id="supplydemand-gap-regarding-agent-parameters-gu-probability" class="section level2">
<h2>Supply/Demand gap regarding agent parameters (GU probability)</h2>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hl_comp_demandsupplygap_agentparams</span>(simp, <span class="dt">simps =</span> <span class="kw">input_tools_buildsimplist</span>(<span class="dv">111</span>:<span class="dv">116</span>),
        <span class="dt">dataname =</span> <span class="st">&quot;dataAggregateSupplyDemand&quot;</span>, 
        <span class="dt">filename =</span> <span class="kw">paste</span>(<span class="st">&quot;SupplyDemandGap_&quot;</span>, 
                if(!<span class="kw">is.null</span>(simp$sim$rundesc))<span class="kw">paste</span>(simp$sim$rundesc, <span class="dt">collapse =</span> <span class="st">&quot;-&quot;</span>) else simp$sim$id, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>),
        <span class="dt">title =</span> <span class="st">&quot;Demand/Supply Gap&quot;</span>,
        <span class="dt">agentparam =</span> <span class="st">&quot;givingUpProb&quot;</span>, <span class="dt">aft =</span> simp$mdata$aftNames[<span class="dv">2</span>], 
        <span class="dt">ggplotparams =</span> ggplot2::<span class="kw">xlab</span>(<span class="st">&quot;Probability of Giving up&quot;</span>))</code></pre>
</div>
</div>
<div id="conversions" class="section level1">
<h1>Conversions</h1>
<ul>
<li>convert_csv2shapefile</li>
</ul>
<div id="stored-csvdata.frame-rdata-to-raster-file-ascii" class="section level2">
<h2>Stored CSV/data.frame (rData) to raster file (ASCII)</h2>
<pre class="sourceCode r"><code class="sourceCode r">simp &lt;-<span class="st"> </span><span class="kw">param_getExamplesSimp</span>()
<span class="kw">input_tools_load</span>(simp, <span class="dt">dataname =</span> <span class="st">&quot;csv_LandUseIndex_rbinded&quot;</span>)

data &lt;-<span class="st"> </span><span class="kw">get</span>(dataname)
data &lt;-<span class="st"> </span>data[data$Tick ==<span class="st"> </span><span class="dv">2010</span>, <span class="kw">c</span>(simp$csv$cname_x, simp$csv$cname_y, <span class="st">&quot;LandUseIndex&quot;</span>)]
<span class="kw">rownames</span>(data) &lt;-<span class="st"> </span><span class="ot">NULL</span>

raster &lt;-<span class="st"> </span>craftyr::<span class="kw">convert_2raster</span>(simp, data, <span class="dt">targetCRS =</span> <span class="st">&quot;+init=EPSG:32632&quot;</span>, <span class="dt">layers=</span><span class="kw">c</span>(<span class="dv">1</span>))

filename &lt;-<span class="st"> </span><span class="kw">sprintf</span>(<span class="st">&quot;%s/%s_LandUseIndex_%d.%s&quot;</span>,
        simp$dirs$output$raster,
        <span class="kw">output_tools_getDefaultFilename</span>(simp),
        <span class="kw">as.integer</span>(tick),
        <span class="st">&quot;asc&quot;</span>)
shbasic::<span class="kw">sh.ensurePath</span>(filename, <span class="dt">stripFilename =</span> <span class="ot">TRUE</span>)
raster::<span class="kw">writeRaster</span>(raster[[<span class="dv">1</span>]][[<span class="dv">1</span>]], <span class="dt">filename =</span> filename, <span class="dt">format =</span> <span class="st">&quot;ascii&quot;</span>, 
        <span class="dt">NAflag=</span>naflag, <span class="dt">overwrite=</span><span class="ot">TRUE</span>)</code></pre>
<p>High level:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hl_cell2raster</span>(simp, tick, <span class="dt">dataname =</span> <span class="st">&quot;csv_LandUseIndex_rbinded&quot;</span>, 
        <span class="dt">landuseindexcolname =</span> <span class="st">&quot;LandUseIndex&quot;</span>, <span class="dt">naflag =</span> -<span class="dv">9</span>)</code></pre>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
