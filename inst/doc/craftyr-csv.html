<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Sascha Holzhauer" />

<meta name="date" content="2016-12-09" />

<title>Using CSV data with craftyr</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; }
code > span.dt { color: #902000; }
code > span.dv { color: #40a070; }
code > span.bn { color: #40a070; }
code > span.fl { color: #40a070; }
code > span.ch { color: #4070a0; }
code > span.st { color: #4070a0; }
code > span.co { color: #60a0b0; font-style: italic; }
code > span.ot { color: #007020; }
code > span.al { color: #ff0000; font-weight: bold; }
code > span.fu { color: #06287e; }
code > span.er { color: #ff0000; font-weight: bold; }
</style>



<link href="data:text/css,body%20%7B%0A%20%20background%2Dcolor%3A%20%23fff%3B%0A%20%20margin%3A%201em%20auto%3B%0A%20%20max%2Dwidth%3A%20700px%3B%0A%20%20overflow%3A%20visible%3B%0A%20%20padding%2Dleft%3A%202em%3B%0A%20%20padding%2Dright%3A%202em%3B%0A%20%20font%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0A%20%20font%2Dsize%3A%2014px%3B%0A%20%20line%2Dheight%3A%201%2E35%3B%0A%7D%0A%0A%23header%20%7B%0A%20%20text%2Dalign%3A%20center%3B%0A%7D%0A%0A%23TOC%20%7B%0A%20%20clear%3A%20both%3B%0A%20%20margin%3A%200%200%2010px%2010px%3B%0A%20%20padding%3A%204px%3B%0A%20%20width%3A%20400px%3B%0A%20%20border%3A%201px%20solid%20%23CCCCCC%3B%0A%20%20border%2Dradius%3A%205px%3B%0A%0A%20%20background%2Dcolor%3A%20%23f6f6f6%3B%0A%20%20font%2Dsize%3A%2013px%3B%0A%20%20line%2Dheight%3A%201%2E3%3B%0A%7D%0A%20%20%23TOC%20%2Etoctitle%20%7B%0A%20%20%20%20font%2Dweight%3A%20bold%3B%0A%20%20%20%20font%2Dsize%3A%2015px%3B%0A%20%20%20%20margin%2Dleft%3A%205px%3B%0A%20%20%7D%0A%0A%20%20%23TOC%20ul%20%7B%0A%20%20%20%20padding%2Dleft%3A%2040px%3B%0A%20%20%20%20margin%2Dleft%3A%20%2D1%2E5em%3B%0A%20%20%20%20margin%2Dtop%3A%205px%3B%0A%20%20%20%20margin%2Dbottom%3A%205px%3B%0A%20%20%7D%0A%20%20%23TOC%20ul%20ul%20%7B%0A%20%20%20%20margin%2Dleft%3A%20%2D2em%3B%0A%20%20%7D%0A%20%20%23TOC%20li%20%7B%0A%20%20%20%20line%2Dheight%3A%2016px%3B%0A%20%20%7D%0A%0Atable%20%7B%0A%20%20margin%3A%201em%20auto%3B%0A%20%20border%2Dwidth%3A%201px%3B%0A%20%20border%2Dcolor%3A%20%23DDDDDD%3B%0A%20%20border%2Dstyle%3A%20outset%3B%0A%20%20border%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0A%20%20border%2Dwidth%3A%202px%3B%0A%20%20padding%3A%205px%3B%0A%20%20border%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0A%20%20border%2Dwidth%3A%201px%3B%0A%20%20border%2Dstyle%3A%20inset%3B%0A%20%20line%2Dheight%3A%2018px%3B%0A%20%20padding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0A%20%20border%2Dleft%2Dstyle%3A%20none%3B%0A%20%20border%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0A%0Ap%20%7B%0A%20%20margin%3A%200%2E5em%200%3B%0A%7D%0A%0Ablockquote%20%7B%0A%20%20background%2Dcolor%3A%20%23f6f6f6%3B%0A%20%20padding%3A%200%2E25em%200%2E75em%3B%0A%7D%0A%0Ahr%20%7B%0A%20%20border%2Dstyle%3A%20solid%3B%0A%20%20border%3A%20none%3B%0A%20%20border%2Dtop%3A%201px%20solid%20%23777%3B%0A%20%20margin%3A%2028px%200%3B%0A%7D%0A%0Adl%20%7B%0A%20%20margin%2Dleft%3A%200%3B%0A%7D%0A%20%20dl%20dd%20%7B%0A%20%20%20%20margin%2Dbottom%3A%2013px%3B%0A%20%20%20%20margin%2Dleft%3A%2013px%3B%0A%20%20%7D%0A%20%20dl%20dt%20%7B%0A%20%20%20%20font%2Dweight%3A%20bold%3B%0A%20%20%7D%0A%0Aul%20%7B%0A%20%20margin%2Dtop%3A%200%3B%0A%7D%0A%20%20ul%20li%20%7B%0A%20%20%20%20list%2Dstyle%3A%20circle%20outside%3B%0A%20%20%7D%0A%20%20ul%20ul%20%7B%0A%20%20%20%20margin%2Dbottom%3A%200%3B%0A%20%20%7D%0A%0Apre%2C%20code%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20color%3A%20%23333%3B%0A%20%20white%2Dspace%3A%20pre%2Dwrap%3B%20%20%20%20%2F%2A%20Wrap%20long%20lines%20%2A%2F%0A%7D%0Apre%20%7B%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20margin%3A%205px%200px%2010px%200px%3B%0A%20%20padding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0A%0Acode%20%7B%0A%20%20font%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0A%20%20font%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0A%20%20padding%3A%202px%200px%3B%0A%7D%0A%0Adiv%2Efigure%20%7B%0A%20%20text%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0A%20%20background%2Dcolor%3A%20%23FFFFFF%3B%0A%20%20padding%3A%202px%3B%0A%20%20border%3A%201px%20solid%20%23DDDDDD%3B%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20border%3A%201px%20solid%20%23CCCCCC%3B%0A%20%20margin%3A%200%205px%3B%0A%7D%0A%0Ah1%20%7B%0A%20%20margin%2Dtop%3A%200%3B%0A%20%20font%2Dsize%3A%2035px%3B%0A%20%20line%2Dheight%3A%2040px%3B%0A%7D%0A%0Ah2%20%7B%0A%20%20border%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0A%20%20padding%2Dtop%3A%2010px%3B%0A%20%20padding%2Dbottom%3A%202px%3B%0A%20%20font%2Dsize%3A%20145%25%3B%0A%7D%0A%0Ah3%20%7B%0A%20%20border%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0A%20%20padding%2Dtop%3A%2010px%3B%0A%20%20font%2Dsize%3A%20120%25%3B%0A%7D%0A%0Ah4%20%7B%0A%20%20border%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0A%20%20margin%2Dleft%3A%208px%3B%0A%20%20font%2Dsize%3A%20105%25%3B%0A%7D%0A%0Ah5%2C%20h6%20%7B%0A%20%20border%2Dbottom%3A%201px%20solid%20%23ccc%3B%0A%20%20font%2Dsize%3A%20105%25%3B%0A%7D%0A%0Aa%20%7B%0A%20%20color%3A%20%230033dd%3B%0A%20%20text%2Ddecoration%3A%20none%3B%0A%7D%0A%20%20a%3Ahover%20%7B%0A%20%20%20%20color%3A%20%236666ff%3B%20%7D%0A%20%20a%3Avisited%20%7B%0A%20%20%20%20color%3A%20%23800080%3B%20%7D%0A%20%20a%3Avisited%3Ahover%20%7B%0A%20%20%20%20color%3A%20%23BB00BB%3B%20%7D%0A%20%20a%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0A%20%20%20%20text%2Ddecoration%3A%20underline%3B%20%7D%0A%20%20a%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0A%20%20%20%20text%2Ddecoration%3A%20underline%3B%20%7D%0A%0A%2F%2A%20Class%20described%20in%20https%3A%2F%2Fbenjeffrey%2Ecom%2Fposts%2Fpandoc%2Dsyntax%2Dhighlighting%2Dcss%0A%20%20%20Colours%20from%20https%3A%2F%2Fgist%2Egithub%2Ecom%2Frobsimmons%2F1172277%20%2A%2F%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20Keyword%20%2A%2F%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%2F%2A%20DataType%20%2A%2F%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%2F%2A%20DecVal%20%28decimal%20values%29%20%2A%2F%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20BaseN%20%2A%2F%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20Float%20%2A%2F%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20Char%20%2A%2F%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20String%20%2A%2F%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%2F%2A%20Comment%20%2A%2F%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%2F%2A%20OtherToken%20%2A%2F%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20AlertToken%20%2A%2F%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20Function%20calls%20%2A%2F%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%2F%2A%20ErrorTok%20%2A%2F%0A%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Using CSV data with craftyr</h1>
<h4 class="author"><em>Sascha Holzhauer</em></h4>
<h4 class="date"><em>2016-12-09</em></h4>


<div id="TOC">
<ul>
<li><a href="#input-read-csv-data">Input (read) CSV Data</a><ul>
<li><a href="#overall-features">(Overall) Features</a></li>
<li><a href="#source-regional-csv-data-celltable---land-use-data-per-cell">Source: Regional CSV data (CellTable) - Land use data per cell</a></li>
<li><a href="#source-regional-csv-data-celltable---aggregated-data">Source: Regional CSV data (CellTable) - Aggregated data</a></li>
<li><a href="#source-cell-table-pre-allocation-competitiveness">Source: Cell Table (Pre-Allocation Competitiveness)</a></li>
<li><a href="#source-aggregated-aft-composition">Source: Aggregated AFT Composition</a></li>
<li><a href="#source-aggregated-demand-and-supply-data-aggregatedemandsupplycsvoutputter">Source: Aggregated Demand and Supply Data (AggregateDemandSupplyCSVOutputter)</a></li>
<li><a href="#source-takeover-from-giving-in-data-takeovercelloutputter">Source: TakeOver from Giving In Data (TakeoverCellOutputter)</a></li>
<li><a href="#source-givingin-statistics-givinginstatisticsoutputter">Source: GivingIn Statistics (GivingInStatisticsOutputter)</a></li>
<li><a href="#source-marginal-utilities">Source: Marginal Utilities</a></li>
</ul></li>
<li><a href="#visualise-csv-data">Visualise CSV Data</a><ul>
<li><a href="#map-data">Map Data</a><ul>
<li><a href="#landuseindex-facets">LandUseIndex: Facets</a></li>
<li><a href="#landuseindex-raw-plot">LandUseIndex: Raw Plot</a></li>
</ul></li>
<li><a href="#aggregate-data">Aggregate Data</a><ul>
<li><a href="#from-cell-level-data">From Cell Level Data</a><ul>
<li><a href="#aft-composition-as-timeline">AFT Composition as Timeline</a></li>
<li><a href="#competitiveness-mean-by-region">Competitiveness (Mean by region)</a></li>
<li><a href="#spatial-autocorrelation">Spatial Autocorrelation</a></li>
<li><a href="#cell-connectedness">Cell Connectedness</a></li>
<li><a href="#cell-volatility">Cell Volatility</a></li>
<li><a href="#further-cell-data-as-timeline">Further Cell Data as Timeline</a></li>
</ul></li>
<li><a href="#from-aggregated-region-level-data">From Aggregated (Region Level) Data</a><ul>
<li><a href="#aft-composition-as-timeline-1">AFT Composition as Timeline</a></li>
<li><a href="#aggregated-demand-and-supply-data">Aggregated Demand and Supply Data</a></li>
<li><a href="#take-overs-giving-in">Take Overs (Giving in)</a></li>
<li><a href="#take-overs-all">Take Overs (All)</a></li>
<li><a href="#givinginstatistics-frequencies-per-aft---regions-aggregated">GivingInStatistics (Frequencies per AFT - Regions aggregated)</a></li>
<li><a href="#pre-allocation-competitiveness">Pre-Allocation Competitiveness</a></li>
<li><a href="#cell-volatility-1">Cell Volatility</a></li>
<li><a href="#marginal-utilities">Marginal Utilities</a></li>
<li><a href="#demand-normalised-per-cell-marginal-utilities">Demand-normalised per-cell marginal Utilities</a></li>
<li><a href="#total-productivity">Total Productivity</a></li>
<li><a href="#actions">Actions</a></li>
</ul></li>
<li><a href="#from-single-files">From Single Files</a><ul>
<li><a href="#aft-composition">AFT Composition</a></li>
<li><a href="#aft-composition-1">AFT Composition</a></li>
<li><a href="#demand-and-supply">Demand and Supply</a></li>
</ul></li>
</ul></li>
</ul></li>
<li><a href="#output-write-csv-data">Output (write) CSV Data</a><ul>
<li><a href="#land-use-index-per-tick">Land Use Index (per tick)</a></li>
<li><a href="#generate-landuseindex-key">Generate LandUseIndex key</a></li>
<li><a href="#aggregate-demand-and-supply">Aggregate demand and supply</a></li>
<li><a href="#supplydemand-gap-regarding-agent-parameters-gu-probability">Supply/Demand gap regarding agent parameters (GU probability)</a></li>
</ul></li>
<li><a href="#conversions">Conversions</a><ul>
<li><a href="#stored-csvdata.frame-rdata-to-raster-file-ascii">Stored CSV/data.frame (rData) to raster file (ASCII)</a></li>
</ul></li>
</ul>
</div>

<div id="input-read-csv-data" class="section level1">
<h1>Input (read) CSV Data</h1>
<div id="overall-features" class="section level2">
<h2>(Overall) Features</h2>
<ul>
<li>Limit considered ticks by starttick, endtick, and interval</li>
<li>Read CSV files of multiple regions at once</li>
</ul>
</div>
<div id="source-regional-csv-data-celltable---land-use-data-per-cell" class="section level2">
<h2>Source: Regional CSV data (CellTable) - Land use data per cell</h2>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(craftyr)
simp &lt;-<span class="st"> </span><span class="kw">param_getExamplesSimp</span>()

futile.logger::<span class="kw">flog.threshold</span>(futile.logger::DEBUG, <span class="dt">name=</span><span class="st">'craftyr.input.csv'</span>)

cdata &lt;-<span class="st"> </span><span class="kw">input_csv_data</span>(simp, <span class="dt">dataname =</span> <span class="ot">NULL</span>, <span class="dt">datatype =</span> <span class="st">&quot;Cell&quot;</span>, <span class="dt">columns =</span> <span class="st">&quot;LandUseIndex&quot;</span>,
        <span class="dt">pertick =</span> <span class="ot">TRUE</span>, <span class="dt">starttick =</span> <span class="dv">2000</span>, <span class="dt">endtick =</span> <span class="dv">2020</span>, <span class="dt">tickinterval =</span> <span class="dv">10</span>,
        <span class="dt">attachfileinfo =</span> <span class="ot">TRUE</span>, <span class="dt">bindrows =</span> <span class="ot">TRUE</span>)
csv_LandUseIndex_rbinded &lt;-<span class="st"> </span>cdata
<span class="kw">input_tools_save</span>(simp, <span class="st">&quot;csv_LandUseIndex_rbinded&quot;</span>)
cdata &lt;-<span class="st"> </span><span class="kw">split</span>(cdata, <span class="kw">list</span>(cdata$Tick, cdata$Runid))
csv_LandUseIndex_split &lt;-<span class="st"> </span>cdata
<span class="kw">input_tools_save</span>(simp, <span class="st">&quot;csv_LandUseIndex_split&quot;</span>)</code></pre>
<p>High level:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hl_store_csvcelldata</span>(simp, <span class="dt">dataname =</span> <span class="st">&quot;csv_LandUseIndex_rbinded&quot;</span>, <span class="dt">tickinterval =</span> <span class="dv">10</span>)</code></pre>
<p>For large data sets it is a good idea to clean the data somewhat before storing:</p>
<pre class="sourceCode r"><code class="sourceCode r">cdata &lt;-<span class="st"> </span><span class="kw">input_csv_data</span>(simp, <span class="dt">dataname =</span> <span class="ot">NULL</span>, <span class="dt">datatype =</span> <span class="st">&quot;Cell&quot;</span>, <span class="dt">colums =</span> <span class="st">&quot;LandUseIndex&quot;</span>,
        <span class="dt">pertick =</span> <span class="ot">TRUE</span>, <span class="dt">starttick =</span> <span class="dv">2010</span>, <span class="dt">endtick =</span> <span class="dv">2040</span>, <span class="dt">tickinterval =</span> <span class="dv">30</span>, <span class="dt">attachfileinfo =</span> <span class="ot">TRUE</span>)

cdata$Region &lt;-<span class="st"> </span><span class="ot">NULL</span>
cdata$Scenario &lt;-<span class="st"> </span><span class="ot">NULL</span>

data &lt;-<span class="st"> </span><span class="kw">split</span>(cdata, <span class="kw">list</span>(cdata$Tick,cdata$Runid))

cdata &lt;-<span class="st"> </span><span class="kw">lapply</span>(cdata, function(x) {x$Runid &lt;-<span class="st"> </span><span class="ot">NULL</span>; x})
cdata &lt;-<span class="st"> </span><span class="kw">lapply</span>(cdata, function(x) {x$Tick &lt;-<span class="st"> </span><span class="ot">NULL</span>; x})

csv_LandUseIndex_split &lt;-<span class="st"> </span>cadata
<span class="kw">input_tools_save</span>(simp, <span class="st">&quot;csv_LandUseIndex_split&quot;</span>)
<span class="kw">rm</span>(<span class="kw">list</span>(csv_LandUseIndex_split, cdata)</code></pre>
</div>
<div id="source-regional-csv-data-celltable---aggregated-data" class="section level2">
<h2>Source: Regional CSV data (CellTable) - Aggregated data</h2>
<p>Note that the fields in cell table depend on the output configuration as well as service names. Thus, the aggregation function needs to be adapted.</p>
<pre class="sourceCode r"><code class="sourceCode r">aggregationFunction &lt;-<span class="st"> </span>function(simp, data) {
    <span class="kw">library</span>(plyr) <span class="co"># because '.' function cannot be addressed</span>
    plyr::<span class="kw">ddply</span>(data, .(Runid, Region, Tick, LandUseIndex), <span class="dt">.fun=</span>function(df) {
                df$Counter &lt;-<span class="st"> </span><span class="dv">1</span>
                <span class="kw">with</span>(df, <span class="kw">data.frame</span>(
                                <span class="dt">Runid               =</span> <span class="kw">unique</span>(Runid),
                                <span class="dt">Region              =</span> <span class="kw">unique</span>(Region),
                                <span class="dt">Tick                =</span> <span class="kw">mean</span>(Tick),
                                <span class="dt">LandUseIndex        =</span> <span class="kw">mean</span>(LandUseIndex),
                                <span class="dt">AFT                 =</span> <span class="kw">sum</span>(Counter),
                                <span class="dt">Service.Service1    =</span> <span class="kw">sum</span>(Service.Service1), 
                                <span class="dt">Service.Service2    =</span> <span class="kw">sum</span>(Service.Service2),
                                <span class="dt">Service.Service3    =</span> <span class="kw">sum</span>(Service.Service3),
                                <span class="dt">Capital.Cap1        =</span> <span class="kw">sum</span>(Capital.Cap1)) )
            })
}

csv_cell_aggregated &lt;-<span class="st"> </span><span class="kw">input_csv_data</span>(simp, <span class="dt">dataname =</span> <span class="ot">NULL</span>, <span class="dt">datatype =</span> <span class="st">&quot;Cell&quot;</span>, <span class="dt">columns =</span> <span class="kw">c</span>(<span class="st">&quot;Service.Service1&quot;</span>, <span class="st">&quot;Service.Service2&quot;</span>,
                <span class="st">&quot;Service.Service3&quot;</span>, <span class="st">&quot;Capital.Cap1&quot;</span>, <span class="st">&quot;LandUseIndex&quot;</span>, <span class="st">&quot;AFT&quot;</span>), <span class="dt">pertick =</span> <span class="ot">TRUE</span>,
        <span class="dt">starttick =</span> <span class="dv">2000</span>, <span class="dt">endtick =</span> <span class="dv">2020</span>, <span class="dt">tickinterval =</span> <span class="dv">10</span>,
        <span class="dt">attachfileinfo =</span> <span class="ot">TRUE</span>, <span class="dt">bindrows =</span> <span class="ot">TRUE</span>,
        <span class="dt">aggregationFunction =</span> aggregationFunction,
        <span class="dt">skipXY =</span> <span class="ot">TRUE</span>)</code></pre>
<pre><code>## Warning: package 'plyr' was built under R version 3.2.5</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rownames</span>(csv_cell_aggregated) &lt;-<span class="st"> </span><span class="ot">NULL</span>
<span class="kw">input_tools_save</span>(simp, <span class="st">&quot;csv_cell_aggregated&quot;</span>)</code></pre>
</div>
<div id="source-cell-table-pre-allocation-competitiveness" class="section level2">
<h2>Source: Cell Table (Pre-Allocation Competitiveness)</h2>
<p>Read CSV data of pre-allocation competitiveness and transfer to data.frame of frequencies. Requires the output of giving-up threshold, pre-allocation LandUseIndex and pre-allocation competitiveness with the Cell Table outputter (addPreAllocCompetitiveness=“true” addPreAllocGuThreshold=“true” addPreAllocLandUse=“true”).</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(craftyr)
simp &lt;-<span class="st"> </span><span class="kw">param_getExamplesSimp</span>()
simp$sim$filepartorder  &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;regions&quot;</span>, <span class="st">&quot;D&quot;</span>, <span class="st">&quot;datatype&quot;</span>)
csv_preAllocTable &lt;-<span class="st"> </span><span class="kw">input_csv_prealloccomp</span>(simp)
<span class="kw">input_tools_save</span>(simp, <span class="st">&quot;csv_preAllocTable&quot;</span>)</code></pre>
</div>
<div id="source-aggregated-aft-composition" class="section level2">
<h2>Source: Aggregated AFT Composition</h2>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(craftyr)
simp &lt;-<span class="st"> </span><span class="kw">param_getExamplesSimp</span>()
dataAggregateAFTComposition &lt;-<span class="st"> </span><span class="kw">input_csv_data</span>(simp, <span class="dt">dataname =</span> <span class="ot">NULL</span>, <span class="dt">datatype =</span> <span class="st">&quot;AggregateAFTComposition&quot;</span>,
        <span class="dt">pertick =</span> <span class="ot">FALSE</span>,
        <span class="dt">bindrows =</span> <span class="ot">TRUE</span>,
        <span class="dt">skipXY =</span> <span class="ot">TRUE</span>)
<span class="kw">input_tools_save</span>(simp, <span class="st">&quot;dataAggregateAFTComposition&quot;</span>)</code></pre>
</div>
<div id="source-aggregated-demand-and-supply-data-aggregatedemandsupplycsvoutputter" class="section level2">
<h2>Source: Aggregated Demand and Supply Data (AggregateDemandSupplyCSVOutputter)</h2>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(craftyr)
simp &lt;-<span class="st"> </span><span class="kw">param_getExamplesSimp</span>()
csv_aggregateServiceDemand &lt;-<span class="st"> </span><span class="kw">input_csv_data</span>(simp, <span class="dt">dataname =</span> <span class="ot">NULL</span>, <span class="dt">datatype =</span> <span class="st">&quot;AggregateServiceDemand&quot;</span>,
        <span class="dt">pertick =</span> <span class="ot">FALSE</span>, <span class="dt">bindrows =</span> <span class="ot">TRUE</span>)
<span class="kw">input_tools_save</span>(simp, <span class="st">&quot;csv_aggregateServiceDemand&quot;</span>)</code></pre>
</div>
<div id="source-takeover-from-giving-in-data-takeovercelloutputter" class="section level2">
<h2>Source: TakeOver from Giving In Data (TakeoverCellOutputter)</h2>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(craftyr)
simp &lt;-<span class="st"> </span><span class="kw">param_getExamplesSimp</span>()
csv_aggregateTakeOvers &lt;-<span class="st"> </span><span class="kw">input_csv_data</span>(simp, <span class="dt">dataname =</span> <span class="ot">NULL</span>, <span class="dt">datatype =</span> <span class="st">&quot;TakeOvers&quot;</span>, <span class="dt">pertick =</span> <span class="ot">FALSE</span>,
        <span class="dt">bindrows =</span> <span class="ot">TRUE</span>,
        <span class="dt">skipXY =</span> <span class="ot">TRUE</span>)
<span class="kw">input_tools_save</span>(simp, <span class="st">&quot;csv_aggregateTakeOvers&quot;</span>)</code></pre>
</div>
<div id="source-givingin-statistics-givinginstatisticsoutputter" class="section level2">
<h2>Source: GivingIn Statistics (GivingInStatisticsOutputter)</h2>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(craftyr)
simp &lt;-<span class="st"> </span><span class="kw">param_getExamplesSimp</span>()
csv_aggregateGiStatistics &lt;-<span class="st"> </span><span class="kw">input_csv_data</span>(simp, <span class="dt">dataname =</span> <span class="ot">NULL</span>, <span class="dt">datatype =</span> <span class="st">&quot;GivingInStatistics&quot;</span>,
        <span class="dt">pertick =</span> <span class="ot">FALSE</span>,
        <span class="dt">bindrows =</span> <span class="ot">TRUE</span>,
        <span class="dt">skipXY =</span> <span class="ot">TRUE</span>)
<span class="kw">input_tools_save</span>(simp, <span class="st">&quot;csv_aggregateGiStatistics&quot;</span>)</code></pre>
</div>
<div id="source-marginal-utilities" class="section level2">
<h2>Source: Marginal Utilities</h2>
<p>Note: currently, there is no outputter, but marginal utilities can be extracted from log data using a python script (see Py4ABM, <a href="https://bitbucket.org/S-Holzhauer/py4abm" class="uri">https://bitbucket.org/S-Holzhauer/py4abm</a>). The resulting CSV file should be placed in the project’s RData folder.</p>
<p>TODO</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(craftyr)
simp &lt;-<span class="st"> </span><span class="kw">param_getExamplesSimp</span>()
csv_MarginalUtilitites_melt &lt;-<span class="st"> </span><span class="kw">input_marginalutilities</span>(simp)
<span class="kw">input_tools_save</span>(simp, <span class="st">&quot;csv_MarginalUtilitites_melt&quot;</span>)</code></pre>
</div>
</div>
<div id="visualise-csv-data" class="section level1">
<h1>Visualise CSV Data</h1>
<div id="map-data" class="section level2">
<h2>Map Data</h2>
<div id="landuseindex-facets" class="section level3">
<h3>LandUseIndex: Facets</h3>
<pre class="sourceCode r"><code class="sourceCode r">simp &lt;-<span class="st"> </span><span class="kw">param_getDefaultSimp</span>()
<span class="kw">input_tools_load</span>(simp, <span class="st">&quot;csv_LandUseIndex_split&quot;</span>)
cdata &lt;-<span class="st"> </span>csv_LandUseIndex_split
cdata$<span class="st">&quot;2010.2&quot;</span>$ID &lt;&lt;-<span class="st"> </span><span class="kw">as.factor</span>(<span class="st">&quot;Homo_2010&quot;</span>)
cdata$<span class="st">&quot;2040.2&quot;</span>$ID &lt;&lt;-<span class="st"> </span><span class="kw">as.factor</span>(<span class="st">&quot;Homo_2040&quot;</span>)

diffcells &lt;&lt;-<span class="st"> </span>cdata$<span class="st">&quot;2010.2&quot;</span>
diffcells$LandUseIndex &lt;&lt;-<span class="st"> </span><span class="ot">NA</span>
diffhomo$LandUseIndex[cdata$<span class="st">&quot;2040.2&quot;</span>$LandUseIndex -<span class="st"> </span>cdata$<span class="st">&quot;2010.2&quot;</span>$LandUseIndex !=<span class="st"> </span><span class="dv">0</span>] &lt;-<span class="st"> </span><span class="dv">3</span>
diffhomo$ID &lt;-<span class="st"> </span><span class="kw">as.factor</span>(<span class="st">&quot;Diff_Homo_2040-2010&quot;</span>)

toplot &lt;-<span class="st"> </span><span class="kw">list</span>(cdata$<span class="st">&quot;2010.2&quot;</span>, cdata$<span class="st">&quot;2040.2&quot;</span>, diffhomo)
<span class="kw">rm</span>(diffhomo)
<span class="kw">rm</span>(cdata)
<span class="kw">visualise_cells_printPlots</span>(simp, toplot, <span class="dt">idcolumn =</span> <span class="st">&quot;ID&quot;</span>,
        <span class="dt">title =</span> <span class="st">&quot;EU-Homo&quot;</span>, <span class="dt">legendtitle =</span> <span class="st">&quot;AFTs&quot;</span>,
        <span class="dt">factorial=</span> <span class="ot">TRUE</span>, <span class="dt">omitaxisticks =</span> <span class="ot">TRUE</span>, <span class="dt">ncol =</span> <span class="dv">3</span>,
        <span class="dt">legenditemnames =</span> simp$mdata$aftNames, <span class="dt">coloursetname=</span><span class="st">&quot;AFT&quot;</span>)</code></pre>
</div>
<div id="landuseindex-raw-plot" class="section level3">
<h3>LandUseIndex: Raw Plot</h3>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(craftyr)
simp &lt;-<span class="st"> </span><span class="kw">param_getExamplesSimp</span>()
<span class="kw">input_tools_load</span>(simp, <span class="st">&quot;csv_LandUseIndex_split&quot;</span>)
<span class="kw">visualise_cells_printRawPlots</span>(simp, csv_LandUseIndex_split,
        <span class="dt">factorial=</span> <span class="ot">TRUE</span>, <span class="dt">ncol =</span> <span class="dv">1</span>, <span class="dt">id=</span><span class="st">&quot;None&quot;</span>)       </code></pre>
<pre><code>## Warning: `panel.margin` is deprecated. Please use `panel.spacing` property
## instead</code></pre>
<pre><code>## Warning in grid.Call(L_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font family not found in Windows font database

## Warning in grid.Call(L_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font family not found in Windows font database

## Warning in grid.Call(L_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :
## font family not found in Windows font database</code></pre>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAABlBMVEUbnnfZXwIF3WTLAAAACXBIWXMAAA7DAAAOwwHHb6hkAAADCklEQVR4nO3QwW0dMAwFQaf/pnPWxQsw/AnhzBZA6c3Xr8/0daz5kEWU5+6x5kMWUZ67x5oPWUR57h5rPmQR5bl7rPmQRZTn7rHmQxZRnrvHmg9ZRHnuHms+ZBHluXus+ZBFlOfuseZDFlGeu8eaD1lEee4eaz5kEeW5e6z5kEWU5+6x5kMWUZ67x5oPWUR57h5rPmQR5bl7rPmQRZTn7rHmQxZRnrvHmg9ZRHnuHms+ZBHluXus+ZBFlOfuseZDFlGeu8eaD1lEee4eaz5kEeW5e6z5kEWU5+6x5kMWUZ67x5oPWUR57h5rPmQR5bl7rPmQn2MwD1AEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFA0B/rXP78QoAhQBCgCFAGKAEWAIkARoAhQBCgCFAGKAEWAIkARoAhQBCgCFAGKAEWAIkARoAhQBCgCFAGKAEWAIkARoAhQBCgCFAGKAEWAIkARoAhQBCgCFAGKAEWAIkARoAhQBCgCFAGKAEWAIkDRt0D/id63KwEBygBFgCJAEaAIUAQoAhQBigBFgCJAEaAIUAQoAhQBigBFgCJAEaAIUAQoAhQBigBFgCJAEaAIUAQoAhQBigBFgCJAEaAIUAQoAhQBigBFgCJAEaAIUAQoAhQBigBFgCJAEaAIUAQoAhR9CGje35/5B3/9zNl4FFA8CigeBRSPAopHAcWjgOJRQPEooHgUUDwKKB4FFI8CikcBxaOA4lFA8SigeBRQPAooHgUUjwKKRwHFo4DiUUDxKKB4FFA8CigeBRSPAvo5AYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIU/QZOU5TAukutlQAAAABJRU5ErkJggg==" /><!-- --></p>
</div>
</div>
<div id="aggregate-data" class="section level2">
<h2>Aggregate Data</h2>
<div id="from-cell-level-data" class="section level3">
<h3>From Cell Level Data</h3>
<div id="aft-composition-as-timeline" class="section level4">
<h4>AFT Composition as Timeline</h4>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(craftyr)
simp &lt;-<span class="st"> </span><span class="kw">param_getExamplesSimp</span>()
<span class="kw">input_tools_load</span>(simp, <span class="st">&quot;csv_LandUseIndex_rbinded&quot;</span>)

 <span class="co"># aggregate regions:</span>
csv_LandUseIndex_rbinded$AftNumbers &lt;-<span class="st"> </span>csv_LandUseIndex_rbinded$LandUseIndex
aftData &lt;-<span class="st"> </span><span class="kw">aggregate</span>(<span class="kw">subset</span>(csv_LandUseIndex_rbinded, <span class="dt">select=</span><span class="kw">c</span>(<span class="st">&quot;AftNumbers&quot;</span>)),
        <span class="dt">by =</span> <span class="kw">list</span>(<span class="dt">ID =</span> csv_LandUseIndex_rbinded[,<span class="st">&quot;Runid&quot;</span>],
                <span class="dt">Tick=</span>csv_LandUseIndex_rbinded[, <span class="st">&quot;Tick&quot;</span>],  <span class="dt">AFT=</span>csv_LandUseIndex_rbinded[,<span class="st">&quot;LandUseIndex&quot;</span>]),
        <span class="dt">FUN=</span>sum)
aftData$AFT &lt;-<span class="st"> </span><span class="kw">as.factor</span>(aftData$AFT)
aftData$Proportion &lt;-<span class="st"> </span><span class="kw">ave</span>(aftData$AftNumbers, aftData$ID, aftData$Tick, <span class="dt">FUN =</span>  function(.x) .x/<span class="kw">sum</span>(.x))
aftData$Number &lt;-<span class="st"> </span><span class="ot">NULL</span>

<span class="kw">visualise_lines</span>(<span class="dt">simp =</span> simp, <span class="dt">data =</span> aftData, <span class="dt">y_column=</span><span class="st">&quot;Proportion&quot;</span>, <span class="dt">title =</span> <span class="st">&quot;Total AFT composition&quot;</span>,
        <span class="dt">colour_column =</span> <span class="st">&quot;AFT&quot;</span>,
        <span class="dt">colour_legenditemnames =</span> simp$mdata$aftNames,
        <span class="dt">linetype_column =</span> <span class="st">&quot;ID&quot;</span>,
        <span class="dt">linetype_legendtitle =</span> simp$sim$rundesclabel,
        <span class="dt">linetype_legenditemnames =</span> simp$sim$rundesc,
        <span class="dt">filename =</span> <span class="kw">paste</span>(<span class="st">&quot;TotalAftComposition&quot;</span>, 
                shbasic::<span class="kw">shbasic_condenseRunids</span>(<span class="kw">data.frame</span>(aftData)[, <span class="st">&quot;ID&quot;</span>]), <span class="dt">sep=</span><span class="st">&quot;_&quot;</span>),
        <span class="dt">alpha=</span><span class="fl">0.7</span>)</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>High level:</p>
<pre class="sourceCode r"><code class="sourceCode r">simp1 &lt;-<span class="st"> </span>simp
simp1$sim$shortid &lt;-<span class="st"> &quot;G9/C4&quot;</span>
simp2 &lt;-<span class="st"> </span>simp
simp2$sim$shortid &lt;-<span class="st"> &quot;G10/C5&quot;</span>
<span class="kw">hl_comp_cell_aftcomposition</span>(simp, <span class="dt">simps =</span> <span class="kw">list</span>(simp1, simp2), <span class="dt">dataname =</span> <span class="st">&quot;csv_cell_aggregated&quot;</span>)</code></pre>
</div>
<div id="competitiveness-mean-by-region" class="section level4">
<h4>Competitiveness (Mean by region)</h4>
<p>% TODO</p>
<p>High level:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hl_competitivenessPerRegion</span>(simp1, <span class="dt">dataname =</span> <span class="st">&quot;dataAgg&quot;</span>)</code></pre>
</div>
<div id="spatial-autocorrelation" class="section level4">
<h4>Spatial Autocorrelation</h4>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(craftyr)
simp &lt;-<span class="st"> </span><span class="kw">param_getExamplesSimp</span>()
<span class="kw">input_tools_load</span>(simp, <span class="dt">objectName =</span> <span class="st">&quot;csv_LandUseIndex_rbinded&quot;</span>)
data &lt;-<span class="st"> </span><span class="kw">get</span>(<span class="st">&quot;csv_LandUseIndex_rbinded&quot;</span>)

scoresdata &lt;-<span class="st"> </span><span class="kw">do.call</span>(rbind, <span class="kw">lapply</span>(<span class="kw">seq</span>(<span class="dt">from=</span><span class="dv">2010</span>, <span class="dt">to=</span><span class="dv">2040</span>, <span class="dt">by=</span><span class="dv">10</span>), function(tick, datac, regions, type) {
                    <span class="kw">do.call</span>(rbind,<span class="kw">lapply</span>(regions, function(tick, region, data, type) {
            tickdata &lt;-<span class="st"> </span>data[data$Tick ==<span class="st"> </span>tick &amp;<span class="st"> </span>data$Region %in%<span class="st"> </span>region, 
                    <span class="kw">c</span>(simp$csv$cname_x, simp$csv$cname_y, <span class="st">&quot;LandUseIndex&quot;</span>)]
            raster &lt;-<span class="st"> </span>craftyr::<span class="kw">convert_2raster</span>(simp, tickdata, <span class="dt">targetCRS =</span> <span class="st">&quot;+init=EPSG:32632&quot;</span>, <span class="dt">layers=</span><span class="kw">c</span>(<span class="dv">1</span>))
            <span class="kw">data.frame</span>(<span class="dt">Value =</span> <span class="kw">analyse_statistics_sa_local</span>(raster[[<span class="dv">1</span>]], <span class="dt">type =</span> type),
                    <span class="dt">Tick =</span> tick, <span class="dt">type =</span> type
                    <span class="dt">Region =</span> region)}, <span class="dt">tick =</span> tick, <span class="dt">data =</span> data, <span class="dt">type =</span> type))
        }, <span class="dt">data =</span> data, <span class="dt">type =</span> <span class="st">&quot;Moran&quot;</span>, <span class="dt">regions =</span> simp$sim$regions))

<span class="kw">visualise_lines</span>(<span class="dt">simp =</span> simp, <span class="dt">data =</span> scoresdata, <span class="dt">y_column =</span> <span class="st">&quot;Value&quot;</span>, <span class="dt">title =</span> <span class="kw">paste</span>(<span class="st">&quot;Spatial Autocorrelation (Moran)&quot;</span>, simp$sim$rundesc[simp$sim$runid]),
        <span class="dt">linetype_column =</span> <span class="st">&quot;Region&quot;</span>,
        <span class="dt">filename =</span> <span class="kw">paste</span>(<span class="st">&quot;Spatial Autocorrelation (Moran)&quot;</span>, <span class="st">&quot;_&quot;</span>, simp$sim$rundesc[simp$sim$runid], <span class="dt">sep=</span><span class="st">&quot;&quot;</span>))</code></pre>
<p>High level:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hl_aggregate_sa</span>(simp, <span class="dt">celldataname =</span> <span class="st">&quot;csv_LandUseIndex_rbinded&quot;</span>, 
    <span class="dt">starttick =</span> simp$sim$starttick, <span class="dt">tickinterval=</span><span class="dv">10</span>, <span class="dt">endtick =</span> simp$sim$endtick,
    <span class="dt">linetypecol =</span> <span class="st">&quot;Region&quot;</span>, <span class="dt">type =</span> <span class="st">&quot;Moran&quot;</span>, <span class="dt">regions =</span> simp$sim$regions,
    <span class="dt">titleprefix =</span> <span class="kw">paste</span>(<span class="st">&quot;SpatialAutocorrelation (&quot;</span>, type, <span class="st">&quot;)&quot;</span>, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>), 
    <span class="dt">filenameprefix =</span> <span class="kw">paste</span>(<span class="st">&quot;SpatialAutocorrelation&quot;</span>, type, <span class="dt">sep=</span><span class="st">&quot;_&quot;</span>))</code></pre>
</div>
<div id="cell-connectedness" class="section level4">
<h4>Cell Connectedness</h4>
<p>Visualise stored metric LandUseConnectivity as timelines</p>
<p>High level:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hl_connectedness</span>(simp, <span class="dt">dataname =</span> <span class="st">&quot;csv_aggregated_connectivity&quot;</span>, 
        <span class="dt">datatype =</span> <span class="st">&quot;LandUseConnectivity&quot;</span>, <span class="dt">aftcolumns =</span> simp$mdata$aftNames[-<span class="dv">1</span>],
        <span class="dt">percent =</span> <span class="ot">NULL</span>)</code></pre>
</div>
<div id="cell-volatility" class="section level4">
<h4>Cell Volatility</h4>
<p>High level:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hl_volatility</span>(simp, <span class="dt">dataname =</span> <span class="st">&quot;csv_aggregated_cellvolatility&quot;</span>, 
        <span class="dt">datatype =</span> <span class="st">&quot;AggregateCellVolatility&quot;</span>, <span class="dt">datacolumns =</span> <span class="kw">c</span>(<span class="st">&quot;CellVolatility&quot;</span>, <span class="st">&quot;NumVolatileCells&quot;</span>),
        <span class="dt">percent =</span> <span class="ot">NULL</span>)</code></pre>
</div>
<div id="further-cell-data-as-timeline" class="section level4">
<h4>Further Cell Data as Timeline</h4>
<p>High level:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hl_lines_from_csv</span>(simp, <span class="dt">dataname =</span> <span class="st">&quot;dataobjectname&quot;</span>, 
        <span class="dt">datatype =</span> <span class="st">&quot;Datatype&quot;</span>, <span class="dt">datacolumns =</span> <span class="kw">c</span>(<span class="st">&quot;ColumnA&quot;</span>,<span class="st">&quot;ColumnB&quot;</span>), <span class="dt">linetypecol =</span> <span class="st">&quot;Region&quot;</span>,
        <span class="dt">colourcol =</span> <span class="st">&quot;Type&quot;</span>, <span class="dt">titleprefix =</span> <span class="st">&quot;Title&quot;</span>, <span class="dt">filenameprefix =</span> <span class="st">&quot;FilenamePrefix&quot;</span>, 
        <span class="dt">percent =</span> <span class="ot">NULL</span>)</code></pre>
</div>
</div>
<div id="from-aggregated-region-level-data" class="section level3">
<h3>From Aggregated (Region Level) Data</h3>
<div id="aft-composition-as-timeline-1" class="section level4">
<h4>AFT Composition as Timeline</h4>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(craftyr)
simp &lt;-<span class="st"> </span><span class="kw">param_getDefaultSimp</span>()
<span class="kw">input_tools_load</span>(simp, <span class="st">&quot;dataAggregateAFTComposition&quot;</span>)
dataComp &lt;-<span class="st"> </span>dataAggregateAFTComposition
dataComp[,<span class="kw">grep</span>(<span class="st">&quot;AFT.&quot;</span>, <span class="kw">colnames</span>(dataComp))] &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">do.call</span>(cbind, 
    <span class="kw">lapply</span>(dataComp[,<span class="kw">grep</span>(<span class="st">&quot;AFT.&quot;</span>, <span class="kw">colnames</span>(dataComp))], as.character)))
dataComp &lt;-<span class="st"> </span>dataComp[<span class="kw">complete.cases</span>(dataComp),]
<span class="kw">colnames</span>(dataComp) &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&quot;AFT.&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="kw">colnames</span>(dataComp))
    
data &lt;-reshape2::<span class="kw">melt</span>(dataAggregateAFTComposition, <span class="dt">variable.name=</span><span class="st">&quot;Agent&quot;</span>, <span class="dt">id.vars=</span> <span class="kw">c</span>(<span class="st">&quot;Region&quot;</span>, <span class="st">&quot;Tick&quot;</span>, <span class="st">&quot;Runid&quot;</span>, <span class="st">&quot;Scenario&quot;</span>), <span class="dt">direction=</span><span class="st">&quot;long&quot;</span>)
d &lt;-<span class="st"> </span><span class="kw">aggregate</span>(<span class="kw">subset</span>(data, <span class="dt">select=</span><span class="kw">c</span>(<span class="st">&quot;value&quot;</span>)), <span class="dt">by =</span> <span class="kw">list</span>(<span class="dt">Agent =</span> data$Agent, <span class="dt">Tick=</span> data$Tick, <span class="dt">Runid=</span>data$Runid, <span class="dt">Scenario=</span>data$Scenario), <span class="st">&quot;mean&quot;</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)

 ## substitute AFT names by AFT ID
aftNumbers &lt;-<span class="st"> </span><span class="kw">names</span>(simp$mdata$aftNames)
<span class="kw">names</span>(aftNumbers) &lt;-<span class="st"> </span>simp$mdata$aftNames
d$AFT &lt;-<span class="st"> </span>aftNumbers[<span class="kw">as.character</span>(d$AFT)]

<span class="kw">visualise_lines</span>(<span class="dt">simp =</span> simp, <span class="dt">data =</span> d, <span class="dt">y_column =</span> <span class="st">&quot;value&quot;</span>, <span class="dt">title =</span> <span class="st">&quot;AftCompositionInvalid&quot;</span>,
        <span class="dt">colour_column =</span> <span class="st">&quot;AFT&quot;</span>, <span class="dt">colour_legenditemnames =</span> simp$mdata$aftNames,
        <span class="dt">filename =</span> <span class="st">&quot;AftCompositionInvalid&quot;</span>,
        <span class="dt">alpha=</span><span class="fl">0.7</span>)</code></pre>
<p>High level:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hl_aggregate_aftcompositions</span>(simp)</code></pre>
</div>
<div id="aggregated-demand-and-supply-data" class="section level4">
<h4>Aggregated Demand and Supply Data</h4>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(craftyr)
simp &lt;-<span class="st"> </span><span class="kw">param_getExamplesSimp</span>()
<span class="kw">input_tools_load</span>(simp, <span class="st">&quot;csv_aggregateServiceDemand&quot;</span>)

data &lt;-<span class="st"> </span><span class="kw">convert_aggregate_meltsupplydemand</span>(simp, csv_aggregateServiceDemand)

 <span class="co"># Aggregate regions:</span>
data &lt;-<span class="st"> </span><span class="kw">aggregate</span>(<span class="kw">subset</span>(data, <span class="dt">select=</span><span class="kw">c</span>(<span class="st">&quot;Value&quot;</span>)),
        <span class="dt">by =</span> <span class="kw">list</span>(<span class="dt">ID =</span> data[,<span class="st">&quot;Runid&quot;</span>],
                <span class="dt">Tick=</span>data[, <span class="st">&quot;Tick&quot;</span>],  <span class="dt">Scenario =</span> data[,<span class="st">&quot;Scenario&quot;</span>],
                <span class="dt">Service=</span>data[,<span class="st">&quot;Service&quot;</span>], <span class="dt">Type=</span>data[,<span class="st">&quot;Type&quot;</span>]),
        <span class="dt">FUN=</span>sum)

<span class="kw">visualise_lines</span>(<span class="dt">simp =</span> simp, <span class="dt">data =</span> data, <span class="dt">y_column =</span> <span class="st">&quot;Value&quot;</span>, <span class="dt">title =</span> <span class="st">&quot;Aggregated Service Supply &amp; Demand&quot;</span>,
        <span class="dt">colour_column =</span> <span class="st">&quot;Service&quot;</span>,
        <span class="dt">linetype_column =</span> <span class="st">&quot;Type&quot;</span>,
        <span class="dt">filename =</span> <span class="kw">paste</span>(<span class="st">&quot;AggregateServiceDemand&quot;</span>, 
                shbasic::<span class="kw">shbasic_condenseRunids</span>(<span class="kw">data.frame</span>(data)[, <span class="st">&quot;ID&quot;</span>]), <span class="dt">sep=</span><span class="st">&quot;_&quot;</span>),
        <span class="dt">alpha=</span><span class="fl">0.7</span>)</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>High level:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hl_aggregate_demandsupply</span>(simp)</code></pre>
</div>
<div id="take-overs-giving-in" class="section level4">
<h4>Take Overs (Giving in)</h4>
<p>Visualize take overs due to giving in as arrows between columns of AFTs. Use <a href="https://www.wiki.ed.ac.uk/display/CRAFTY/Output#Output-TakeoverCellOutputter">CRAFTY outputter TakeoverCellOutputter</a> to output the data from CRAFTY. To visualise all take overs (giving in and giving up), see below (using cell data).</p>
<pre class="sourceCode r"><code class="sourceCode r"> <span class="co"># TODO correct output_visualise_takeovers to work with gradient2sided (bezierArrowGradient2sided.R:304)</span>

<span class="kw">library</span>(craftyr)
simp &lt;-<span class="st"> </span><span class="kw">param_getExamplesSimp</span>()
<span class="kw">input_tools_load</span>(simp, <span class="st">&quot;csv_aggregateTakeOvers&quot;</span>)
<span class="kw">input_tools_load</span>(simp, <span class="st">&quot;csv_cell_aggregated&quot;</span>)
    
startPopulation &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">names</span>(simp$mdata$aftNames), <span class="dv">0</span>)
<span class="kw">names</span>(startPopulation) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Agent&quot;</span>, <span class="st">&quot;AFT&quot;</span>)
sp &lt;-<span class="st"> </span><span class="kw">aggregate</span>(<span class="kw">subset</span>(csv_cell_aggregated, <span class="dt">select=</span><span class="kw">c</span>(<span class="st">&quot;AFT&quot;</span>),
        <span class="dt">subset =</span> csv_cell_aggregated$Tick==<span class="dv">2000</span> &amp;&amp;<span class="st"> </span>csv_cell_aggregated$Runid ==<span class="st"> &quot;0-0&quot;</span>),
        <span class="dt">by =</span> <span class="kw">list</span>(<span class="dt">Agent =</span> csv_cell_aggregated[csv_cell_aggregated$Tick ==<span class="st"> </span><span class="dv">2000</span> &amp;&amp;<span class="st"> </span>
<span class="st">                    </span>csv_cell_aggregated$Runid ==<span class="st"> &quot;0-0&quot;</span>,<span class="st">&quot;LandUseIndex&quot;</span>]), <span class="dt">FUN=</span>sum)
startPopulation[startPopulation$Agent %in%<span class="st"> </span>sp$Agent,<span class="st">&quot;AFT&quot;</span>] &lt;-<span class="st"> </span>sp$AFT 
startPopulation$Agent &lt;-<span class="st"> </span>simp$mdata$aftNames[<span class="kw">as.character</span>(startPopulation$Agent)]
    
simp$mdata$aftNames &lt;-<span class="st"> </span>simp$mdata$aftNames[-<span class="dv">1</span>]
dat &lt;-<span class="st"> </span><span class="kw">aggregate</span>(<span class="kw">subset</span>(csv_aggregateTakeOvers, <span class="dt">select=</span>simp$mdata$aftNames), <span class="dt">by =</span> <span class="kw">list</span>(
        <span class="dt">Tick=</span>csv_aggregateTakeOvers[, <span class="st">&quot;Tick&quot;</span>],
        <span class="dt">Runid=</span>csv_aggregateTakeOvers[, <span class="st">&quot;Runid&quot;</span>],
        <span class="dt">AFT=</span>csv_aggregateTakeOvers[,<span class="st">&quot;AFT&quot;</span>]),
        <span class="dt">FUN=</span>sum)

startPopulation &lt;-<span class="st"> </span>startPopulation[<span class="kw">match</span>(simp$mdata$aftNames, startPopulation$Agent),]
<span class="kw">colnames</span>(startPopulation)[<span class="kw">colnames</span>(startPopulation) ==<span class="st"> &quot;AFT&quot;</span>] &lt;-<span class="st"> &quot;Number&quot;</span>
    
<span class="kw">output_visualise_takeovers</span>(simp,
        <span class="dt">data =</span> dat, 
        <span class="dt">startpopulation =</span> startPopulation,
        <span class="dt">starttick =</span> <span class="dv">2000</span>,
        <span class="dt">endtick =</span> <span class="dv">2020</span>,
        <span class="dt">tickinterval=</span> <span class="dv">1</span>,
        <span class="dt">type_of_arrow =</span> <span class="st">&quot;simple&quot;</span>, <span class="co">#&quot;gradient2sided&quot;,</span>
        <span class="dt">transitionthreshold =</span> <span class="dv">1</span>)</code></pre>
<p>High level:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hl_takeovers</span>(simp)</code></pre>
</div>
<div id="take-overs-all" class="section level4">
<h4>Take Overs (All)</h4>
<p>Requirements: * Land use indices stored in an object whose name is given by <code>landusedataname</code></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(craftyr)
simp &lt;-<span class="st"> </span><span class="kw">param_getExamplesSimp</span>()
 
csv_dataTakeOversAll &lt;-<span class="st"> </span><span class="kw">convert_aggregate_takeovers</span>(simp,
    <span class="dt">landusedataname =</span> <span class="st">&quot;csv_LandUseIndex_rbinded&quot;</span>)
<span class="kw">input_tools_save</span>(simp, <span class="st">&quot;csv_dataTakeOversAll&quot;</span>)

<span class="kw">hl_takeovers</span>(simp, <span class="dt">runid =</span> simp$sim$runids[<span class="dv">1</span>], 
        <span class="dt">dataname            =</span> <span class="st">&quot;csv_cell_aggregated&quot;</span>,
        <span class="dt">starttick           =</span> <span class="dv">2000</span>, 
        <span class="dt">tickinterval        =</span> <span class="dv">5</span>, 
        <span class="dt">endtick             =</span> <span class="dv">2020</span>,
        <span class="dt">datanametakeovers   =</span> <span class="st">&quot;csv_dataTakeOversAll&quot;</span>)</code></pre>
<p>For larger sets of AFT it is advisable to group these into fewer sets. This can be achieved by passing the <code>aftaggregation</code> parameter:</p>
<pre class="sourceCode r"><code class="sourceCode r">aftaggregation &lt;-<span class="st"> </span>simp$mdata$aftNames
<span class="kw">data.entry</span>(simp$mdata$aftNames, aftaggregation, <span class="dt">Modes=</span><span class="kw">list</span>(<span class="st">&quot;character&quot;</span>, <span class="st">&quot;character&quot;</span>))
<span class="kw">hl_takeovers</span>(simp, <span class="dt">runid =</span> simp$sim$runids[<span class="dv">1</span>],
        <span class="dt">dataname            =</span> <span class="st">&quot;csv_cell_aggregated&quot;</span>,
        <span class="dt">starttick           =</span> <span class="dv">2000</span>, 
        <span class="dt">tickinterval        =</span> <span class="dv">5</span>, 
        <span class="dt">endtick             =</span> <span class="dv">2020</span>,
        <span class="dt">datanametakeovers   =</span> <span class="st">&quot;csv_dataTakeOversAll&quot;</span>,
        <span class="dt">aftaggregation      =</span> aftaggregation)</code></pre>
<p>High level:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hl_takeovers_all</span>(simp, <span class="dt">landusedataname =</span> <span class="st">&quot;csv_LandUseIndex_rbinded&quot;</span>,
    <span class="dt">starttick =</span> <span class="dv">2000</span>, <span class="dt">tickinterval=</span><span class="dv">5</span>, <span class="dt">endtick =</span> <span class="dv">2020</span>)</code></pre>
</div>
<div id="givinginstatistics-frequencies-per-aft---regions-aggregated" class="section level4">
<h4>GivingInStatistics (Frequencies per AFT - Regions aggregated)</h4>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(craftyr)
<span class="kw">library</span>(reshape2)</code></pre>
<pre><code>## Warning: package 'reshape2' was built under R version 3.2.5</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">simp &lt;-<span class="st"> </span><span class="kw">param_getExamplesSimp</span>()
<span class="kw">input_tools_load</span>(simp, <span class="st">&quot;csv_aggregateGiStatistics&quot;</span>)

regions =<span class="st"> </span>simp$sim$regions
csv_aggregateGiStatistics &lt;-<span class="st"> </span>csv_aggregateGiStatistics[csv_aggregateGiStatistics[,<span class="st">&quot;Region&quot;</span>] %in%<span class="st"> </span>regions,]

dat &lt;-<span class="st"> </span><span class="kw">aggregate</span>(<span class="kw">subset</span>(csv_aggregateGiStatistics, <span class="dt">select=</span>simp$mdata$aftNames[-<span class="dv">1</span>]), <span class="dt">by =</span> <span class="kw">list</span>(
                <span class="dt">Trials=</span>csv_aggregateGiStatistics[, <span class="st">&quot;Trials&quot;</span>],
                <span class="dt">Runid=</span>csv_aggregateGiStatistics[, <span class="st">&quot;Runid&quot;</span>]),
        <span class="dt">FUN=</span>sum)

melteddat &lt;-<span class="st"> </span>reshape2::<span class="kw">melt</span>(dat, <span class="dt">variable.name=</span><span class="st">&quot;AFT&quot;</span>, <span class="dt">id.vars=</span> <span class="kw">c</span>(<span class="st">&quot;Trials&quot;</span>, <span class="st">&quot;Runid&quot;</span>), 
        <span class="dt">direction=</span><span class="st">&quot;long&quot;</span>, <span class="dt">value.name =</span> <span class="st">&quot;Number&quot;</span>)

<span class="kw">visualise_bars</span>(simp, <span class="dt">data =</span> melteddat, <span class="dt">y_column =</span> <span class="st">&quot;Number&quot;</span>, <span class="dt">title =</span> <span class="st">&quot;Giving In Statistics&quot;</span>,
        <span class="dt">facet_column =</span> <span class="st">&quot;AFT&quot;</span>, <span class="dt">facet_ncol =</span> <span class="dv">1</span>, <span class="dt">fill_column =</span> <span class="st">&quot;AFT&quot;</span>,
        <span class="dt">alpha=</span><span class="fl">1.0</span>, <span class="dt">x_column =</span> <span class="st">&quot;Trials&quot;</span>, <span class="dt">ggplotaddons =</span> ggplot2::<span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;none&quot;</span>))</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>High level:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hl_gistatistics_singleRegion</span>(simp, <span class="dt">dataname =</span> <span class="st">&quot;csv_aggregateGiStatistics&quot;</span>, 
        <span class="dt">regions =</span> simp$sim$regions, <span class="dt">facet_ncol =</span> <span class="dv">1</span>)</code></pre>
</div>
<div id="pre-allocation-competitiveness" class="section level4">
<h4>Pre-Allocation Competitiveness</h4>
<p>% TODO High level:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hl_competitiveness_prealloc</span>(simp, <span class="dt">dataname =</span> <span class="st">&quot;csv_preAlloc_rbinded&quot;</span>, 
        <span class="dt">facet_ncol =</span> <span class="kw">length</span>(simp$mdata$aftNames), <span class="dt">filename =</span> <span class="kw">paste</span>(<span class="st">&quot;PreAllocationCompetition&quot;</span>, 
        simp$sim$id, <span class="dt">sep=</span><span class="st">&quot;_b_&quot;</span>),
        <span class="dt">maxcompetitiveness =</span> <span class="st">&quot;100%&quot;</span>, <span class="dt">numbins =</span> <span class="dv">15</span>, <span class="dt">title =</span> <span class="ot">NULL</span>, <span class="dt">ggplotaddons =</span> <span class="ot">NULL</span>, <span class="dt">checkexists =</span> <span class="ot">FALSE</span>)</code></pre>
<p>High level when separating AFTs:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hl_competitiveness_preallocPerAft</span>(simp, <span class="dt">dataname =</span> <span class="st">&quot;csv_preAlloc_rbinded&quot;</span>, 
        <span class="dt">facet_ncol =</span> <span class="kw">length</span>(simp$mdata$aftNames), <span class="dt">filename =</span> <span class="kw">paste</span>(<span class="st">&quot;PreAllocationCompetition&quot;</span>, 
        simp$sim$id, <span class="dt">sep=</span><span class="st">&quot;_b_&quot;</span>),
        <span class="dt">maxcompetitiveness =</span> <span class="st">&quot;100%&quot;</span>, <span class="dt">numbins =</span> <span class="dv">15</span>, <span class="dt">title =</span> <span class="ot">NULL</span>, <span class="dt">ggplotaddons =</span> <span class="ot">NULL</span>, <span class="dt">checkexists =</span> <span class="ot">FALSE</span>)</code></pre>
</div>
<div id="cell-volatility-1" class="section level4">
<h4>Cell Volatility</h4>
<p>TODO</p>
<pre class="sourceCode r"><code class="sourceCode r">cellnumber &lt;-<span class="st"> </span><span class="kw">input_csv_param_capitals_cellnumbers</span>(simp, <span class="dt">capitals =</span> simp$mdata$capitals, 
        <span class="dt">regionpartfromend =</span> <span class="dv">2</span>, <span class="dt">regionpartdevider =</span> <span class="st">&quot;_&quot;</span>)</code></pre>
<p>High level:</p>
<pre class="sourceCode r"><code class="sourceCode r">numcells &lt;-<span class="st"> </span>cellnumbers &lt;-<span class="st"> </span><span class="kw">input_csv_param_capitals_cellnumbers</span>(simp, <span class="dt">regionpartfromend =</span> <span class="dv">2</span>, <span class="dt">regionpartdevider =</span> <span class="st">&quot;_&quot;</span>)
<span class="kw">hl_volatility</span>(simp, <span class="dt">dataname =</span> <span class="st">&quot;csv_aggregated_cellvolatility&quot;</span>, 
        <span class="dt">datatype =</span> <span class="st">&quot;AggregateCellVolatility&quot;</span>, <span class="dt">datacolumns =</span> <span class="kw">c</span>(<span class="st">&quot;CellVolatility&quot;</span>, <span class="st">&quot;NumVolatileCells&quot;</span>),
        <span class="dt">percent =</span> numcells)</code></pre>
</div>
<div id="marginal-utilities" class="section level4">
<h4>Marginal Utilities</h4>
<p>TODO</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">input_tools_load</span>(simp, <span class="st">&quot;csv_MarginalUtilitites_melt&quot;</span>)
<span class="kw">visualise_lines</span>(<span class="dt">simp =</span> simp, <span class="dt">data =</span> data, <span class="dt">y_column =</span> <span class="st">&quot;value&quot;</span>, <span class="dt">title =</span> <span class="st">&quot;Marginal Utilities&quot;</span>,
        <span class="dt">colour_column =</span> <span class="st">&quot;Service&quot;</span>,
        <span class="dt">filename =</span> <span class="kw">paste</span>(<span class="st">&quot;MarginalUtilities&quot;</span>, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>),
        <span class="dt">alpha=</span><span class="fl">0.7</span>)</code></pre>
<p>High level:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hl_marginalutilities</span>(simp)</code></pre>
</div>
<div id="demand-normalised-per-cell-marginal-utilities" class="section level4">
<h4>Demand-normalised per-cell marginal Utilities</h4>
<p>The file MarginalUtilitiesPerCell.csv can be craeted by python script extractMarginalUtilityFromFiles.py.</p>
<p>TODO</p>
<p>High level:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hl_normalisedutilities</span>(simp,
        <span class="dt">filenamemarginalutils =</span> <span class="kw">paste</span>(simp$dirs$output$rdata, <span class="st">&quot;MarginalUtilitiesPerCell.csv&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;/&quot;</span>),
        <span class="dt">filenameNormalisedResiduals =</span> <span class="kw">paste</span>(<span class="st">&quot;NormalisedResiduals&quot;</span>, 
                shbasic::<span class="kw">shbasic_condenseRunids</span>(<span class="kw">data.frame</span>(data)[, <span class="st">&quot;ID&quot;</span>]), <span class="dt">sep=</span><span class="st">&quot;_&quot;</span>),
        <span class="dt">capitalfilepartorder =</span> <span class="kw">c</span>(<span class="st">&quot;regionalisation&quot;</span>, <span class="st">&quot;U&quot;</span>, <span class="st">&quot;regions&quot;</span>, <span class="st">&quot;U&quot;</span>, <span class="st">&quot;datatype&quot;</span>))</code></pre>
</div>
<div id="total-productivity" class="section level4">
<h4>Total Productivity</h4>
</div>
<div id="actions" class="section level4">
<h4>Actions</h4>
<p>To evaluate the effect of actions it is valuable to show selected actions along with a measure they may affect:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">convert_aggregate_demand</span>(simp)
<span class="kw">convert_aggregate_supply</span>(simp, <span class="dt">celldataname =</span> <span class="st">&quot;dataAgg&quot;</span>)

 <span class="co"># store percental supply (regarding demand)</span>

<span class="kw">input_tools_load</span>(simp, <span class="dt">objectName=</span><span class="st">&quot;csv_aggregated_demand&quot;</span>)
<span class="kw">input_tools_load</span>(simp, <span class="dt">objectName=</span><span class="st">&quot;csv_aggregated_supply&quot;</span>)
<span class="kw">colnames</span>(csv_aggregated_demand)[<span class="kw">colnames</span>(csv_aggregated_demand) ==<span class="st"> &quot;variable&quot;</span>] &lt;-<span class="st"> &quot;Service&quot;</span>
dataAggregatedPercentalSupply &lt;-<span class="st"> </span><span class="kw">merge</span>(csv_aggregated_supply, csv_aggregated_demand)
dataAggregatedPercentalSupply$PercentalSupply &lt;-<span class="st"> </span><span class="dv">100</span> *<span class="st"> </span>dataAggregatedPercentalSupply$TotalProduction /<span class="st"> </span>
<span class="st">        </span>dataAggregatedPercentalSupply$Demand
<span class="kw">input_tools_save</span>(simp, <span class="st">&quot;dataAggregatedPercentalSupply&quot;</span>)

<span class="kw">visualise_actions</span>(simp, <span class="dt">dataname =</span> <span class="st">&quot;dataActions&quot;</span>,
    <span class="dt">monitordataname =</span> <span class="st">&quot;dataAggregatedPercentalSupply&quot;</span>,
    <span class="dt">monitorvars =</span> simp$mdata$services,
    <span class="dt">monitorColours =</span> simp$colours$Service,
    <span class="dt">colour_column =</span> <span class="st">&quot;Service&quot;</span>,
    <span class="dt">size_column =</span> <span class="ot">NULL</span>,
    <span class="dt">measure_name =</span> <span class="st">&quot;PercentalSupply&quot;</span>,
    <span class="dt">actionColours =</span> <span class="kw">c</span>(<span class="st">&quot;DoNothing&quot;</span> =<span class="st"> &quot;grey&quot;</span>, <span class="st">&quot;RegionalSubsidyPa_CCereal&quot;</span> =<span class="st"> </span>simp$colours$Service[<span class="st">&quot;Cereal&quot;</span>],
            <span class="st">&quot;RegionalSubsidyPa_Forester&quot;</span> =<span class="st"> </span>simp$colours$Service[<span class="st">&quot;Timber&quot;</span>]))</code></pre>
</div>
</div>
<div id="from-single-files" class="section level3">
<h3>From Single Files</h3>
<div id="aft-composition" class="section level4">
<h4>AFT Composition</h4>
<p>Reads single CSV file with AFT composition and produces timeline figure.</p>
<p>High level:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hl_aftcomposisition_file</span>(simp, csvfilename, <span class="dt">title =</span> <span class="st">&quot;AftComposition&quot;</span>, 
        <span class="dt">figurefilename =</span> <span class="st">&quot;AftComposition&quot;</span>) 

### Comparisons
To compare different data sets, according sip lists need to be defined:</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">source</span>(<span class="st">&quot;./simp44.R&quot;</span>)
simp1 &lt;-<span class="st"> </span>simp
simp1$sim$shortid &lt;-<span class="st"> &quot;SD.9&quot;</span>

<span class="kw">source</span>(<span class="st">&quot;./simp45.R&quot;</span>)
simp2 &lt;-<span class="st"> </span>simp
simp2$sim$shortid &lt;-<span class="st"> &quot;SD.4&quot;</span>

<span class="kw">source</span>(<span class="st">&quot;./simp46.R&quot;</span>)
simp3 &lt;-<span class="st"> </span>simp
simp3$sim$shortid &lt;-<span class="st"> &quot;SD.55&quot;</span>
simps &lt;-<span class="st"> </span><span class="kw">list</span>(simp1, simp2, simp3)</code></pre>
</div>
<div id="aft-composition-1" class="section level4">
<h4>AFT Composition</h4>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hl_comp_aggregate_aftcompositions</span>(simp, simps, <span class="dt">dataname=</span><span class="st">&quot;dataAggregateAFTComposition&quot;</span>)</code></pre>
</div>
<div id="demand-and-supply" class="section level4">
<h4>Demand and Supply</h4>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hl_comp_demandsupply</span>(simp, simps, <span class="dt">dataname=</span><span class="st">&quot;dataAggregateSupplyDemand&quot;</span>)</code></pre>
</div>
</div>
</div>
</div>
<div id="output-write-csv-data" class="section level1">
<h1>Output (write) CSV Data</h1>
<div id="land-use-index-per-tick" class="section level2">
<h2>Land Use Index (per tick)</h2>
<pre class="sourceCode r"><code class="sourceCode r">simp &lt;-<span class="st"> </span><span class="kw">param_getExamplesSimp</span>()
simp$sim$runids         &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">3</span>)
simp$sim$scenario       &lt;-<span class="st">  &quot;A1&quot;</span>
craftyr::<span class="kw">hl_write_csv_landuseindex</span>(simp, <span class="dt">dataname =</span> <span class="st">&quot;csv_LandUseIndex_rbinded&quot;</span>, <span class="dt">pertick =</span> <span class="ot">TRUE</span>,
        <span class="dt">identifier =</span> <span class="kw">paste</span>(simp$sim$scenario, <span class="dt">sep=</span><span class="st">&quot;_&quot;</span>),
        <span class="dt">useIndices =</span> <span class="ot">TRUE</span>, <span class="dt">writeLegend =</span> <span class="ot">TRUE</span>, <span class="dt">zip =</span> <span class="ot">TRUE</span>, <span class="dt">removeCSV =</span> <span class="ot">TRUE</span>,
        <span class="dt">outdir =</span> <span class="st">&quot;M:/web/public_html/CRAFTY/Europe&quot;</span>, <span class="dt">tempdir =</span> <span class="st">&quot;C:/Users/sholzhau/Desktop/Temp&quot;</span>)</code></pre>
</div>
<div id="generate-landuseindex-key" class="section level2">
<h2>Generate LandUseIndex key</h2>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hl_landindiceskey_csv</span>(simp)</code></pre>
</div>
<div id="aggregate-demand-and-supply" class="section level2">
<h2>Aggregate demand and supply</h2>
<p>Aggregates demand and supply for all regions per tick and stores data as CSV file.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hl_aggregate_demandsupply_csv</span>(simp)</code></pre>
</div>
<div id="supplydemand-gap-regarding-agent-parameters-gu-probability" class="section level2">
<h2>Supply/Demand gap regarding agent parameters (GU probability)</h2>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hl_comp_demandsupplygap_agentparams</span>(simp, <span class="dt">simps =</span> <span class="kw">input_tools_buildsimplist</span>(<span class="dv">111</span>:<span class="dv">116</span>),
        <span class="dt">dataname =</span> <span class="st">&quot;dataAggregateSupplyDemand&quot;</span>, 
        <span class="dt">filename =</span> <span class="kw">paste</span>(<span class="st">&quot;SupplyDemandGap_&quot;</span>, 
                if(!<span class="kw">is.null</span>(simp$sim$rundesc))<span class="kw">paste</span>(simp$sim$rundesc, <span class="dt">collapse =</span> <span class="st">&quot;-&quot;</span>) else simp$sim$id, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>),
        <span class="dt">title =</span> <span class="st">&quot;Demand/Supply Gap&quot;</span>,
        <span class="dt">agentparam =</span> <span class="st">&quot;givingUpProb&quot;</span>, <span class="dt">aft =</span> simp$mdata$aftNames[<span class="dv">2</span>], 
        <span class="dt">ggplotparams =</span> ggplot2::<span class="kw">xlab</span>(<span class="st">&quot;Probability of Giving up&quot;</span>))</code></pre>
</div>
</div>
<div id="conversions" class="section level1">
<h1>Conversions</h1>
<ul>
<li>convert_csv2shapefile</li>
</ul>
<div id="stored-csvdata.frame-rdata-to-raster-file-ascii" class="section level2">
<h2>Stored CSV/data.frame (rData) to raster file (ASCII)</h2>
<pre class="sourceCode r"><code class="sourceCode r">simp &lt;-<span class="st"> </span><span class="kw">param_getExamplesSimp</span>()
<span class="kw">input_tools_load</span>(simp, <span class="dt">dataname =</span> <span class="st">&quot;csv_LandUseIndex_rbinded&quot;</span>)

data &lt;-<span class="st"> </span><span class="kw">get</span>(dataname)
data &lt;-<span class="st"> </span>data[data$Tick ==<span class="st"> </span><span class="dv">2010</span>, <span class="kw">c</span>(simp$csv$cname_x, simp$csv$cname_y, <span class="st">&quot;LandUseIndex&quot;</span>)]
<span class="kw">rownames</span>(data) &lt;-<span class="st"> </span><span class="ot">NULL</span>

raster &lt;-<span class="st"> </span>craftyr::<span class="kw">convert_2raster</span>(simp, data, <span class="dt">targetCRS =</span> <span class="st">&quot;+init=EPSG:32632&quot;</span>, <span class="dt">layers=</span><span class="kw">c</span>(<span class="dv">1</span>))

filename &lt;-<span class="st"> </span><span class="kw">sprintf</span>(<span class="st">&quot;%s/%s_LandUseIndex_%d.%s&quot;</span>,
        simp$dirs$output$raster,
        <span class="kw">output_tools_getDefaultFilename</span>(simp),
        <span class="kw">as.integer</span>(tick),
        <span class="st">&quot;asc&quot;</span>)
shbasic::<span class="kw">sh.ensurePath</span>(filename, <span class="dt">stripFilename =</span> <span class="ot">TRUE</span>)
raster::<span class="kw">writeRaster</span>(raster[[<span class="dv">1</span>]][[<span class="dv">1</span>]], <span class="dt">filename =</span> filename, <span class="dt">format =</span> <span class="st">&quot;ascii&quot;</span>, 
        <span class="dt">NAflag=</span>naflag, <span class="dt">overwrite=</span><span class="ot">TRUE</span>)</code></pre>
<p>High level:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hl_cell2raster</span>(simp, tick, <span class="dt">dataname =</span> <span class="st">&quot;csv_LandUseIndex_rbinded&quot;</span>, 
        <span class="dt">landuseindexcolname =</span> <span class="st">&quot;LandUseIndex&quot;</span>, <span class="dt">naflag =</span> -<span class="dv">9</span>)</code></pre>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
